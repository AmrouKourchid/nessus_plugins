#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500391);
  script_version("1.7");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2017-9628");
  script_xref(name:"ICSA", value:"17-234-05");

  script_name(english:"Saia Burgess Controls PCD Controllers Exposure of Sensitive Information to an Unauthorized Actor (CVE-2017-9628)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"An Information Exposure issue was discovered in Saia Burgess Controls PCD Controllers with PCD firmware versions prior
to 1.28.16 or 1.24.69. In certain circumstances, the device pads Ethernet frames with memory contents.  

This plugin
only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://ics-cert.us-cert.gov/advisories/ICSA-17-234-05");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/100949");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Saia Burgess Controls strongly recommends that users update to the latest versions of firmware, Version 1.28.16 or
1.24.69.

The security upgrade section of the Saia Burgess Controls web page links to the latest versions and offers security tips
and upgrade information:

https://www.sbc-support.com/en/product-category/communication-protocols/pcd-on-internet/upgrade-it-security/

Please see the latest update information for this product at the following web site:

https://www.sbc-support.com/en/product-index/");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-9628");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(200);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/10/05");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/10/05");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:saia_burgess_controls:pcd_controllers_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Saia");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Saia');

var asset = tenable_ot::assets::get(vendor:'Saia');

var vuln_cpes = {
    "cpe:/o:saia_burgess_controls:pcd_controllers_firmware" :
        {"versionEndIncluding" : "1.24.67", "family" : "PCD"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
