#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502791);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/05");

  script_cve_id("CVE-2016-3962");
  script_xref(name:"ICSA", value:"16-175-03");

  script_name(english:"Meinberg NTP Improper Restriction of Operations within the Bounds of a Memory Buffer (CVE-2016-3962)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Stack-based buffer overflow in the NTP time-server interface on
Meinberg IMS-LANTIME M3000, IMS-LANTIME M1000, IMS-LANTIME M500,
LANTIME M900, LANTIME M600, LANTIME M400, LANTIME M300, LANTIME M200,
LANTIME M100, SyncFire 1100, and LCES devices with firmware before
6.20.004 allows remote attackers to obtain sensitive information,
modify data, or cause a denial of service via a crafted parameter in a
POST request.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://ics-cert.us-cert.gov/advisories/ICSA-16-175-03");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/40120/");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:POC/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2016-3962");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(119);

  script_set_attribute(attribute:"vuln_publication_date", value:"2016/07/03");
  script_set_attribute(attribute:"patch_publication_date", value:"2016/07/03");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/12/04");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:ims-lantime_m1000:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:ims-lantime_m3000:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:ims-lantime_m500:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:lantime_m100:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:lantime_m200:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:lantime_m300:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:lantime_m400:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:lantime_m600:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:meinberg:lantime_m900:-");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Meinberg");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Meinberg');

var asset = tenable_ot::assets::get(vendor:'Meinberg');

var vuln_cpes = {
    "cpe:/h:meinberg:ims-lantime_m1000:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"},
    "cpe:/h:meinberg:ims-lantime_m3000:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"},
    "cpe:/h:meinberg:ims-lantime_m500:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"},
    "cpe:/h:meinberg:lantime_m100:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"},
    "cpe:/h:meinberg:lantime_m200:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"},
    "cpe:/h:meinberg:lantime_m300:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"},
    "cpe:/h:meinberg:lantime_m400:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"},
    "cpe:/h:meinberg:lantime_m600:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"},
    "cpe:/h:meinberg:lantime_m900:-" :
        {"versionEndIncluding": "6.0", "family" : "LANTIME"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
