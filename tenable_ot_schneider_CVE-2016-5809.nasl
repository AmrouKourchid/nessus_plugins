#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502736);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/05");

  script_cve_id("CVE-2016-5809");
  script_xref(name:"ICSA", value:"16-308-03");

  script_name(english:"Schneider Electric IONXXXX Series Power Meter Cross-site Request Forgery (CVE-2016-5809)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"An issue was discovered on Schneider Electric IONXXXX series power
meters ION73XX series, ION75XX series, ION76XX series, ION8650 series,
ION8800 series, and PM5XXX series. There is no CSRF Token generated to
authenticate the user during a session. Successful exploitation of
this vulnerability can allow unauthorized configuration changes to be
made and saved.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/92916");
  script_set_attribute(attribute:"see_also", value:"https://ics-cert.us-cert.gov/advisories/ICSA-16-308-03");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/44640/");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:POC/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2016-5809");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(352);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/02/13");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/02/13");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/12/04");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:schneider-electric:ion5000:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:schneider-electric:ion7300:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:schneider-electric:ion7500:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:schneider-electric:ion7600:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:schneider-electric:ion8650:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:schneider-electric:ion8800:-");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Schneider");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Schneider');

var asset = tenable_ot::assets::get(vendor:'Schneider');

var vuln_cpes = {
    "cpe:/h:schneider-electric:ion5000:-" :
        {"family" : "ION"},
    "cpe:/h:schneider-electric:ion7300:-" :
        {"family" : "ION"},
    "cpe:/h:schneider-electric:ion7500:-" :
        {"family" : "ION"},
    "cpe:/h:schneider-electric:ion7600:-" :
        {"family" : "ION"},
    "cpe:/h:schneider-electric:ion8650:-" :
        {"family" : "ION"},
    "cpe:/h:schneider-electric:ion8800:-" :
        {"family" : "ION"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
