#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500992);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/10");

  script_cve_id("CVE-2022-32205");
  script_xref(name:"ICSA", value:"23-103-09");
  script_xref(name:"FEDORA", value:"FEDORA-2022-1b3d7f6973");
  script_xref(name:"DSA", value:"DSA-5197");
  script_xref(name:"GLSA", value:"GLSA-202212-01");

  script_name(english:"Siemens SCALANCE XCM332 Allocation of Resources Without Limits or Throttling (CVE-2022-32205)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A malicious server can serve excessive amounts of `Set-Cookie:`
headers in a HTTP response to curl and curl < 7.84.0 stores all of
them. A sufficiently large amount of (big) cookies make subsequent
HTTP requests to this, or other servers to which the cookies match,
create requests that become larger than the threshold that curl uses
internally to avoid sending crazy large requests (1048576 bytes) and
instead returns an error.This denial state might remain for as long as
the same cookies are kept, match and haven't expired. Due to cookie
matching rules, a server on `foo.example.com` can set cookies that
also would match for `bar.example.com`, making it it possible for a
sister server to effectively cause a denial of service for a sibling
site on the same second level domain using this method.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://hackerone.com/reports/1569946");
  # https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BEV6BR4MTI3CEWK2YU2HQZUW5FAS3FEY/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?59ba3f3e");
  # https://www.cisa.gov/news-events/ics-advisories/icsa-23-103-09
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4af41997");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/html/ssa-558014.html");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2022/dsa-5197");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20220915-0003/");
  script_set_attribute(attribute:"see_also", value:"https://support.apple.com/kb/HT213488");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-23-103-09");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2022/Oct/41");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2022/Oct/28");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-333517.pdf");
  script_set_attribute(attribute:"see_also", value:"https://security.gentoo.org/glsa/202212-01");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-419740.pdf");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-942865.pdf");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/html/ssa-398330.html");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has released an update for the SCALANCE XCM332 and recommends updating to the latest version: 

- SCALANCE XCM332 (6GK5332-0GA01-2AC2): Update to V2.2 or later version

As a general security measure, Siemens recommends protecting network access to devices with appropriate mechanisms. To
operate the devices in a protected IT environment, Siemens recommends configuring the environment according to Siemensâ€™
operational guidelines for industrial security and following the recommendations in the product manuals. Additional
information on Industrial Security by Siemens can be found at the Siemens Industrial Security web page.

For further inquiries on security vulnerabilities in Siemens products and solutions, users should contact the Siemens
ProductCERT.

For more information see the associated Siemens security advisory SSA-558014 in HTML and CSAF.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:POC/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-32205");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(770);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/07/07");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/07/07");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/04/11");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rm1224_lte%284g%29_eu_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rm1224_lte%284g%29_nam_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m804pb_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m812-1_adsl-router_%28annex_a%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m812-1_adsl-router_%28annex_b%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m816-1_adsl-router_%28annex_a%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m816-1_adsl-router_%28annex_b%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m826-2_shdsl-router_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m874-2_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m874-3_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-3_%28evdo%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-3_%28rok%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-4_%28eu%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-4_%28nam%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-4_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum853-1_%28eu%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum856-1_%28eu%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum856-1_%28row%29_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_s615_eec_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_s615_firmware:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc622-2c_firmware:3.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc626-2c_firmware:3.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc632-2c_firmware:3.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc636-2c_firmware:3.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc642-2c_firmware:3.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc646-2c_firmware:3.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xcm332_firmware:2.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_firmware:3.1.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_s7-1500_cpu_firmware:3.1.0");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:scalance_sc622-2c_firmware:3.0" :
        {"versionEndExcluding" : "3.0", "family" : "SCALANCES", "orderNumbers" : ['6GK5622-2GS00-2AC2']},
    "cpe:/o:siemens:scalance_sc626-2c_firmware:3.0" :
        {"versionEndExcluding" : "3.0", "family" : "SCALANCES", "orderNumbers" : ['6GK5626-2GS00-2AC2']},
    "cpe:/o:siemens:scalance_sc632-2c_firmware:3.0" :
        {"versionEndExcluding" : "3.0", "family" : "SCALANCES", "orderNumbers" : ['6GK5632-2GS00-2AC2']},
    "cpe:/o:siemens:scalance_sc636-2c_firmware:3.0" :
        {"versionEndExcluding" : "3.0", "family" : "SCALANCES", "orderNumbers" : ['6GK5636-2GS00-2AC2']},
    "cpe:/o:siemens:scalance_sc642-2c_firmware:3.0" :
        {"versionEndExcluding" : "3.0", "family" : "SCALANCES", "orderNumbers" : ['6GK5642-2GS00-2AC2']},
    "cpe:/o:siemens:scalance_sc646-2c_firmware:3.0" :
        {"versionEndExcluding" : "3.0", "family" : "SCALANCES", "orderNumbers" : ['6GK5646-2GS00-2AC2']},
    "cpe:/o:siemens:ruggedcom_rm1224_lte%284g%29_eu_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "RuggedCom", "orderNumbers" : ['6GK6108-4AM00-2BA2']},
    "cpe:/o:siemens:ruggedcom_rm1224_lte%284g%29_nam_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "RuggedCom", "orderNumbers" : ['6GK6108-4AM00-2DA2']},
    "cpe:/o:siemens:scalance_m804pb_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5804-0AP00-2AA2']},
    "cpe:/o:siemens:scalance_m812-1_adsl-router_%28annex_a%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5812-1AA00-2AA2']},
    "cpe:/o:siemens:scalance_m812-1_adsl-router_%28annex_b%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5812-1BA00-2AA2']},
    "cpe:/o:siemens:scalance_m816-1_adsl-router_%28annex_a%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5816-1AA00-2AA2']},
    "cpe:/o:siemens:scalance_m816-1_adsl-router_%28annex_b%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5816-1BA00-2AA2']},
    "cpe:/o:siemens:scalance_m826-2_shdsl-router_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5826-2AB00-2AB2']},
    "cpe:/o:siemens:scalance_m874-2_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5874-2AA00-2AA2']},
    "cpe:/o:siemens:scalance_m874-3_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5874-3AA00-2AA2']},
    "cpe:/o:siemens:scalance_m876-3_%28evdo%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-3AA02-2BA2']},
    "cpe:/o:siemens:scalance_m876-3_%28rok%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-3AA02-2EA2']},
    "cpe:/o:siemens:scalance_m876-4_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-4AA10-2BA2']},
    "cpe:/o:siemens:scalance_m876-4_%28eu%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-4AA00-2BA2']},
    "cpe:/o:siemens:scalance_m876-4_%28nam%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-4AA00-2DA2']},
    "cpe:/o:siemens:scalance_mum853-1_%28eu%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5853-2EA00-2DA1']},
    "cpe:/o:siemens:scalance_mum856-1_%28eu%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5856-2EA00-3DA1']},
    "cpe:/o:siemens:scalance_mum856-1_%28row%29_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5856-2EA00-3AA1']},
    "cpe:/o:siemens:scalance_s615_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCES", "orderNumbers" : ['6GK5615-0AA00-2AA2']},
    "cpe:/o:siemens:scalance_s615_eec_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCES", "orderNumbers" : ['6GK5615-0AA01-2AA2']},
    "cpe:/o:siemens:scalance_xcm332_firmware:2.2" :
        {"versionEndExcluding" : "2.2", "family" : "SCALANCEX300", "orderNumbers" : ['6GK5332-0GA01-2AC2']},
    "cpe:/o:siemens:simatic_s7-1500_cpu_firmware:3.1.0" :
        {"versionStartIncluding" : "3.1.0", "family" : "S71500", "orderNumbers" : ['6ES7518-4AX00-1AB0', '6ES7518-4AX00-1AC0', '6ES7518-4FX00-1AC0', '6ES7518-4FX00-1AB0']},
    "cpe:/o:siemens:siplus_s7-1500_cpu_firmware:3.1.0" :
        {"versionStartIncluding" : "3.1.0", "family" : "S71500", "orderNumbers" : ['6AG1518-4AX00-4AC0']}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
