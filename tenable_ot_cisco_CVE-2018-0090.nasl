#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502744);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/05");

  script_cve_id("CVE-2018-0090");

  script_name(english:"Cisco NX-OS Uncontrolled Resource Consumption (CVE-2018-0090)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in management interface access control list (ACL)
configuration of Cisco NX-OS System Software could allow an
unauthenticated, remote attacker to bypass configured ACLs on the
management interface. This could allow traffic to be forwarded to the
NX-OS CPU for processing, leading to high CPU utilization and a denial
of service (DoS) condition. The vulnerability is due to a bad code fix
in the 7.3.2 code train that could allow traffic to the management
interface to be misclassified and not match the proper configured
ACLs. An attacker could exploit this vulnerability by sending crafted
traffic to the management interface. An exploit could allow the
attacker to bypass the configured management interface ACLs and impact
the CPU of the targeted device, resulting in a DoS condition. This
vulnerability affects the following Cisco products running Cisco NX-OS
System Software: Multilayer Director Switches, Nexus 2000 Series
Switches, Nexus 3000 Series Switches, Nexus 5500 Platform Switches,
Nexus 5600 Platform Switches, Nexus 6000 Series Switches, Nexus 7000
Series Switches, Nexus 7700 Series Switches, Nexus 9000 Series
Switches in standalone NX-OS mode. Cisco Bug IDs: CSCvf31132.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/102753");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1040247");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180117-nxos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f19a65f5");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/102753");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1040247");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180117-nxos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f19a65f5");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-0090");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(20, 400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/01/18");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/01/18");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/12/04");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.3%282%29n1%280.6%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.3%280%29kms%280.31%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.8%283.5%29s0");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:7.3%282%29n1%280.6%29" :
        {"versionEndIncluding" : "7.3%282%29n1%280.6%29", "versionStartIncluding" : "7.3%282%29n1%280.6%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.3%280%29kms%280.31%29" :
        {"versionEndIncluding" : "8.3%280%29kms%280.31%29", "versionStartIncluding" : "8.3%280%29kms%280.31%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.8%283.5%29s0" :
        {"versionEndIncluding" : "8.8%283.5%29s0", "versionStartIncluding" : "8.8%283.5%29s0", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
