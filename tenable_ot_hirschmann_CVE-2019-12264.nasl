#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502265);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/06/24");

  script_cve_id("CVE-2019-12264");
  script_xref(name:"CEA-ID", value:"CEA-2019-0679");

  script_name(english:"Hirschmann HiOS Switches Argument Injection or Modification (CVE-2019-12264)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"An attacker residing on the LAN may choose to hijack a DHCP-client session 
that requests an IPv4 address. The attacker can send a multicast IP-address in 
the DHCP offer/ack message, which the victim system then incorrectly assigns. 

This vulnerability can be combined with CVE-2019-12259 to create a denial-of-service condition.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://support2.windriver.com/index.php?page=cve&on=view&id=CVE-2019-12264
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?49fa5c3a");
  # https://www.windriver.com/security/announcements/tcp-ip-network-stack-ipnet-urgent11/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c7d3d59d");
  script_set_attribute(attribute:"see_also", value:"https://support.f5.com/csp/article/K41190253");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-189842.pdf");
  # https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbhf03960en_us
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ce6391b3");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-19-211-0");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Wind River has produced controls and patches to mitigate the reported vulnerabilities. To obtain patches, email
PSIRT@windriver.com and indicate the VxWorks major version for which you need source patches.

For more detailed information on the vulnerabilities and the mitigating controls, please see the Wind River advisory at:
https://www.windriver.com/security/announcements/tcp-ip-network-stack-ipnet-urgent11/

Additional vendors affected by the reported vulnerabilities have also released security advisories related to their
affected products. Those advisories are as follows:

Rockwell Automation (login required) - https://rockwellautomation.custhelp.com/app/answers/detail/a_id/1088561

Xerox - https://security.business.xerox.com/en-us/news/wind-river-vxworks-ipnet-tcp-ip-stack-vulnerabilities/

Dräger – https://static.draeger.com/security

Schneider Electric – https://www.se.com/ww/en/download/document/SESB-2019-214-01/");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:N/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-12264");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(88);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/08/05");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/08/05");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/06/10");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rail_switch_power_lite");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rail_switch_power_smart");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rsp20");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rsp25");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rsp30");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rsp35");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rspe30");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rspe32");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rspe35");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_rspe37");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_dragon_mach4000");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_dragon_mach4500");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_eagle20");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_eagle30");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:belden:hirschmann_eagle_one");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Hirschmann");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Hirschmann');

var asset = tenable_ot::assets::get(vendor:'Hirschmann');

var vuln_cpes = {
    "cpe:/h:belden:hirschmann_rail_switch_power_lite" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rail_switch_power_smart" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rsp20" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rsp25" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rsp30" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rsp35" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rspe30" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rspe32" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rspe35" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_rspe37" :
        {"versionEndIncluding" : "07.0.07", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_dragon_mach4000" :
        {"versionEndIncluding" : "07.2.04", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_dragon_mach4500" :
        {"versionEndIncluding" : "07.2.04", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_eagle20" :
        {"versionEndIncluding" : "05.3.06", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_eagle30" :
        {"versionEndIncluding" : "05.3.06", "family" : "Hirschmann"},
    "cpe:/h:belden:hirschmann_eagle_one" :
        {"versionEndIncluding" : "05.3.06", "family" : "Hirschmann"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
