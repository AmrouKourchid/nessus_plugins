#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502282);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2017-7912");
  script_xref(name:"ICSA", value:"17-136-03");

  script_name(english:"Hanwha Techwin SRN-4000 Improper Access Control (CVE-2017-7912)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A security research organization has discovered and disclosed a critical 
vulnerability in the firmware of certain Hanwha network video recording (NVR) 
devices. A specially crafted http request and response could allow an attacker to gain 
access to the device management page with admin privileges without proper authentication. 
Firmware to address the exploit has been developed and released.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.hanwhavision.com/wp-content/uploads/2021/10/CVE-2017-7912-Vulnerability-Report-1.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?5bac32c8");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-17-136-03");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Hanwha Techwin recommends that users update to firmware Version SRN4000_v2.16_170401.zip or newer.

The latest firmware version can be obtained from the following location:

https://www.hanwha-security.com/

(Products > Video Recorders > SRN-4000 > Download > Firmware)");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-7912");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/04/08");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/04/08");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/06/26");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:srn-1673s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:srn-873s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:srn-473s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:srn-4000_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/HanwhaVision");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/HanwhaVision');

var asset = tenable_ot::assets::get(vendor:'HanwhaVision');

var vuln_cpes = {
    "cpe:/o:hanwhavision:srn-1673s_firmware" :
        {"versionEndIncluding" : "1.08.160811", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:srn-873s_firmware" :
        {"versionEndIncluding" : "1.08.160811", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:srn-473s_firmware" :
        {"versionEndIncluding" : "1.08.160811", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:srn-4000_firmware" :
        {"versionEndIncluding" : "2.16.170401", "family" : "HanwhaVideoRecorders"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
