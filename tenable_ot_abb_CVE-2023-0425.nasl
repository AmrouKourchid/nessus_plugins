#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502379);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/09");

  script_cve_id("CVE-2023-0425");

  script_name(english:"ABB Freelance AC 900F and AC 700F Numeric Range Comparison Without Minimum Check (CVE-2023-0425)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"ABB is aware of vulnerabilities in the product versions listed below.
An update is available that resolves the reported vulnerabilities in
the product versions under maintenance. An attacker who successfully
exploited one or more of these vulnerabilities could cause the product
to stop or make the product inaccessible. Numeric Range Comparison
Without Minimum Check vulnerability in ABB Freelance controllers AC
700F (Controller modules), ABB Freelance controllers AC 900F
(controller modules).This issue affects: Freelance controllers AC
700F: from 9.0;0 through V9.2 SP2, through Freelance 2013, through
Freelance 2013SP1, through Freelance 2016, through Freelance 2016SP1,
through Freelance 2019, through Freelance 2019 SP1, through Freelance
2019 SP1 FP1; Freelance controllers AC 900F: Freelance 2013, through
Freelance 2013SP1, through Freelance 2016, through Freelance 2016SP1,
through Freelance 2019, through Freelance 2019 SP1, through Freelance
2019 SP1 FP1.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://search.abb.com/library/Download.aspx?DocumentID=7PAA007517&LanguageCode=en&DocumentPartId=&Action=Launch&_ga=2.68514131.339223974.1691382343-1911411808.1686627590
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?5bd74d8d");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-0425");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(839);

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/08/07");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/08/07");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/09/06");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:ac700f_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:ac900f_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/ABB");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/ABB');

var asset = tenable_ot::assets::get(vendor:'ABB');

var vuln_cpes = {
    "cpe:/o:abb:ac700f_firmware" :
        {"versionEndExcluding" : "9.3", "family" : "AC700F"},
    "cpe:/o:abb:ac900f_firmware" :
        {"versionEndExcluding" : "9.3", "family" : "AC900F"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
