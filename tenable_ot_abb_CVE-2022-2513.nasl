#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500711);
  script_version("1.9");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2022-2513");
  script_xref(name:"ICSA", value:"22-333-02");

  script_name(english:"Hitachi Energy IED Connectivity Packages and PCM600 Products Cleartext Storage of Sensitive Information (CVE-2022-2513)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability exists in the Intelligent Electronic Device (IED) Connectivity Package (ConnPack) credential storage
function in Hitachi Energy's PCM600 product included in the versions listed below, where IEDs credentials are stored in
a cleartext format in the PCM600 database. An attacker who manages to get access to the exported backup file can exploit
the vulnerability and obtain credentials of the IEDs. The credentials may be used to perform unauthorized modifications
such as loading incorrect configurations, reboot the IEDs or cause a denial-of-service on the IEDs.

  - A vulnerability exists in the Intelligent Electronic Device (IED) Connectivity Package (ConnPack)
    credential storage function in Hitachi Energy's PCM600 product included in the versions listed below,
    where IEDs credentials are stored in a cleartext format in the PCM600 database. An attacker who manages to
    get access to the exported backup file can exploit the vulnerability and obtain credentials of the IEDs.
    The credentials may be used to perform unauthorized modifications such as loading incorrect
    configurations, reboot the IEDs or cause a denial-of-service on the IEDs. (CVE-2022-2513)

This plugin only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://search.abb.com/library/Download.aspx?DocumentID=8DBD000120&LanguageCode=en&DocumentPartId=&Action=Launch
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?650516de");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-22-333-02");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Hitachi Energy released the following recommended immediate actions:

- Update to PCM600 v2.11 Hotfix 20240426 or apply mitigation factors/workarounds as described below.

After applying the hotfix, reimport and export the backup files to secure that they do not contain this vulnerability.
More information to deploy PCM600 securely can be found in the following documents:");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:S/C:C/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-2513");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(312);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/11/22");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/11/22");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/11/30");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:relion_650_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:relion_670_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:relion_sam600-io_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/ABB");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/ABB');

var asset = tenable_ot::assets::get(vendor:'ABB');

var vuln_cpes = {
    "cpe:/o:abb:relion_670_firmware" :
        {"versionEndIncluding" : "3.4.1", "versionStartIncluding" : "3.0", "family" : "AbbRelion"},
    "cpe:/o:abb:relion_650_firmware" :
        {"versionEndIncluding" : "2.4.1", "versionStartIncluding" : "1.3", "family" : "AbbRelion"},
    "cpe:/o:abb:relion_sam600-io_firmware" :
        {"versionEndIncluding" : "1.2", "versionStartIncluding" : "1.0", "family" : "AbbRelion"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
