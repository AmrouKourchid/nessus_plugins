#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502454);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/10/02");

  script_cve_id("CVE-2017-5753");

  script_name(english:"Synology DiskStation Manager Observable Discrepancy (CVE-2017-5753)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Systems with microprocessors utilizing speculative execution and
branch prediction may allow unauthorized disclosure of information to
an attacker with local user access via a side-channel analysis.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # http://lists.opensuse.org/opensuse-security-announce/2018-01/msg00006.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?6b559eed");
  # http://lists.opensuse.org/opensuse-security-announce/2018-01/msg00007.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?de58c590");
  # http://lists.opensuse.org/opensuse-security-announce/2018-01/msg00008.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?851713fe");
  # http://lists.opensuse.org/opensuse-security-announce/2018-01/msg00014.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?cd8ae14e");
  # http://lists.opensuse.org/opensuse-security-announce/2018-01/msg00016.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?28c4c0a0");
  script_set_attribute(attribute:"see_also", value:"http://nvidia.custhelp.com/app/answers/detail/a_id/4609");
  script_set_attribute(attribute:"see_also", value:"http://nvidia.custhelp.com/app/answers/detail/a_id/4611");
  script_set_attribute(attribute:"see_also", value:"http://nvidia.custhelp.com/app/answers/detail/a_id/4613");
  script_set_attribute(attribute:"see_also", value:"http://nvidia.custhelp.com/app/answers/detail/a_id/4614");
  # http://packetstormsecurity.com/files/145645/Spectre-Information-Disclosure-Proof-Of-Concept.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a875b3c1");
  script_set_attribute(attribute:"see_also", value:"http://www.arubanetworks.com/assets/alert/ARUBA-PSA-2018-001.txt");
  script_set_attribute(attribute:"see_also", value:"http://www.arubanetworks.com/assets/alert/ARUBA-PSA-2019-003.txt");
  script_set_attribute(attribute:"see_also", value:"http://www.kb.cert.org/vuls/id/584653");
  # http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?76507bf8");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/102371");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1040071");
  script_set_attribute(attribute:"see_also", value:"http://xenbits.xen.org/xsa/advisory-254.html");
  script_set_attribute(attribute:"see_also", value:"https://access.redhat.com/errata/RHSA-2018:0292");
  # https://access.redhat.com/security/vulnerabilities/speculativeexecution
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?892ef523");
  script_set_attribute(attribute:"see_also", value:"https://aws.amazon.com/de/security/security-bulletins/AWS-2018-013/");
  # https://blog.mozilla.org/security/2018/01/03/mitigations-landing-new-class-timing-attack/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1eae8cc9");
  script_set_attribute(attribute:"see_also", value:"https://cdrdv2.intel.com/v1/dl/getContent/685359");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-505225.pdf");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-608355.pdf");
  script_set_attribute(attribute:"see_also", value:"https://cert.vde.com/en-us/advisories/vde-2018-002");
  script_set_attribute(attribute:"see_also", value:"https://cert.vde.com/en-us/advisories/vde-2018-003");
  # https://developer.arm.com/support/arm-security-updates/speculative-processor-vulnerability
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c89c164f");
  # https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f6e3da0d");
  # https://help.ecostruxureit.com/display/public/UADCO8x/StruxureWare+Data+Center+Operation+Software+Vulnerability+Fixes
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2dc887f0");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2018/07/msg00015.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2018/07/msg00016.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2018/07/msg00020.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2019/03/msg00034.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2019/04/msg00004.html");
  # https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV180002
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?573cb1ef");
  script_set_attribute(attribute:"see_also", value:"https://seclists.org/bugtraq/2019/Jun/36");
  script_set_attribute(attribute:"see_also", value:"https://security.gentoo.org/glsa/201810-06");
  # https://security.googleblog.com/2018/01/todays-cpu-vulnerability-what-you-need.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?7c4ad7b8");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20180104-0001/");
  script_set_attribute(attribute:"see_also", value:"https://spectreattack.com/");
  script_set_attribute(attribute:"see_also", value:"https://support.citrix.com/article/CTX231399");
  script_set_attribute(attribute:"see_also", value:"https://support.f5.com/csp/article/K91229003");
  # https://support.hpe.com/hpsc/doc/public/display?docId=emr_na-hpesbhf03805en_us
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?576ccd7b");
  # https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbhf03871en_us
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2ec2d10c");
  script_set_attribute(attribute:"see_also", value:"https://support.lenovo.com/us/en/solutions/LEN-18282");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180104-cpusidechannel
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1bb35f47");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3540-1/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3540-2/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3541-1/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3541-2/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3542-1/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3542-2/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3549-1/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3580-1/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3597-1/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/3597-2/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/usn/usn-3516-1/");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2018/dsa-4187");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2018/dsa-4188");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/43427/");
  script_set_attribute(attribute:"see_also", value:"https://www.kb.cert.org/vuls/id/180049");
  # https://www.mitel.com/en-ca/support/security-advisories/mitel-product-security-advisory-18-0001
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?13a2a434");
  # https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?9166970d");
  # https://www.suse.com/c/suse-addresses-meltdown-spectre-vulnerabilities/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f5691f33");
  script_set_attribute(attribute:"see_also", value:"https://www.synology.com/support/security/Synology_SA_18_01");
  script_set_attribute(attribute:"see_also", value:"https://www.vmware.com/us/security/advisories/VMSA-2018-0002.html");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:M/Au:N/C:C/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:H/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:H/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-5753");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_set_attribute(attribute:"exploited_by_malware", value:"true");
  script_set_attribute(attribute:"exploit_framework_canvas", value:"true");
  script_set_attribute(attribute:"canvas_package", value:"CANVAS");
  script_cwe_id(203);

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/01/04");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/01/04");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/10/01");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:synology:diskstation_manager");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Synology");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Synology');

var asset = tenable_ot::assets::get(vendor:'Synology');

var vuln_cpes = {
    "cpe:/a:synology:diskstation_manager" :
        {"versionEndExcluding" : "6.2.2-24922", "versionStartIncluding" : "5.2", "family" : "DiskStation"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
