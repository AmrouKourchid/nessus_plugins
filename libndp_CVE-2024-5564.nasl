#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(200218);
  script_version("1.6");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/11/01");

  script_cve_id("CVE-2024-5564");
  script_xref(name:"IAVA", value:"2024-A-0326");

  script_name(english:"libndp >= 1.0 Buffer Overflow");

  script_set_attribute(attribute:"synopsis", value:
"An installed application on the remote host is affected by a buffer overflow vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability was found in libndp. This flaw allows a local malicious user to cause a buffer overflow in
NetworkManager, triggered by sending a malformed IPv6 router advertisement packet. This issue occurred as
libndp was not correctly validating the route length information.

Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version
number.");
  script_set_attribute(attribute:"see_also", value:"https://access.redhat.com/security/cve/CVE-2024-5564");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the version referenced in the vendor advisory.");
  script_set_attribute(attribute:"agent", value:"all");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:H/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-5564");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/05/31");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/05/31");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/06/07");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/a:libndp:libndp");
  script_set_attribute(attribute:"stig_severity", value:"I");
  script_set_attribute(attribute:"thorough_tests", value:"true");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Misc.");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("libndp_nix_installed.nbin");
  script_require_keys("installed_sw/Libndp");

  exit(0);
}

include('vcf.inc');

var app_info = vcf::get_app_info(app:'Libndp');
var os_release = get_kb_item('Host/RedHat/release');

# As of June 26, 2024, RHEL have not patched this yet, so this plugins needs to fire on RHEL installs
# Other vendors including Ubuntu, Debian and Amazon Linux have backported patches available via their 
# respective package managers, so we can do a backported check here for everything bar RHEL. 
if (empty_or_null(os_release) || 'Red Hat' >!< os_release)
  vcf::check_all_backporting(app_info:app_info);

var constraints = [
  {'min_version':'1.0', 'fixed_version': '1.99999', 'fixed_display':'See vendor advisory'}
];

vcf::check_version_and_report(
  app_info:app_info,
  constraints:constraints,
  severity:SECURITY_WARNING
);
