#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501364);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2019-1858");

  script_name(english:"Cisco FXOS and NX-OS Software Simple Network Management Protocol Denial of Service (CVE-2019-1858)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Simple Network Management Protocol (SNMP) input
packet processor of Cisco FXOS Software and Cisco NX-OS Software could
allow an unauthenticated, remote attacker to cause the SNMP
application to leak system memory, which could cause an affected
device to restart unexpectedly. The vulnerability is due to improper
error handling when processing inbound SNMP packets. An attacker could
exploit this vulnerability by sending multiple crafted SNMP packets to
an affected device. A successful exploit could allow the attacker to
cause the SNMP application to leak system memory because of an
improperly handled error condition during packet processing. Over
time, this memory leak could cause the SNMP application to restart
multiple times, leading to a system-level restart and a denial of
service (DoS) condition.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190515-nxos-snmp-dos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?53871ca2");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/108358");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-1858");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(755);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/05/16");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/05/16");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:14");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:8.1%281%29" :
        {"versionEndExcluding" : "8.1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i4%288%29" :
        {"versionEndExcluding" : "7.0%283%29i4%288%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7%282%29" :
        {"versionEndExcluding" : "7.0%283%29i7%282%29", "versionStartIncluding" : "7.0%283%29i7", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29f3%281%29" :
        {"versionEndExcluding" : "7.0%283%29f3%281%29", "versionStartIncluding" : "7.0%283%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%285%29n1%281b%29" :
        {"versionEndExcluding" : "7.1%285%29n1%281b%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%284%29n1%281a%29" :
        {"versionEndExcluding" : "7.3%284%29n1%281a%29", "versionStartIncluding" : "7.3", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.2%2822%29" :
        {"versionEndExcluding" : "6.2%2822%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.2%280%29d1%281%29" :
        {"versionEndExcluding" : "7.2%280%29d1%281%29", "versionStartIncluding" : "7.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:14.0%282c%29" :
        {"versionEndExcluding" : "14.0%282c%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:14.1%281i%29" :
        {"versionEndExcluding" : "14.1%281i%29", "versionStartIncluding" : "14.1", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29a8%284%29" :
        {"versionEndExcluding" : "6.0%282%29a8%284%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:5.2%281%29sv3%284.1a%29" :
        {"versionEndExcluding" : "5.2%281%29sv3%284.1a%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
