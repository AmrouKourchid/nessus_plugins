#TRUSTED 3d6878e7c779bfd941c793bdeb3e9533f634466a9ea294eab5b232933bf700f6806043a7422afa7803142b929d2d5714c5b311f5fbdf496e0a5aa6d39799b8f7ad47263fc1f1b67ec6a789ca0237a0713dcc2d33beea10fd3a39fd673307adc2c7c15407e1bceac8d45791b00055910443c20346d288d685e332c4b989cc80bb7925c72654778a42da898851d78996386cdb8c71551ecefbfc6f9956604574fa3ca87700f9d7e9c198b283b5f044980e6ceba99f0e567d4e1074548bfb451bed9b44e925d04fe68d0e5fd179df679b7bfb79fb02746c15683caa17bd1489e735391b214dc32d057b7cef82ef2676b465685e697f526d2b175ad42d963f01a2d6c20838919e4fab3c4fbeaee116883dc0e289aa155167374fc0af2305b4bb305cd5e213def640907a8248d43390f970673ec3eb16127210b8c2b35cd125244fed6659df58c74d0504d03e437e08e5f47a7bc577a7bb12131db0c9221d1055c5a2a3cb040497d9a956bfda1d87cf1fd69a16bde60353851c8af8f37c2dcd177e38e0aad6fcd358ee4c389e988f50bef830b895b4e85b93671208a24d8ac885c8f5fb81720df45b868a5c7eba0fdfa858f5beb955349ab9fef5247482f640a21a2cb6f1a8f30f0bc3df1e4f7d12693e1a6fef3e4db6ce24adc4294c97665112c0ab49d953e9f0e61ad669805558931b06828124c33b15e75fd4dad0cf45a8c0678b
#TRUST-RSA-SHA256 6c1ed13437cfdfa29a11a3c6c5d51d365e555840803bbaa62b3ad821f89bdaa2bc0092f2531c1de7a01a62fc52b6b763b0e4d0ea09a98fc117a6e136f757e9123823cc69ad5bc7e430020a1437cc17ad5c3aa9ba1c5d6b974e3b9967fdffe2f8d99eb0e370860b08b39012f3fcb7d8db7bdf7097387cdd426065cb04a632f53c352c200ce0c8cb5151a2e9f1567f773d104b2cf2993c566bfa971361e5acca5dadd318800e0f024cacc77dcc3b34d046f798f3c66fa7a61546783fe3d1cc92ddfa6427011a4fdd4968a1ee3d4897e576c8d1a28e99e1d8725b533dd8a167e2ab78af505ff35f14add571cfe090bb25e13a5dd8489026755c638ee051c3fcb45a83f83f44c5292fa65b89b0137b527605ce41eb7aa79df3c70fe6cffbf8842a489e9d13b404c6e87f3a4666eee0decd50decfec661a43b5084b48995c42414fea57fc798b5ff255530cf848c5b836cc28497d4d98717557625ddad092123a38d0cb52ade4490056a5d9b446279f48fdb557f53e2a4bca8cfb7048f434cbb9d191a761fc0680682eeae2a087c02692390f5b5acda959ef6015b60448ec43040e559f023f4dfbef1e08c3da65c6630da0553bafa3b6bb07e43b1e48a6c108c8b84a2aa31633c2eb174b8b2c6e45d13724d0f8f715e23ea7d120a58e3ae1ba48253353fc163dfe67bbd96ca692b1ecc3ebfc741516a46b8736ffd0ef8066ce614619
#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(215125);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/24");

  script_cve_id(
    "CVE-2025-20169",
    "CVE-2025-20170",
    "CVE-2025-20171",
    "CVE-2025-20172",
    "CVE-2025-20173",
    "CVE-2025-20174",
    "CVE-2025-20175",
    "CVE-2025-20176"
  );
  script_xref(name:"CISCO-BUG-ID", value:"CSCwm79554");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwm79564");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwm79570");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwm79577");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwm79581");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwm79590");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwm79596");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwm89600");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwn08493");
  script_xref(name:"CISCO-SA", value:"cisco-sa-snmp-dos-sdxnSUcW");
  script_xref(name:"IAVA", value:"2025-A-0084");

  script_name(english:"Cisco IOS XE Software SNMP DoS (cisco-sa-snmp-dos-sdxnSUcW)");

  script_set_attribute(attribute:"synopsis", value:
"The remote device is missing a vendor-supplied security patch");
  script_set_attribute(attribute:"description", value:
"According to its self-reported version, Cisco IOS-XE Software is affected by multiple vulnerabilities.

  - A vulnerability in the SNMP subsystem of Cisco IOS Software and Cisco IOS XE Software could allow an
    authenticated, remote attacker to cause a DoS condition on an affected device. This vulnerability is due
    to improper error handling when parsing SNMP requests. An attacker could exploit this vulnerability by
    sending a crafted SNMP request to an affected device. A successful exploit could allow the attacker to
    cause the device to reload unexpectedly, resulting in a DoS condition. This vulnerability affects
    SNMP versions 1, 2c, and 3. To exploit this vulnerability through SNMP v2c or earlier, the attacker must
    know a valid read-write or read-only SNMP community string for the affected system. To exploit this
    vulnerability through SNMP v3, the attacker must have valid SNMP user credentials for the affected system.
    (CVE-2025-20169, CVE-2025-20170, CVE-2025-20171, CVE-2025-20173, CVE-2025-20174, CVE-2025-20175,
    CVE-2025-20176)

  - A vulnerability in the SNMP subsystem of Cisco IOS Software, Cisco IOS XE Software, and Cisco IOS XR
    Software could allow an authenticated, remote attacker to cause a DoS condition on an affected device.
    This vulnerability is due to improper error handling when parsing SNMP requests. An attacker could exploit
    this vulnerability by sending a crafted SNMP request to an affected device. For Cisco IOS and IOS XE
    Software, a successful exploit could allow the attacker to cause the device to reload unexpectedly,
    resulting in a DoS condition. For Cisco IOS XR Software, a successful exploit could allow the attacker to
    cause the SNMP process to restart, resulting in an interrupted SNMP response from an affected device.
    Devices that are running Cisco IOS XR Software will not reload. This vulnerability affects SNMP
    versions 1, 2c, and 3. To exploit this vulnerability through SNMP v2c or earlier, the attacker must know a
    valid read-write or read-only SNMP community string for the affected system. To exploit this vulnerability
    through SNMP v3, the attacker must have valid SNMP user credentials for the affected system.
    (CVE-2025-20172)

Please see the included Cisco BIDs and Cisco Security Advisory for more information.");
  # https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snmp-dos-sdxnSUcW
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?8c4612f4");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwm79554");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwm79564");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwm79570");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwm79577");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwm79581");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwm79590");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwm79596");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwm89600");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwn08493");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the relevant fixed version referenced in Cisco bug IDs CSCwm79554, CSCwm79564, CSCwm79570, CSCwm79577,
CSCwm79581, CSCwm79590, CSCwm79596, CSCwm89600, CSCwn08493");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2025-20175");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(805);

  script_set_attribute(attribute:"vuln_publication_date", value:"2025/02/05");
  script_set_attribute(attribute:"patch_publication_date", value:"2025/02/05");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/02/07");

  script_set_attribute(attribute:"potential_vulnerability", value:"true");
  script_set_attribute(attribute:"plugin_type", value:"combined");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ios_xe");
  script_set_attribute(attribute:"stig_severity", value:"I");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CISCO");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("cisco_ios_xe_version.nasl");
  script_require_keys("Host/Cisco/IOS-XE/Version", "Settings/ParanoidReport");

  exit(0);
}

include('cisco_workarounds.inc');
include('ccf.inc');

if (report_paranoia < 2)
  audit(AUDIT_PARANOID);

var product_info = cisco::get_product_info(name:'Cisco IOS XE Software');

var version_list=make_list(
  '3.2.0SE',
  '3.2.0SG',
  '3.2.1SE',
  '3.2.1SG',
  '3.2.2SE',
  '3.2.2SG',
  '3.2.3SE',
  '3.2.3SG',
  '3.2.4SG',
  '3.2.5SG',
  '3.2.6SG',
  '3.2.7SG',
  '3.2.8SG',
  '3.2.9SG',
  '3.2.10SG',
  '3.2.11SG',
  '3.3.0SE',
  '3.3.0SG',
  '3.3.0SQ',
  '3.3.1SE',
  '3.3.1SG',
  '3.3.1SQ',
  '3.3.2SE',
  '3.3.2SG',
  '3.3.3SE',
  '3.3.4SE',
  '3.3.5SE',
  '3.4.0SG',
  '3.4.0SQ',
  '3.4.1SG',
  '3.4.1SQ',
  '3.4.2SG',
  '3.4.3SG',
  '3.4.4SG',
  '3.4.5SG',
  '3.4.6SG',
  '3.4.7SG',
  '3.4.8SG',
  '3.5.0E',
  '3.5.0SQ',
  '3.5.1E',
  '3.5.1SQ',
  '3.5.2E',
  '3.5.2SQ',
  '3.5.3E',
  '3.5.3SQ',
  '3.5.4SQ',
  '3.5.5SQ',
  '3.5.6SQ',
  '3.5.7SQ',
  '3.5.8SQ',
  '3.6.0E',
  '3.6.0aE',
  '3.6.0bE',
  '3.6.1E',
  '3.6.2E',
  '3.6.2aE',
  '3.6.3E',
  '3.6.4E',
  '3.6.5E',
  '3.6.5aE',
  '3.6.5bE',
  '3.6.6E',
  '3.6.7E',
  '3.6.7aE',
  '3.6.7bE',
  '3.6.8E',
  '3.6.9E',
  '3.6.9aE',
  '3.6.10E',
  '3.7.0E',
  '3.7.0S',
  '3.7.0bS',
  '3.7.0xaS',
  '3.7.0xbS',
  '3.7.1E',
  '3.7.1S',
  '3.7.1aS',
  '3.7.2E',
  '3.7.2S',
  '3.7.2tS',
  '3.7.3E',
  '3.7.3S',
  '3.7.4E',
  '3.7.4S',
  '3.7.4aS',
  '3.7.5E',
  '3.7.5S',
  '3.7.6S',
  '3.7.7S',
  '3.7.8S',
  '3.8.0E',
  '3.8.0S',
  '3.8.1E',
  '3.8.1S',
  '3.8.2E',
  '3.8.2S',
  '3.8.3E',
  '3.8.4E',
  '3.8.5E',
  '3.8.5aE',
  '3.8.6E',
  '3.8.7E',
  '3.8.8E',
  '3.8.9E',
  '3.8.10E',
  '3.8.10cE',
  '3.8.10dE',
  '3.9.0E',
  '3.9.0S',
  '3.9.0aS',
  '3.9.0xaS',
  '3.9.1E',
  '3.9.1S',
  '3.9.1aS',
  '3.9.2E',
  '3.9.2S',
  '3.9.2bE',
  '3.10.0E',
  '3.10.0S',
  '3.10.0cE',
  '3.10.1E',
  '3.10.1S',
  '3.10.1aE',
  '3.10.1sE',
  '3.10.1xbS',
  '3.10.1xcS',
  '3.10.2E',
  '3.10.2S',
  '3.10.2aS',
  '3.10.2tS',
  '3.10.3E',
  '3.10.3S',
  '3.10.4S',
  '3.10.5S',
  '3.10.6S',
  '3.10.7S',
  '3.10.8S',
  '3.10.8aS',
  '3.10.9S',
  '3.10.10S',
  '3.11.0E',
  '3.11.0S',
  '3.11.1E',
  '3.11.1S',
  '3.11.1aE',
  '3.11.2E',
  '3.11.2S',
  '3.11.2aE',
  '3.11.3E',
  '3.11.3S',
  '3.11.3aE',
  '3.11.4E',
  '3.11.4S',
  '3.11.5E',
  '3.11.6E',
  '3.11.7E',
  '3.11.8E',
  '3.11.9E',
  '3.11.10E',
  '3.11.11E',
  '3.12.0S',
  '3.12.0aS',
  '3.12.1S',
  '3.12.2S',
  '3.12.3S',
  '3.12.4S',
  '3.13.0S',
  '3.13.0aS',
  '3.13.1S',
  '3.13.2S',
  '3.13.2aS',
  '3.13.3S',
  '3.13.4S',
  '3.13.5S',
  '3.13.5aS',
  '3.13.6S',
  '3.13.6aS',
  '3.13.6bS',
  '3.13.7S',
  '3.13.7aS',
  '3.13.8S',
  '3.13.9S',
  '3.13.10S',
  '3.14.0S',
  '3.14.1S',
  '3.14.2S',
  '3.14.3S',
  '3.14.4S',
  '3.15.0S',
  '3.15.1S',
  '3.15.1cS',
  '3.15.2S',
  '3.15.3S',
  '3.15.4S',
  '3.16.0S',
  '3.16.0aS',
  '3.16.0bS',
  '3.16.0cS',
  '3.16.1S',
  '3.16.1aS',
  '3.16.2S',
  '3.16.2aS',
  '3.16.2bS',
  '3.16.3S',
  '3.16.3aS',
  '3.16.4S',
  '3.16.4aS',
  '3.16.4bS',
  '3.16.4cS',
  '3.16.4dS',
  '3.16.4eS',
  '3.16.4gS',
  '3.16.5S',
  '3.16.5aS',
  '3.16.5bS',
  '3.16.6S',
  '3.16.6bS',
  '3.16.7S',
  '3.16.7aS',
  '3.16.7bS',
  '3.16.8S',
  '3.16.9S',
  '3.16.10S',
  '3.16.10aS',
  '3.16.10bS',
  '3.17.0S',
  '3.17.1S',
  '3.17.1aS',
  '3.17.2S',
  '3.17.3S',
  '3.17.4S',
  '3.18.0S',
  '3.18.0SP',
  '3.18.0aS',
  '3.18.1S',
  '3.18.1SP',
  '3.18.1aSP',
  '3.18.1bSP',
  '3.18.1cSP',
  '3.18.1gSP',
  '3.18.1hSP',
  '3.18.1iSP',
  '3.18.2S',
  '3.18.2SP',
  '3.18.2aSP',
  '3.18.3S',
  '3.18.3SP',
  '3.18.3aSP',
  '3.18.3bSP',
  '3.18.4S',
  '3.18.4SP',
  '3.18.5SP',
  '3.18.6SP',
  '3.18.7SP',
  '3.18.8aSP',
  '3.18.9SP',
  '16.1.1',
  '16.1.2',
  '16.1.3',
  '16.2.1',
  '16.2.2',
  '16.3.1',
  '16.3.1a',
  '16.3.2',
  '16.3.3',
  '16.3.4',
  '16.3.5',
  '16.3.5b',
  '16.3.6',
  '16.3.7',
  '16.3.8',
  '16.3.9',
  '16.3.10',
  '16.3.11',
  '16.4.1',
  '16.4.2',
  '16.4.3',
  '16.5.1',
  '16.5.1a',
  '16.5.1b',
  '16.5.2',
  '16.5.3',
  '16.6.1',
  '16.6.2',
  '16.6.3',
  '16.6.4',
  '16.6.4a',
  '16.6.4s',
  '16.6.5',
  '16.6.5a',
  '16.6.5b',
  '16.6.6',
  '16.6.7',
  '16.6.7a',
  '16.6.8',
  '16.6.9',
  '16.6.10',
  '16.7.1',
  '16.7.1a',
  '16.7.1b',
  '16.7.2',
  '16.7.3',
  '16.7.4',
  '16.8.1',
  '16.8.1a',
  '16.8.1b',
  '16.8.1c',
  '16.8.1d',
  '16.8.1e',
  '16.8.1s',
  '16.8.2',
  '16.8.3',
  '16.9.1',
  '16.9.1a',
  '16.9.1b',
  '16.9.1c',
  '16.9.1d',
  '16.9.1s',
  '16.9.2',
  '16.9.2a',
  '16.9.2s',
  '16.9.3',
  '16.9.3a',
  '16.9.3h',
  '16.9.3s',
  '16.9.4',
  '16.9.4c',
  '16.9.5',
  '16.9.6',
  '16.9.7',
  '16.9.8',
  '16.9.8a',
  '16.9.8b',
  '16.10.1',
  '16.10.1a',
  '16.10.1b',
  '16.10.1c',
  '16.10.1d',
  '16.10.1e',
  '16.10.1f',
  '16.10.1g',
  '16.10.1s',
  '16.10.2',
  '16.10.3',
  '16.11.1',
  '16.11.1a',
  '16.11.1b',
  '16.11.1c',
  '16.11.1s',
  '16.11.2',
  '16.12.1',
  '16.12.1a',
  '16.12.1c',
  '16.12.1s',
  '16.12.1t',
  '16.12.1w',
  '16.12.1x',
  '16.12.1y',
  '16.12.1z',
  '16.12.1z1',
  '16.12.1z2',
  '16.12.2',
  '16.12.2a',
  '16.12.2s',
  '16.12.2t',
  '16.12.3',
  '16.12.3a',
  '16.12.3s',
  '16.12.4',
  '16.12.4a',
  '16.12.5',
  '16.12.5a',
  '16.12.5b',
  '16.12.6',
  '16.12.6a',
  '16.12.7',
  '16.12.8',
  '16.12.9',
  '16.12.10',
  '16.12.10a',
  '16.12.11',
  '16.12.12',
  '17.1.1',
  '17.1.1a',
  '17.1.1s',
  '17.1.1t',
  '17.1.2',
  '17.1.3',
  '17.2.1',
  '17.2.1a',
  '17.2.1r',
  '17.2.1v',
  '17.2.2',
  '17.2.3',
  '17.3.1',
  '17.3.1a',
  '17.3.1w',
  '17.3.1x',
  '17.3.1z',
  '17.3.2',
  '17.3.2a',
  '17.3.3',
  '17.3.3a',
  '17.3.4',
  '17.3.4a',
  '17.3.4b',
  '17.3.4c',
  '17.3.5',
  '17.3.5a',
  '17.3.5b',
  '17.3.6',
  '17.3.7',
  '17.3.8',
  '17.3.8a',
  '17.4.1',
  '17.4.1a',
  '17.4.1b',
  '17.4.1c',
  '17.4.2',
  '17.4.2a',
  '17.5.1',
  '17.5.1a',
  '17.5.1b',
  '17.5.1c',
  '17.6.1',
  '17.6.1a',
  '17.6.1w',
  '17.6.1x',
  '17.6.1y',
  '17.6.1z',
  '17.6.1z1',
  '17.6.2',
  '17.6.3',
  '17.6.3a',
  '17.6.4',
  '17.6.5',
  '17.6.5a',
  '17.6.6',
  '17.6.6a',
  '17.6.7',
  '17.6.8',
  '17.6.8a',
  '17.7.1',
  '17.7.1a',
  '17.7.1b',
  '17.7.2',
  '17.8.1',
  '17.8.1a',
  '17.9.1',
  '17.9.1a',
  '17.9.1w',
  '17.9.1x',
  '17.9.1x1',
  '17.9.1y',
  '17.9.1y1',
  '17.9.2',
  '17.9.2a',
  '17.9.3',
  '17.9.3a',
  '17.9.4',
  '17.9.4a',
  '17.9.5',
  '17.9.5a',
  '17.9.5b',
  '17.9.5c',
  '17.9.5d',
  '17.9.5e',
  '17.9.6',
  '17.9.6a',
  '17.9.6b',
  '17.10.1',
  '17.10.1a',
  '17.10.1b',
  '17.11.1',
  '17.11.1a',
  '17.11.99SW',
  '17.12.1',
  '17.12.1a',
  '17.12.1w',
  '17.12.1x',
  '17.12.1y',
  '17.12.1z',
  '17.12.1z1',
  '17.12.1z2',
  '17.12.2',
  '17.12.2a',
  '17.12.3',
  '17.12.3a',
  '17.12.4',
  '17.12.4a',
  '17.12.4b',
  '17.13.1',
  '17.13.1a',
  '17.14.1',
  '17.14.1a',
  '17.15.1',
  '17.15.1a',
  '17.15.1b',
  '17.15.1w',
  '17.15.1x',
  '17.15.2',
  '17.15.2a',
  '17.15.2b',
  '17.15.2c',
  '17.16.1',
  '17.16.1a'
);

var workarounds = make_list(CISCO_WORKAROUNDS['generic_workaround']);
var workaround_params = [WORKAROUND_CONFIG['snmp3-enabled'], WORKAROUND_CONFIG['snmp3-users'], WORKAROUND_CONFIG['snmp-server']];

var reporting = make_array(
  'port'    , product_info['port'],
  'severity', SECURITY_WARNING,
  'version' , product_info['version'],
  'bug_id'  , 'CSCwm79554, CSCwm79564, CSCwm79570, CSCwm79577, CSCwm79581, CSCwm79590, CSCwm79596, CSCwm89600, CSCwn08493',
  'cmds'    , make_list('show running-config', 'show snmp user')
);

cisco::check_and_report(
  product_info:product_info,
  workarounds:workarounds,
  workaround_params:workaround_params,
  reporting:reporting,
  vuln_versions:version_list
);