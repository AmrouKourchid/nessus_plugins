#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502355);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2024-39675");
  script_xref(name:"ICSA", value:"24-193-06");

  script_name(english:"Siemens RUGGEDCOM Exposure of Sensitive System Information to an Unauthorized Control Sphere (CVE-2024-39675)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"In some configurations the affected products wrongly enable the Modbus
service in non-managed VLANS. Only serial devices are affected by this
vulnerability.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://cert-portal.siemens.com/productcert/html/ssa-170375.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?41658bf9");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-24-193-06");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has prepared fixed versions and recommends countermeasures for products where fixes are not available.

(CVE-2024-39675) RUGGEDCOM RMC30, RUGGEDCOM RP110, RUGGEDCOM RS400, RUGGEDCOM RS401, RUGGEDCOM RS416,
RUGGEDCOM RS416Pv2 V4.X, RUGGEDCOM RS416v2 V4.X, RUGGEDCOM RS910, RUGGEDCOM RS910W, RUGGEDCOM RMC30NC,
RUGGEDCOM RP110NC, RUGGEDCOM RS400NC, RUGGEDCOM RS401NC, RUGGEDCOM RS416NC, RUGGEDCOM RS416NCv2 V4.X, RUGGEDCOM RS416P,
RUGGEDCOM RS416PNC, RUGGEDCOM RS416PNCv2 V4.X, RUGGEDCOM RS910NC: Update to V4.3.10 or later version

(CVE-2024-39675) RUGGEDCOM RS416Pv2 V5.X, RUGGEDCOM RS416v2 V5.X, RUGGEDCOM RS416NCv2 V5.X, RUGGEDCOM RS416PNCv2 V5.X:
Update to V5.9.0 or later version

(CVE-2024-39675) RUGGEDCOM RS910L, RUGGEDCOM RS910LNC, RUGGEDCOM RS920L, RUGGEDCOM RS920LNC,
RUGGEDCOM RS920W: Currently no fix is planned

Siemens has identified the following specific workarounds and mitigations users can apply to reduce risk:

(CVE-2024-39675) RUGGEDCOM RMC30, RUGGEDCOM RMC30NC, RUGGEDCOM RP110, RUGGEDCOM RP110NC, RUGGEDCOM RS400,
RUGGEDCOM RS400NC, RUGGEDCOM RS401, RUGGEDCOM RS401NC, RUGGEDCOM RS416, RUGGEDCOM RS416NC, RUGGEDCOM RS416NCv2 V4.X,
RUGGEDCOM RS416NCv2 V5.X, RUGGEDCOM RS416P, RUGGEDCOM RS416PNC, RUGGEDCOM RS416PNCv2 V4.X, RUGGEDCOM RS416PNCv2 V5.X,
RUGGEDCOM RS416Pv2 V4.X, RUGGEDCOM RS416Pv2 V5.X, RUGGEDCOM RS416v2 V4.X, RUGGEDCOM RS416v2 V5.X, RUGGEDCOM RS910,
RUGGEDCOM RS910L, RUGGEDCOM RS910LNC, RUGGEDCOM RS910NC, RUGGEDCOM RS910W, RUGGEDCOM RS920L, RUGGEDCOM RS920LNC,
RUGGEDCOM RS920W: Disable the Modbus Server if not required on the affected system. Restrict the access to Port 502/tcp
to trusted IP address only. Also note, Modbus is disabled by default.

As a general security measure, Siemens recommends protecting network access to devices with appropriate mechanisms.
To operate the devices in a protected IT environment, Siemens recommends configuring the environment according to
Siemens' operational guidelines for industrial security and following recommendations in the product manuals.

Additional information on industrial security by Siemens can be found on the Siemens industrial security webpage.

For more information see the associated Siemens security advisory SSA-17037.");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-39675");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(497);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/07/09");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/07/09");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/08/08");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rmc30_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rmc30nc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rp110_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rp110nc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs400_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs400nc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs401_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs401nc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416nc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416ncv2_firmware:v4.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416ncv2_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416p_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416pnc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416pncv2_firmware:v4.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416pncv2_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416pv2_firmware:v4.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416pv2_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416v2_firmware:v4.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416v2_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs910_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs910l_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs910lnc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs910nc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs910w_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs920l_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs920lnc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs920w_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:ruggedcom_rmc30_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rmc30nc_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rp110_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rp110nc_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs400_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs400nc_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs401_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs401nc_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416nc_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416ncv2_firmware:v4.x":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416ncv2_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416p_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416pnc_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416pncv2_firmware:v4.x":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416pncv2_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416pv2_firmware:v4.x":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416pv2_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416v2_firmware:v4.x":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416v2_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs910_firmware":
        {"family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs910l_firmware":
        {"family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs910lnc_firmware":
        {"family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs910nc_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs910w_firmware":
        {"versionEndExcluding": "v4.3.10", "versionStartIncluding": "v4.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs920l_firmware":
        {"family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs920lnc_firmware":
        {"family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs920w_firmware":
        {"family": "RuggedCom"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
