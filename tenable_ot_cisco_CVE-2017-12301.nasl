#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501390);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2017-12301");

  script_name(english:"Cisco NX-OS Software Python Parser Escape (CVE-2017-12301)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Python scripting subsystem of Cisco NX-OS
Software could allow an authenticated, local attacker to escape the
Python parser and gain unauthorized access to the underlying operating
system of the device. The vulnerability exists due to insufficient
sanitization of user-supplied parameters that are passed to certain
Python functions within the scripting sandbox of the affected device.
An attacker could exploit this vulnerability to escape the scripting
sandbox and execute arbitrary commands on the underlying operating
system with the privileges of the authenticated user. To exploit this
vulnerability, an attacker must have local access and be authenticated
to the targeted device with administrative or Python execution
privileges. These requirements could limit the possibility of a
successful exploit. This vulnerability affects the following Cisco
products if they are running Cisco NX-OS Software: Multilayer Director
Switches, Nexus 2000 Series Fabric Extenders, Nexus 3000 Series
Switches, Nexus 3500 Platform Switches, Nexus 5000 Series Switches,
Nexus 5500 Platform Switches, Nexus 5600 Platform Switches, Nexus 6000
Series Switches, Nexus 7000 Series Switches, Nexus 7700 Series
Switches, Nexus 9000 Series Switches - Standalone, NX-OS mode, Nexus
9500 R-Series Line Cards and Fabric Modules. Cisco Bug IDs:
CSCvb86832, CSCvd86474, CSCvd86479, CSCvd86484, CSCvd86490,
CSCve97102, CSCvf12757, CSCvf12804, CSCvf12815, CSCvf15198.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1039622");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20171018-ppe
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f51931d1");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-12301");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/10/19");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/10/19");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.0%282%29a8%283%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.0%282%29a8%286.213%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i4%286%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.3%282%29d1%280.21%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.0%280.74%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.0%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1%280%29bd%280.20%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1%280.70%29s0");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:7.0%283%29i4%286%29" :
        {"versionEndIncluding" : "7.0%283%29i4%286%29", "versionStartIncluding" : "7.0%283%29i4%286%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1%280%29bd%280.20%29" :
        {"versionEndIncluding" : "8.1%280%29bd%280.20%29", "versionStartIncluding" : "8.1%280%29bd%280.20%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%282%29d1%280.21%29" :
        {"versionEndIncluding" : "7.3%282%29d1%280.21%29", "versionStartIncluding" : "7.3%282%29d1%280.21%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.0%280.74%29" :
        {"versionEndIncluding" : "8.0%280.74%29", "versionStartIncluding" : "8.0%280.74%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.0%281%29" :
        {"versionEndIncluding" : "8.0%281%29", "versionStartIncluding" : "8.0%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1%280.70%29s0" :
        {"versionEndIncluding" : "8.1%280.70%29s0", "versionStartIncluding" : "8.1%280.70%29s0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29a8%283%29" :
        {"versionEndIncluding" : "6.0%282%29a8%283%29", "versionStartIncluding" : "6.0%282%29a8%283%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29a8%286.213%29" :
        {"versionEndIncluding" : "6.0%282%29a8%286.213%29", "versionStartIncluding" : "6.0%282%29a8%286.213%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29" :
        {"versionEndIncluding" : "7.0%280%29hsk%280.357%29", "versionStartIncluding" : "7.0%280%29hsk%280.357%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
