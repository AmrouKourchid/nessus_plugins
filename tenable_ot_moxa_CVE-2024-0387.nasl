#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(503048);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/26");

  script_cve_id("CVE-2024-0387");

  script_name(english:"Moxa EDS-4000/G4000 Series Initialization of a Resource with an Insecure Default (CVE-2024-0387)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The EDS-4000/G4000 Series prior to version 3.2 includes IP forwarding
capabilities that users cannot deactivate. An attacker may be able to
send requests to the product and have it forwarded to the target. An
attacker can bypass access controls or hide the source of malicious
requests.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.moxa.com/en/support/product-support/security-advisory/mpsa-237129-eds-4000-g4000-series-ip-forwarding-vulnerability?viewmode=0
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d69534a3");
  # https://www.moxa.com/en/support/product-support/security-advisory/mpsa-237129-eds-4000-g4000-series-ip-forwarding-vulnerability?viewmode=0
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d69534a3");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-0387");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(1188);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/02/26");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/02/26");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/02/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-4008_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-4009_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-4012_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-4014_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-g4008_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-g4012_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-g4014_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Moxa");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Moxa');

var asset = tenable_ot::assets::get(vendor:'Moxa');

var vuln_cpes = {
    "cpe:/o:moxa:eds-4008_firmware" :
        {"versionEndIncluding" : "3.2", "family" : "MoxaEDS"},
    "cpe:/o:moxa:eds-4009_firmware" :
        {"versionEndIncluding" : "3.2", "family" : "MoxaEDS"},
    "cpe:/o:moxa:eds-4012_firmware" :
        {"versionEndIncluding" : "3.2", "family" : "MoxaEDS"},
    "cpe:/o:moxa:eds-4014_firmware" :
        {"versionEndIncluding" : "3.2", "family" : "MoxaEDS"},
    "cpe:/o:moxa:eds-g4008_firmware" :
        {"versionEndIncluding" : "3.2", "family" : "MoxaEDS"},
    "cpe:/o:moxa:eds-g4012_firmware" :
        {"versionEndIncluding" : "3.2", "family" : "MoxaEDS"},
    "cpe:/o:moxa:eds-g4014_firmware" :
        {"versionEndIncluding" : "3.2", "family" : "MoxaEDS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
