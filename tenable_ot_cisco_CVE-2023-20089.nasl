#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501386);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2023-20089");

  script_name(english:"Cisco Nexus 9000 Series Fabric Switches in ACI Mode Link Layer Discovery Protocol Memory Leak Denial of Service (CVE-2023-20089)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Link Layer Discovery Protocol (LLDP) feature
for Cisco Nexus 9000 Series Fabric Switches in Application Centric
Infrastructure (ACI) Mode could allow an unauthenticated, adjacent
attacker to cause a memory leak, which could result in an unexpected
reload of the device. This vulnerability is due to incorrect error
checking when parsing ingress LLDP packets. An attacker could exploit
this vulnerability by sending a steady stream of crafted LLDP packets
to an affected device. A successful exploit could allow the attacker
to cause a memory leak, which could result in a denial of service
(DoS) condition when the device unexpectedly reloads. Note: This
vulnerability cannot be exploited by transit traffic through the
device. The crafted LLDP packet must be targeted to a directly
connected interface, and the attacker must be in the same broadcast
domain as the affected device (Layer 2 adjacent). In addition, the
attack surface for this vulnerability can be reduced by disabling LLDP
on interfaces where it is not required.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-aci-lldp-dos-ySCNZOpX
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?65ab8fb4");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-20089");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(401);

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/02/23");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/02/23");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%281g%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%282e%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%282f%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%282g%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%282h%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%283e%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%283f%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%283g%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%284d%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%284e%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%284f%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%285c%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%285d%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.2%285e%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:16.0%281g%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:16.0%281j%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:15.2%281g%29" :
        {"versionEndIncluding" : "15.2%281g%29", "versionStartIncluding" : "15.2%281g%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%282e%29" :
        {"versionEndIncluding" : "15.2%282e%29", "versionStartIncluding" : "15.2%282e%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%282f%29" :
        {"versionEndIncluding" : "15.2%282f%29", "versionStartIncluding" : "15.2%282f%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%282g%29" :
        {"versionEndIncluding" : "15.2%282g%29", "versionStartIncluding" : "15.2%282g%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%282h%29" :
        {"versionEndIncluding" : "15.2%282h%29", "versionStartIncluding" : "15.2%282h%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%283e%29" :
        {"versionEndIncluding" : "15.2%283e%29", "versionStartIncluding" : "15.2%283e%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%283f%29" :
        {"versionEndIncluding" : "15.2%283f%29", "versionStartIncluding" : "15.2%283f%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%283g%29" :
        {"versionEndIncluding" : "15.2%283g%29", "versionStartIncluding" : "15.2%283g%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%284d%29" :
        {"versionEndIncluding" : "15.2%284d%29", "versionStartIncluding" : "15.2%284d%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%284e%29" :
        {"versionEndIncluding" : "15.2%284e%29", "versionStartIncluding" : "15.2%284e%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%284f%29" :
        {"versionEndIncluding" : "15.2%284f%29", "versionStartIncluding" : "15.2%284f%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%285c%29" :
        {"versionEndIncluding" : "15.2%285c%29", "versionStartIncluding" : "15.2%285c%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%285d%29" :
        {"versionEndIncluding" : "15.2%285d%29", "versionStartIncluding" : "15.2%285d%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.2%285e%29" :
        {"versionEndIncluding" : "15.2%285e%29", "versionStartIncluding" : "15.2%285e%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:16.0%281g%29" :
        {"versionEndIncluding" : "16.0%281g%29", "versionStartIncluding" : "16.0%281g%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:16.0%281j%29" :
        {"versionEndIncluding" : "16.0%281j%29", "versionStartIncluding" : "16.0%281j%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
