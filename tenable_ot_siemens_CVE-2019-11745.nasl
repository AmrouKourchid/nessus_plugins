#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501619);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2019-11745");
  script_xref(name:"ICSA", value:"21-040-04");
  script_xref(name:"SuSE", value:"openSUSE-SU-2020:0003");
  script_xref(name:"SuSE", value:"openSUSE-SU-2020:0002");
  script_xref(name:"SuSE", value:"openSUSE-SU-2020:0008");
  script_xref(name:"RHSA", value:"RHSA-2020:0243");
  script_xref(name:"RHSA", value:"RHSA-2020:0466");
  script_xref(name:"GLSA", value:"GLSA-202003-02");
  script_xref(name:"GLSA", value:"GLSA-202003-10");
  script_xref(name:"GLSA", value:"GLSA-202003-37");
  script_xref(name:"USN", value:"USN-4241-1");
  script_xref(name:"USN", value:"USN-4335-1");

  script_name(english:"Siemens RUGGEDCOM ROX II Out-of-Bounds Write (CVE-2019-11745)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"When encrypting with a block cipher, if a call to NSC_EncryptUpdate
was made with data smaller than the block size, a small out of bounds
write could occur. This could have caused heap corruption and a
potentially exploitable crash. This vulnerability affects Thunderbird
< 68.3, Firefox ESR < 68.3, and Firefox < 71.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # http://lists.opensuse.org/opensuse-security-announce/2020-01/msg00000.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f86d1ef2");
  # http://lists.opensuse.org/opensuse-security-announce/2020-01/msg00001.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2172b04a");
  # http://lists.opensuse.org/opensuse-security-announce/2020-01/msg00006.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?8bfdcfbe");
  script_set_attribute(attribute:"see_also", value:"https://access.redhat.com/errata/RHSA-2020:0243");
  script_set_attribute(attribute:"see_also", value:"https://access.redhat.com/errata/RHSA-2020:0466");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.mozilla.org/show_bug.cgi?id=1586176");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-379803.pdf");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2020/09/msg00029.html");
  script_set_attribute(attribute:"see_also", value:"https://security.gentoo.org/glsa/202003-02");
  script_set_attribute(attribute:"see_also", value:"https://security.gentoo.org/glsa/202003-10");
  script_set_attribute(attribute:"see_also", value:"https://security.gentoo.org/glsa/202003-37");
  script_set_attribute(attribute:"see_also", value:"https://us-cert.cisa.gov/ics/advisories/icsa-21-040-04");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/4241-1/");
  script_set_attribute(attribute:"see_also", value:"https://usn.ubuntu.com/4335-1/");
  script_set_attribute(attribute:"see_also", value:"https://www.mozilla.org/security/advisories/mfsa2019-36/");
  script_set_attribute(attribute:"see_also", value:"https://www.mozilla.org/security/advisories/mfsa2019-37/");
  script_set_attribute(attribute:"see_also", value:"https://www.mozilla.org/security/advisories/mfsa2019-38/");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has released the following update and recommends it be applied:

RUGGEDCOM ROX (products listed above): Update to v2.14.0 or later version

Siemens has identified the following specific workarounds and mitigations users can apply to reduce the risk:

- Disable IPsec unless the feature is required in the network environment. Note that IPsec is disabled by default.

As a general security measure, Siemens strongly recommends users protect network access to devices with appropriate
mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends users configure the
environment according to Siemensâ€™ operational guidelines for Industrial Security, and follow the recommendations in the
product manuals.

Additional information on industrial security by Siemens can be found at: https://www.siemens.com/industrialsecurity.
For more information see Siemens security advisory SSA-379803");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-11745");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(787);

  script_set_attribute(attribute:"vuln_publication_date", value:"2020/01/08");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/01/08");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/09/14");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rox_mx5000_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rox_rx1400_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rox_rx1500_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rox_rx1501_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rox_rx1510_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rox_rx1511_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rox_rx1512_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rox_rx5000_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:ruggedcom_rox_mx5000_firmware" :
        {"versionEndExcluding" : "2.14.0", "family" : "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rox_rx1400_firmware" :
        {"versionEndExcluding" : "2.14.0", "family" : "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rox_rx1500_firmware" :
        {"versionEndExcluding" : "2.14.0", "family" : "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rox_rx1501_firmware" :
        {"versionEndExcluding" : "2.14.0", "family" : "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rox_rx1510_firmware" :
        {"versionEndExcluding" : "2.14.0", "family" : "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rox_rx1511_firmware" :
        {"versionEndExcluding" : "2.14.0", "family" : "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rox_rx1512_firmware" :
        {"versionEndExcluding" : "2.14.0", "family" : "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rox_rx5000_firmware" :
        {"versionEndExcluding" : "2.14.0", "family" : "RuggedCom"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
