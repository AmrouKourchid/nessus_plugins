#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500302);
  script_version("1.8");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2016-2279");
  script_xref(name:"ICSA", value:"16-061-02");
  script_xref(name:"EDB-ID", value:"44626");

  script_name(english:"Rockwell Automation Allen-Bradley CompactLogix Reflective Cross-Site Scripting (CVE-2016-2279)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Cross-site scripting (XSS) vulnerability in the web server in Rockwell Automation Allen-Bradley CompactLogix 1769-L*
before 28.011+ allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.  

This plugin
only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://ics-cert.us-cert.gov/advisories/ICSA-16-061-02");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1035190");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/44626/");
  # https://www.rockwellautomation.com/en-us/support/advisory.PN885.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4d908bb7");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Rockwell Automation recommends that users of 1769-L23E-QB1B migrate to 1769-L24ER-BB1B and users of 1769-L23E-QBFC1B
migrate to 1769-L24ER-QBFC1B.

For 1756-EN2F Series C, 1756-EN2T Series D, 1756-EN2TR Series C, and 1756-EN3TRSeries B, Rockwell Automation recommends
users apply FRN 10.010 or later available at:

https://compatibility.rockwellautomation.com/Pages/MultiProductDownload.aspx?Keyword=1756-EN3TR&crumb=112

For earlier versions: users using previous series of the affected 1756 EtherNet/IP catalog numbers are urged to assess
their risk and, if necessary, contact their local distributor or sales office in order to upgrade to a newer product
line that contains the relevant mitigations.

For the other affected versions listed above, Rockwell Automation recommends users apply firmware Version 28.011+
available at:

http://compatibility.rockwellautomation.com/Pages/MultiProductDownload.aspx?famID=4

For more detailed information, please see Rockwell Automationâ€™s security notification (KB731098), available at the
following URL with a valid account:

https://rockwellautomation.custhelp.com/app/answers/detail/a_id/731098

Rockwell Automation also recommends the following security practices:

- Do not click on or open URL links from untrusted sources.
- Employ training and awareness programs to educate users on the warning signs of a phishing or social engineering
attack.
- Use trusted software, software patches, antivirus/antimalware programs and interact only with trusted websites and
attachments.
- Employ training and awareness programs to educate users on the warning signs of a phishing or social engineering
attack.
- Minimize network exposure for all control system devices and/or systems, and ensure that they are not accessible from
the Internet
- Locate control system networks and devices behind firewalls, and isolate them from the business network.
- When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may
have vulnerabilities and should be updated to the most current version available. Also recognize that VPN is only as
secure as the connected devices.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:POC/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2016-2279");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(79);

  script_set_attribute(attribute:"vuln_publication_date", value:"2016/03/02");
  script_set_attribute(attribute:"patch_publication_date", value:"2016/03/02");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_controller_1769_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Rockwell");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Rockwell');

var asset = tenable_ot::assets::get(vendor:'Rockwell');

var vuln_cpes = {
    "cpe:/h:rockwellautomation:compactlogix_1769-l23e-qb1b" :
        {"versionEndIncluding" : "20.018", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l23e-qbfc1b" :
        {"versionEndIncluding" : "20.018", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l23e-qbfc1b" :
        {"versionEndIncluding" : "20.018", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l23e-qbfc1b" :
        {"versionEndIncluding" : "20.018", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l23e-qbfc1b" :
        {"versionEndIncluding" : "20.018", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l16er-bb1b" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l18er-bb1b" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l18erm-bb1b" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l24er-qb1b" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l24er-qbfc1b" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l27erm-qbfc1b" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l30er" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l30er-nse" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l30erm" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l33er" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l33erm" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/h:rockwellautomation:compactlogix_1769-l36erm" :
        {"versionEndIncluding" : "27.011", "family" : "CompactLogix"},
    "cpe:/o:rockwellautomation:1756-en2f_series_a_firmware" :
        {"family" : "ControlLogix"},
    "cpe:/o:rockwellautomation:1756-en2f_series_b_firmware" :
        {"family" : "ControlLogix"},
    "cpe:/o:rockwellautomation:1756-en2t_series_a_firmware":
        {"family" : "ControlLogix"},
    "cpe:/o:rockwellautomation:1756-en2t_series_b_firmware":
        {"family" : "ControlLogix"},
    "cpe:/o:rockwellautomation:1756-en2t_series_c_firmware":
        {"family" : "ControlLogix"},
    "cpe:/o:rockwellautomation:1756-en2t_series_d_firmware":
        {"versionEndIncluding" : "10.007", "family" : "ControlLogix"},
    "cpe:/o:rockwellautomation:1756-en2tr_series_a_firmware":
        {"family" : "ControlLogix"},
    "cpe:/o:rockwellautomation:1756-en2tr_series_b_firmware":
        {"family" : "ControlLogix"},
    "cpe:/o:rockwellautomation:1756-en3tr_series_a_firmware":
        {"family" : "ControlLogix"}
    };

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
