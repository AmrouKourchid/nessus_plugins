#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500340);
  script_version("1.10");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/11/27");

  script_cve_id("CVE-2018-0651");
  script_xref(name:"ICSA", value:"18-233-01");

  script_name(english:"Yokogawa iDefine, STARDOM, ASTPLANNER, and TriFellows Stack-Based Buffer Overflow (CVE-2018-0651)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Buffer overflow in the license management function of YOKOGAWA
products (iDefine for ProSafe-RS R1.16.3 and earlier, STARDOM VDS
R7.50 and earlier, STARDOM FCN/FCJ Simulator R4.20 and earlier,
ASTPLANNER R15.01 and earlier, TriFellows V5.04 and earlier) allows
remote attackers to stop the license management function or execute an
arbitrary program via unspecified vectors.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://web-material3.yokogawa.com/YSAR-18-0006-E.pdf");
  script_set_attribute(attribute:"see_also", value:"https://jvn.jp/vu/JVNVU93845358/");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/105124");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-18-233-01");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Yokogawa recommends users to update to the latest versions or apply the patch:ASTPLANNER: Update to R15.02.01 or contact
support for the patch,

- iDefine for ProSafe-RS: Update to R1.16.4,
- STARDOM: Update to VDS R8.10 or contact support for the patch, and
- TriFellows: Update to Version 5.10 or contact support for the patch.
- Support:
- iDefine for ProSafe-RS and STARDOM users: https://contact.yokogawa.com/cs/gw?c-id=000498
- ASTPLANNER and TriFellows users: https://contact.yokogawa.com/cs/gw?c-id=000497

When Yokogawa service personnel perform system upgrade or install patches, those charges are borne by the user. Please
contact support in the following section for the countermeasures regarding the affected products. Yokogawa strongly
suggests all users to introduce appropriate security measures not only for the vulnerability identified, but also to the
overall systems.

Refer to Yokogawaâ€™s security notification YSAR-18-0006 for more information, which can be located here:

https://www.yokogawa.com/library/resources/white-papers/yokogawa-security-advisory-report-list/");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-0651");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(119);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/01/09");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/01/09");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:idefine_for_prosafe-rs_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Yokogawa");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Yokogawa');

var asset = tenable_ot::assets::get(vendor:'Yokogawa');

var vuln_cpes = {
    "cpe:/o:yokogawa:idefine_for_prosafe-rs_firmware" :
        {"versionEndIncluding" : "r1.16.3", "family" : "ProSafe"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
