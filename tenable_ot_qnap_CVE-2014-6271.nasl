#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502519);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/10/17");

  script_cve_id("CVE-2014-6271");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2022/07/28");
  script_xref(name:"CEA-ID", value:"CEA-2019-0240");

  script_name(english:"Qnap QTS Bash OS Command Injection (CVE-2014-6271)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"GNU Bash through 4.3 processes trailing strings after function
definitions in the values of environment variables, which allows
remote attackers to execute arbitrary code via a crafted environment,
as demonstrated by vectors involving the ForceCommand feature in
OpenSSH sshd, the mod_cgi and mod_cgid modules in the Apache HTTP
Server, scripts executed by unspecified DHCP clients, and other
situations in which setting the environment occurs across a privilege
boundary from Bash execution, aka ShellShock. NOTE: the original fix
for this issue was incorrect; CVE-2014-7169 has been assigned to cover
the vulnerability that is still present after the incorrect fix.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://advisories.mageia.org/MGASA-2014-0388.html");
  script_set_attribute(attribute:"see_also", value:"http://jvn.jp/en/jp/JVN55667175/index.html");
  script_set_attribute(attribute:"see_also", value:"http://jvndb.jvn.jp/jvndb/JVNDB-2014-000126");
  script_set_attribute(attribute:"see_also", value:"http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10673");
  # http://lcamtuf.blogspot.com/2014/09/quick-notes-about-bash-bug-its-impact.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?8fb56c28");
  script_set_attribute(attribute:"see_also", value:"http://linux.oracle.com/errata/ELSA-2014-1293.html");
  script_set_attribute(attribute:"see_also", value:"http://linux.oracle.com/errata/ELSA-2014-1294.html");
  # http://lists.opensuse.org/opensuse-security-announce/2014-09/msg00028.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?208f76da");
  # http://lists.opensuse.org/opensuse-security-announce/2014-09/msg00029.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?5eb364d9");
  # http://lists.opensuse.org/opensuse-security-announce/2014-09/msg00034.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?80d302d0");
  # http://lists.opensuse.org/opensuse-security-announce/2014-09/msg00037.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c9f5484b");
  # http://lists.opensuse.org/opensuse-security-announce/2014-09/msg00040.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?41bcbd36");
  # http://lists.opensuse.org/opensuse-security-announce/2014-09/msg00044.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c44def15");
  # http://lists.opensuse.org/opensuse-security-announce/2014-09/msg00049.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?696716b7");
  # http://lists.opensuse.org/opensuse-security-announce/2014-10/msg00004.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?31bc99d9");
  script_set_attribute(attribute:"see_also", value:"http://lists.opensuse.org/opensuse-updates/2014-10/msg00023.html");
  script_set_attribute(attribute:"see_also", value:"http://lists.opensuse.org/opensuse-updates/2014-10/msg00025.html");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141216207813411&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141216668515282&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141235957116749&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141319209015420&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141330425327438&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141330468527613&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141345648114150&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141383026420882&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141383081521087&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141383138121313&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141383196021590&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141383244821813&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141383304022067&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141383353622268&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141383465822787&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141450491804793&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141576728022234&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141577137423233&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141577241923505&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141577297623641&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141585637922673&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141694386919794&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141879528318582&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142113462216480&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142118135300698&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142358026505815&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142358078406056&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142546741516006&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142719845423222&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142721162228379&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142805027510172&w=2");
  # http://packetstormsecurity.com/files/128517/VMware-Security-Advisory-2014-0010.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b131099d");
  # http://packetstormsecurity.com/files/128567/CA-Technologies-GNU-Bash-Shellshock.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?be27da2c");
  # http://packetstormsecurity.com/files/128573/Apache-mod_cgi-Remote-Command-Execution.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1e5c2824");
  # http://packetstormsecurity.com/files/137376/IPFire-Bash-Environment-Variable-Injection-Shellshock.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?3db80bf5");
  # http://packetstormsecurity.com/files/161107/SonicWall-SSL-VPN-Shellshock-Remote-Code-Execution.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?63308d81");
  script_set_attribute(attribute:"see_also", value:"http://rhn.redhat.com/errata/RHSA-2014-1293.html");
  script_set_attribute(attribute:"see_also", value:"http://rhn.redhat.com/errata/RHSA-2014-1294.html");
  script_set_attribute(attribute:"see_also", value:"http://rhn.redhat.com/errata/RHSA-2014-1295.html");
  script_set_attribute(attribute:"see_also", value:"http://rhn.redhat.com/errata/RHSA-2014-1354.html");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2014/Oct/0");
  script_set_attribute(attribute:"see_also", value:"http://support.apple.com/kb/HT6495");
  script_set_attribute(attribute:"see_also", value:"http://support.novell.com/security/cve/CVE-2014-6271.html");
  # http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140926-bash
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?7269978d");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=isg3T1021272");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=isg3T1021279");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=isg3T1021361");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=ssg1S1004879");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=ssg1S1004897");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=ssg1S1004898");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=ssg1S1004915");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21685541");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21685604");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21685733");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21685749");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21686084");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21686131");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21686246");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21686445");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21686447");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21686494");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21687079");
  script_set_attribute(attribute:"see_also", value:"http://www.debian.org/security/2014/dsa-3032");
  script_set_attribute(attribute:"see_also", value:"http://www.kb.cert.org/vuls/id/252743");
  script_set_attribute(attribute:"see_also", value:"http://www.novell.com/support/kb/doc.php?id=7015701");
  script_set_attribute(attribute:"see_also", value:"http://www.novell.com/support/kb/doc.php?id=7015721");
  # http://www.oracle.com/technetwork/topics/security/bashcve-2014-7169-2317675.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c77a4ecd");
  script_set_attribute(attribute:"see_also", value:"http://www.qnap.com/i/en/support/con_show.php?cid=61");
  script_set_attribute(attribute:"see_also", value:"http://www.ubuntu.com/usn/USN-2362-1");
  script_set_attribute(attribute:"see_also", value:"http://www.us-cert.gov/ncas/alerts/TA14-268A");
  script_set_attribute(attribute:"see_also", value:"http://www.vmware.com/security/advisories/VMSA-2014-0010.html");
  script_set_attribute(attribute:"see_also", value:"https://access.redhat.com/articles/1200223");
  script_set_attribute(attribute:"see_also", value:"https://access.redhat.com/node/1200223");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.redhat.com/show_bug.cgi?id=1141597");
  script_set_attribute(attribute:"see_also", value:"https://kb.juniper.net/InfoCenter/index?page=content&id=JSA10648");
  # https://securityblog.redhat.com/2014/09/24/bash-specially-crafted-environment-variables-code-injection-attack/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?dacf7829");
  script_set_attribute(attribute:"see_also", value:"https://support.apple.com/kb/HT6535");
  script_set_attribute(attribute:"see_also", value:"https://support.citrix.com/article/CTX200217");
  script_set_attribute(attribute:"see_also", value:"https://support.citrix.com/article/CTX200223");
  # https://support.f5.com/kb/en-us/solutions/public/15000/600/sol15629.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d12f5d80");
  # https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-c04497075
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?90e62047");
  # https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk102673&src=securityAlerts
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?eced9ee4");
  # https://www.arista.com/en/support/advisories-notices/security-advisories/1008-security-advisory-0006
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?343a7d69");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/34879/");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/37816/");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/38849/");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/39918/");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/40619/");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/40938/");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/42938/");
  script_set_attribute(attribute:"see_also", value:"https://www.suse.com/support/shellshock/");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:H/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:H/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2014-6271");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_set_attribute(attribute:"exploit_framework_core", value:"true");
  script_set_attribute(attribute:"exploited_by_malware", value:"true");
  script_set_attribute(attribute:"metasploit_name", value:'Qmail SMTP Bash Environment Variable Injection (Shellshock)');
  script_set_attribute(attribute:"exploit_framework_metasploit", value:"true");
  script_cwe_id(78);

  script_set_attribute(attribute:"vuln_publication_date", value:"2014/09/24");
  script_set_attribute(attribute:"patch_publication_date", value:"2014/09/24");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/10/16");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:qnap:qts");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Qnap");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Qnap');

var asset = tenable_ot::assets::get(vendor:'Qnap');

var vuln_cpes = {
    "cpe:/o:qnap:qts" :
        {"versionEndExcluding" : "4.1.1", "family" : "QTS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
