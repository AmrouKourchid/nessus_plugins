#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502859);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/19");

  script_cve_id("CVE-2024-12142");
  script_xref(name:"ICSA", value:"25-035-06");

  script_name(english:"Schneider Electric Modicon M340 and BMXNOE0100/0110, BMXNOR0200H Exposure of Sensitive Information to an Unauthorized Actor (CVE-2024-12142)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor vulnerability exists that could 
cause information disclosure of restricted web page, modification of web page and denial of 
service when specific web pages are modified and restricted functions are invoked.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://download.schneider-electric.com/files?p_Doc_Ref=SEVD-2025-014-05&p_enDocType=Security+and+Safety+Notice&p_File_Name=SEVD-2025-014-05.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?7a6e28ad");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-25-035-06");
  script_set_attribute(attribute:"solution", value:
"BMXNOR0200H: 
Version SV1.70IR26 of BMXNOR0200H includes a fix for this vulnerability and is 
available for download here: https://www.se.com/ww/en/download/document/BMXNOR0200H_FW/

Modicon M340 processors, BMXNOE0100/0110: 
Schneider Electric is establishing a remediation plan for all future versions 
of Modicon M340 processors BMXP34*, BMXNOE0100 and 
BMXNOE0110 that will include a fix for this vulnerability. We will update 
this document when the remediation is available. Until then, customers 
should immediately apply the following mitigations to reduce the risk of 
exploit:
- Set up network segmentation and implement a firewall to block all 
unauthorized access to FTP port 21/TCP on the devices. 
- Disable FTP service via EcoStruxureTM Control Expert. This is 
disabled by default when a new application is created.
- Disable Web server service via EcoStruxureTM Control Expert. This 
is disabled by default when a new application is created. 
- Configure the Access Control List following the recommendation on 
the 'Modicon Controllers System Cybersecurity'.
 
For more information, see Schneider Electricâ€™s security advisory SEVD-2023-010-05.");
  script_set_cvss3_base_vector("CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss4_vector", value:"CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:H/SC:N/SI:N/SA:N");
  script_set_attribute(attribute:"cvss4_threat_vector", value:"CVSS:4.0/E:U");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-12142");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(200);

  script_set_attribute(attribute:"vuln_publication_date", value:"2025/01/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2025/01/14");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/02/18");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:modicon_m340_series_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:bmxnoe0100_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:bmxnoe0110_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:bmxnor0200h_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Schneider");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Schneider');

var asset = tenable_ot::assets::get(vendor:'Schneider');

var vuln_cpes = {
    "cpe:/o:schneider-electric:modicon_m340_series_firmware" :
        {"family" : "ModiconM340"},
    "cpe:/o:schneider-electric:bmxnoe0100_firmware" :
        {"family" : "ModiconM340M580CP"},
    "cpe:/o:schneider-electric:bmxnoe0110_firmware" :
        {"family" : "ModiconM340M580CP"},
    "cpe:/o:schneider-electric:bmxnor0200h_firmware" :
        {"versionEndExcluding" : "sv1.70ir26", "family" : "ModiconM340M580CP"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
