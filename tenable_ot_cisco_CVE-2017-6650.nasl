#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501254);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2017-6650");

  script_name(english:"Cisco Nexus Series Switches Telnet CLI Command Injection (CVE-2017-6650)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Telnet CLI command of Cisco NX-OS System
Software 7.1 through 7.3 running on Cisco Nexus Series Switches could
allow an authenticated, local attacker to perform a command injection
attack. The vulnerability is due to insufficient input validation of
command arguments. An attacker could exploit this vulnerability by
injecting crafted command arguments into the Telnet CLI command. An
exploit could allow the attacker to read or write arbitrary files at
the user's privilege level outside of the user's path. Cisco Bug IDs:
CSCvb86771.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/98528");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1038518");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170517-nss1
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?682858d2");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-6650");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(20, 77);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/05/22");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/05/22");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%281%29n1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%282%29n1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%283%29n1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%283%29n1%282%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%283%29n1%282.1%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%283%29n1%283.12%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%284%29n1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.2%280%29d1%280.437%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.2%280%29n1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.2%280%29zz%2899.1%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.2%281%29n1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.3%280%29n1%281%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:7.1%281%29n1%281%29" :
        {"versionEndIncluding" : "7.1%281%29n1%281%29", "versionStartIncluding" : "7.1%281%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%282%29n1%281%29" :
        {"versionEndIncluding" : "7.1%282%29n1%281%29", "versionStartIncluding" : "7.1%282%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%283%29n1%281%29" :
        {"versionEndIncluding" : "7.1%283%29n1%281%29", "versionStartIncluding" : "7.1%283%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%283%29n1%282%29" :
        {"versionEndIncluding" : "7.1%283%29n1%282%29", "versionStartIncluding" : "7.1%283%29n1%282%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%283%29n1%282.1%29" :
        {"versionEndIncluding" : "7.1%283%29n1%282.1%29", "versionStartIncluding" : "7.1%283%29n1%282.1%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%283%29n1%283.12%29" :
        {"versionEndIncluding" : "7.1%283%29n1%283.12%29", "versionStartIncluding" : "7.1%283%29n1%283.12%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%284%29n1%281%29" :
        {"versionEndIncluding" : "7.1%284%29n1%281%29", "versionStartIncluding" : "7.1%284%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.2%280%29d1%280.437%29" :
        {"versionEndIncluding" : "7.2%280%29d1%280.437%29", "versionStartIncluding" : "7.2%280%29d1%280.437%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.2%280%29n1%281%29" :
        {"versionEndIncluding" : "7.2%280%29n1%281%29", "versionStartIncluding" : "7.2%280%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.2%280%29zz%2899.1%29" :
        {"versionEndIncluding" : "7.2%280%29zz%2899.1%29", "versionStartIncluding" : "7.2%280%29zz%2899.1%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.2%281%29n1%281%29" :
        {"versionEndIncluding" : "7.2%281%29n1%281%29", "versionStartIncluding" : "7.2%281%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%280%29n1%281%29" :
        {"versionEndIncluding" : "7.3%280%29n1%281%29", "versionStartIncluding" : "7.3%280%29n1%281%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
