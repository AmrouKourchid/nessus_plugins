#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502654);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/12");

  script_cve_id("CVE-2024-8626");
  script_xref(name:"ICSA", value:"24-284-18");

  script_name(english:"Rockwell Automation Logix Controllers Uncontrolled Resource Consumption (CVE-2024-8626)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Due to a memory leak, a denial-of-service vulnerability exists in the
affected products. A malicious actor could exploit this vulnerability
by performing multiple actions on certain webpages of the product
causing the affected products to become fully unavailable and require
a power cycle to recover.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.SD1706.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?43fc79e9");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-24-284-18");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Rockwell Automation offers users the following solutions:

- CompactLogix 5380: Update to v33.015 and later for versions 33. Update to v34.011 and later
- Compact GuardLogix 5380: Update to v33.015 and later for versions 33. Update to v34.011 and later
- CompactLogix 5480: Update to v33.015 and later for versions 33. Update to v34.011 and later
- ControlLogix 5580: Update to v33.015 and later for versions 33. Update to v34.011 and later
- GuardLogix 5580: Update to v33.015 and later for versions 33. Update to v34.011 and later
- 1756-EN4TR: Update to version 4.001 and later

Users of the affected software who are not able to upgrade to one of the corrected versions are encouraged to apply
security best practices, where possible.

- Security Best Practices

For more information about this issue, please see the advisory on the Rockwell Automation security page.");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-8626");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/10/07");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/10/10");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/10/23");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_5380_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compact_guardlogix_5380_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_5480_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:controllogix_5580_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:guardlogix_5580_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:1756-en4tr_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Rockwell");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Rockwell');

var asset = tenable_ot::assets::get(vendor:'Rockwell');

var vuln_cpes = {
  "cpe:/o:rockwellautomation:compactlogix_5380_firmware" :
    {"versionEndExcluding" : "33.015", "versionStartIncluding": "33.011", "family" : "CompactLogix5380"},
  "cpe:/o:rockwellautomation:compactlogix_5380_firmware:34" :
    {"versionEndExcluding" : "34.011", "versionStartIncluding": "34.000", "family" : "CompactLogix5380"},
  "cpe:/o:rockwellautomation:compact_guardlogix_5380_firmware" :
    {"versionEndExcluding" : "33.015", "versionStartIncluding": "33.011", "family" : "GuardLogix5380"},
  "cpe:/o:rockwellautomation:compact_guardlogix_5380_firmware:34" :
    {"versionEndExcluding" : "34.011", "versionStartIncluding": "34.000", "family" : "GuardLogix5380"},
  "cpe:/o:rockwellautomation:compactlogix_5480_firmware" :
    {"versionEndExcluding" : "33.015", "versionStartIncluding": "33.011", "family" : "CompactLogix5480"},
  "cpe:/o:rockwellautomation:compactlogix_5480_firmware:34" :
    {"versionEndExcluding" : "34.011", "versionStartIncluding": "34.000", "family" : "CompactLogix5480"},
  "cpe:/o:rockwellautomation:controllogix_5580_firmware" :
    {"versionEndExcluding" : "33.015", "versionStartIncluding": "33.011", "family" : "ControlLogix5580"},
  "cpe:/o:rockwellautomation:controllogix_5580_firmware:34" :
    {"versionEndExcluding" : "34.011", "versionStartIncluding": "34.000", "family" : "ControlLogix5580"},
  "cpe:/o:rockwellautomation:guardlogix_5580_firmware" :
    {"versionEndExcluding" : "33.015", "versionStartIncluding": "33.011", "family" : "GuardLogix5580"},
  "cpe:/o:rockwellautomation:guardlogix_5580_firmware:34" :
    {"versionEndExcluding" : "34.011", "versionStartIncluding": "34.000", "family" : "GuardLogix5580"},
  "cpe:/o:rockwellautomation:1756-en4tr_firmware" :
    {"versionEndExcluding" : "4.001", "versionStartIncluding": "3.002", "family" : "ControlLogix"}
    
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
