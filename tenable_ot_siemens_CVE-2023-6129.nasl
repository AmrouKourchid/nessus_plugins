#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502877);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/25");

  script_cve_id("CVE-2023-6129");
  script_xref(name:"ICSA", value:"25-044-09");

  script_name(english:"Siemens SCALANCE W700 Out-of-bounds Write (CVE-2023-6129)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Issue summary: The POLY1305 MAC (message authentication code)
implementation  contains a bug that might corrupt the internal state
of applications running  on PowerPC CPU based platforms if the CPU
provides vector instructions.    Impact summary: If an attacker can
influence whether the POLY1305 MAC  algorithm is used, the application
state might be corrupted with various  application dependent
consequences.    The POLY1305 MAC (message authentication code)
implementation in OpenSSL for  PowerPC CPUs restores the contents of
vector registers in a different order  than they are saved. Thus the
contents of some of these vector registers  are corrupted when
returning to the caller. The vulnerable code is used only  on newer
PowerPC processors supporting the PowerISA 2.07 instructions.    The
consequences of this kind of internal application state corruption can
be various - from no consequences, if the calling application does not
depend on the contents of non-volatile XMM registers at all, to the
worst  consequences, where the attacker could get complete control of
the application  process. However unless the compiler uses the vector
registers for storing  pointers, the most likely consequence, if any,
would be an incorrect result  of some application dependent
calculations or a crash leading to a denial of  service.    The
POLY1305 MAC algorithm is most frequently used as part of the
CHACHA20-POLY1305 AEAD (authenticated encryption with associated data)
algorithm. The most common usage of this AEAD cipher is with TLS
protocol  versions 1.2 and 1.3. If this cipher is enabled on the
server a malicious  client can influence whether this AEAD cipher is
used. This implies that  TLS server applications using OpenSSL can be
potentially impacted. However  we are currently not aware of any
concrete application that would be affected  by this issue therefore
we consider this a Low severity security issue.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/html/ssa-915275.html");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/html/ssa-331112.html");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/html/ssa-769027.html");
  script_set_attribute(attribute:"see_also", value:"https://support.industry.siemens.com/cs/ww/en/view/109975745/");
  script_set_attribute(attribute:"see_also", value:"https://support.industry.siemens.com/cs/ww/en/view/109977720/");
  script_set_attribute(attribute:"see_also", value:"https://support.industry.siemens.com/cs/ww/en/view/109974917/");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-25-044-09");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:H/Au:N/C:N/I:P/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-6129");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(787);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/11/12");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/11/12");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/02/24");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wab762-1_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam763-1_%28me%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam763-1_%28us%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam763-1_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam766-1_%28me%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam766-1_%28us%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam766-1_eec_%28me%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam766-1_eec_%28us%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam766-1_eec_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wam766-1_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wub762-1_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wub762-1_ifeatures_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wum763-1_%28us%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wum763-1_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wum766-1_%28me%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wum766-1_%28usa%29_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wum766-1_firmware:3.0.0");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:scalance_wab762-1_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5762-1AJ00-6AA0']},
    "cpe:/o:siemens:scalance_wam763-1_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5763-1AL00-7DA0']},
    "cpe:/o:siemens:scalance_wam763-1_%28me%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5763-1AL00-7DC0']},
    "cpe:/o:siemens:scalance_wam763-1_%28us%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5763-1AL00-7DB0']},
    "cpe:/o:siemens:scalance_wam766-1_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-7DA0']},
    "cpe:/o:siemens:scalance_wam766-1_%28me%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-7DC0']},
    "cpe:/o:siemens:scalance_wam766-1_%28us%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-7DB0']},
    "cpe:/o:siemens:scalance_wam766-1_eec_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-7TA0']},
    "cpe:/o:siemens:scalance_wam766-1_eec_%28me%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-7TC0']},
    "cpe:/o:siemens:scalance_wam766-1_eec_%28us%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-7TB0']},
    "cpe:/o:siemens:scalance_wub762-1_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5762-1AJ00-1AA0']},
    "cpe:/o:siemens:scalance_wub762-1_ifeatures_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5762-1AJ00-2AA0']},
    "cpe:/o:siemens:scalance_wum763-1_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5763-1AL00-3AA0', '6GK5763-1AL00-3DA0']},
    "cpe:/o:siemens:scalance_wum763-1_%28us%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5763-1AL00-3DB0', '6GK5763-1AL00-3AB0']},
    "cpe:/o:siemens:scalance_wum766-1_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-3DA0']},
    "cpe:/o:siemens:scalance_wum766-1_%28me%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-3DC0']},
    "cpe:/o:siemens:scalance_wum766-1_%28usa%29_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5766-1GE00-3DB0']}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
