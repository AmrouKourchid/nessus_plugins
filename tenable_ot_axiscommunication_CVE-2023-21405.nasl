#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501933);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/06/18");

  script_cve_id("CVE-2023-21405");

  script_name(english:"Axis Communication Network Door Controllers and Intercoms Denial of Service (CVE-2023-21405)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Knud from Fraktal.fi has found a flaw in some Axis Network Door
Controllers and Axis Network Intercoms when communicating over OSDP,
highlighting that the OSDP message parser crashes the pacsiod process,
causing a temporary unavailability of the door-controlling
functionalities meaning that doors cannot be opened or closed. No
sensitive or customer data can be extracted as the Axis device is not
further compromised. Please refer to the Axis security advisory for
more information, mitigation and affected products and software
versions.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.axis.com/dam/public/7f/3a/ed/cve-2023-21405-en-US-407244.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a6fef355");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-21405");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/07/25");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/07/25");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/01/23");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a1001_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a1210_%28-b%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a1601_firmware:1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a1601_firmware:10");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a1601_firmware:11");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a1610_%28-b%29_firmware:10");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a1610_%28-b%29_firmware:11");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a8207");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:a8207_mkii");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/AxisCommunication");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/AxisCommunication');

var asset = tenable_ot::assets::get(vendor:'AxisCommunication');

var vuln_cpes = {
    "cpe:/o:axis:a1001_firmware" :
        {"versionEndIncluding" : "1.65.4", "family" : "AxisCommunication"},
    "cpe:/o:axis:a1210_%28-b%29_firmware" :
        {"versionEndIncluding" : "11.6.16.0", "versionStartIncluding" : "11.0", "family" : "AxisCommunication"},
    "cpe:/o:axis:a1601_firmware:1" :
        {"versionEndIncluding" : "1.84.4", "family" : "AxisCommunication"},
    "cpe:/o:axis:a1601_firmware:10" :
        {"versionEndIncluding" : "10.12.171.0", "versionStartIncluding" : "10.0", "family" : "AxisCommunication"},
    "cpe:/o:axis:a1601_firmware:11" :
        {"versionEndIncluding" : "11.6.16.0", "versionStartIncluding" : "11.0", "family" : "AxisCommunication"},
    "cpe:/o:axis:a1610_%28-b%29_firmware:10" :
        {"versionEndIncluding" : "10.12.171.0", "versionStartIncluding" : "10.0", "family" : "AxisCommunication"},
    "cpe:/o:axis:a1610_%28-b%29_firmware:11" :
        {"versionEndIncluding" : "11.6.16.0", "versionStartIncluding" : "11.0", "family" : "AxisCommunication"},
    "cpe:/o:axis:a8207" :
        {"versionEndIncluding" : "10.12.178.0", "versionStartIncluding" : "10.0", "family" : "AxisCommunication"},
    "cpe:/o:axis:a8207_mkii" :
        {"versionEndIncluding" : "11.5.53", "versionStartIncluding" : "11.0", "family" : "AxisCommunication"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
