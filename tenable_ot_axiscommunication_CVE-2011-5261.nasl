#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501942);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/02/15");

  script_cve_id("CVE-2011-5261");
  script_xref(name:"OSVDB", value:"77395");
  script_xref(name:"SECUNIA", value:"47037");

  script_name(english:"Axis Communication M10 Series Network Cameras Cross-site Scripting (CVE-2011-5261)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Cross-site scripting (XSS) vulnerability in serverreport.cgi in Axis
M10 Series Network Cameras M1054 firmware 5.21 and earlier allows
remote attackers to inject arbitrary web script or HTML via the
pageTitle parameter to admin/showReport.shtml.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # http://metzgersecurity.blogspot.com/2011/11/xss-vulnerability-axis-m10-series.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d848dfef");
  script_set_attribute(attribute:"see_also", value:"http://osvdb.org/77395");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/47037");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/50968");
  script_set_attribute(attribute:"see_also", value:"https://exchange.xforce.ibmcloud.com/vulnerabilities/71687");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:POC/RL:OF/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2011-5261");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(79);

  script_set_attribute(attribute:"vuln_publication_date", value:"2013/02/12");
  script_set_attribute(attribute:"patch_publication_date", value:"2013/02/12");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/01/23");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:axis:m1054_network_camera:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:m10_series_network_cameras_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/AxisCommunication");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/AxisCommunication');

var asset = tenable_ot::assets::get(vendor:'AxisCommunication');

var vuln_cpes = {
    "cpe:/h:axis:m10_series_network_camera" :
        {"versionEndIncluding" : "5.21", "family" : "AxisCommunication"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
