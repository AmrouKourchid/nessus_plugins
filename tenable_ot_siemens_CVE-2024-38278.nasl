#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502356);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2024-38278");
  script_xref(name:"ICSA", value:"24-193-06");

  script_name(english:"Siemens RUGGEDCOM Incorrect Privilege Assignment (CVE-2024-38278)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The affected products with IP forwarding enabled wrongly make
available certain remote services in non-managed VLANs, even if these
services are not intentionally activated. An attacker could leverage
this vulnerability to create a remote shell to the affected system.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://cert-portal.siemens.com/productcert/html/ssa-170375.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?41658bf9");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-24-193-06");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has prepared fixed versions and recommends countermeasures for products where fixes are not available.

RUGGEDCOM RMC8388 V5.X, RUGGEDCOM RS416Pv2 V5.X, RUGGEDCOM RS416v2 V5.X, RUGGEDCOM RS900 (32M) V5.X,
RUGGEDCOM RS900G (32M) V5.X, RUGGEDCOM RSG2100 (32M) V5.X, RUGGEDCOM RSG2288 V5.X, RUGGEDCOM RSG2300 V5.X,
RUGGEDCOM RSG2300P V5.X, RUGGEDCOM RSG2488 V5.X, RUGGEDCOM RSG907R, RUGGEDCOM RSG908C, RUGGEDCOM RSG909R,
RUGGEDCOM RSG910C, RUGGEDCOM RSG920P V5.X, RUGGEDCOM RSL910, RUGGEDCOM RST2228, RUGGEDCOM RST2228P, RUGGEDCOM RST916C,
RUGGEDCOM RST916P, RUGGEDCOM RMC8388NC V5.X, RUGGEDCOM RS416NCv2 V5.X, RUGGEDCOM RS416PNCv2 V5.X,
RUGGEDCOM RS900GNC(32M) V5.X, RUGGEDCOM RS900NC(32M) V5.X, RUGGEDCOM RSG2100NC(32M) V5.X, RUGGEDCOM RSG2288NC V5.X,
RUGGEDCOM RSG2300NC V5.X, RUGGEDCOM RSG2300PNC V5.X, RUGGEDCOM RSG2488NC V5.X, RUGGEDCOM RSG920PNC V5.X,
RUGGEDCOM RSL910NC: Update to V5.9.0 or later version

Siemens has identified the following specific workarounds and mitigations users can apply to reduce risk:

RUGGEDCOM RMC8388 V5.X, RUGGEDCOM RMC8388NC V5.X, RUGGEDCOM RS416NCv2 V5.X, RUGGEDCOM RS416PNCv2 V5.X,
RUGGEDCOM RS416Pv2 V5.X, RUGGEDCOM RS416v2 V5.X, RUGGEDCOM RS900 (32M) V5.X, RUGGEDCOM RS900G (32M) V5.X,
RUGGEDCOM RS900GNC(32M) V5.X, RUGGEDCOM RS900NC(32M) V5.X, RUGGEDCOM RSG2100 (32M) V5.X, RUGGEDCOM RSG2100NC(32M) V5.X,
RUGGEDCOM RSG2288 V5.X, RUGGEDCOM RSG2288NC V5.X, RUGGEDCOM RSG2300 V5.X, RUGGEDCOM RSG2300NC V5.X,
RUGGEDCOM RSG2300P V5.X, RUGGEDCOM RSG2300PNC V5.X, RUGGEDCOM RSG2488 V5.X, RUGGEDCOM RSG2488NC V5.X,
RUGGEDCOM RSG907R, RUGGEDCOM RSG908C, RUGGEDCOM RSG909R, RUGGEDCOM RSG910C, RUGGEDCOM RSG920P V5.X,
RUGGEDCOM RSG920PNC V5.X, RUGGEDCOM RSL910, RUGGEDCOM RSL910NC, RUGGEDCOM RST2228, RUGGEDCOM RST2228P,
RUGGEDCOM RST916C, RUGGEDCOM RST916P: For CVE-2024-38278: Disable the IP Forwarding if not required on the affected
system. Also note, the IP forwarding is disabled by default

As a general security measure, Siemens recommends protecting network access to devices with appropriate mechanisms.
To operate the devices in a protected IT environment, Siemens recommends configuring the environment according to
Siemens' operational guidelines for industrial security and following recommendations in the product manuals.

Additional information on industrial security by Siemens can be found on the Siemens industrial security webpage.

For more information see the associated Siemens security advisory SSA-17037.");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-38278");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(266);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/07/09");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/07/09");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/08/08");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rmc8388_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rmc8388nc_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416ncv2_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416pncv2_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416pv2_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs416v2_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs900_%2832m%29_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs900g_%2832m%29_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs900gnc_%2832m%29_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rs900nc_%2832m%29_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg907r_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg908c_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg909r_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg910c_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg920p_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg920pnc_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2100_%2832m%29_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2100nc_%2832m%29_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2288_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2288nc_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2300_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2300nc_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2300p_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2300pnc_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2488_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsg2488nc_firmware:v5.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsl910_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rsl910nc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rst916c_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rst916p_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rst2228_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rst2228p_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:ruggedcom_rmc8388_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rmc8388nc_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416ncv2_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416pncv2_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416pv2_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs416v2_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs900_%2832m%29_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs900g_%2832m%29_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs900gnc_%2832m%29_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rs900nc_%2832m%29_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg907r_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg908c_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg909r_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg910c_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg920p_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg920pnc_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2100_%2832m%29_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2100nc_%2832m%29_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2288_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2288nc_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2300_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2300nc_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2300p_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2300pnc_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2488_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsg2488nc_firmware:v5.x":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsl910_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rsl910nc_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rst916c_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rst916p_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rst2228_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"},
    "cpe:/o:siemens:ruggedcom_rst2228p_firmware":
        {"versionEndExcluding": "v5.9.0", "versionStartIncluding": "v5.0.0", "family": "RuggedCom"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
