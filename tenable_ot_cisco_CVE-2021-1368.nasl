#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501235);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2021-1368");

  script_name(english:"Cisco FXOS and NX-OS Software Unidirectional Link Detection Denial of Service and Arbitrary Code Execution (CVE-2021-1368)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Unidirectional Link Detection (UDLD) feature of
Cisco FXOS Software and Cisco NX-OS Software could allow an
unauthenticated, adjacent attacker to execute arbitrary code with
administrative privileges or cause a denial of service (DoS) condition
on an affected device. This vulnerability is due to insufficient input
validation. An attacker could exploit this vulnerability by sending
crafted Cisco UDLD protocol packets to a directly connected, affected
device. A successful exploit could allow the attacker to execute
arbitrary code with administrative privileges or cause the Cisco UDLD
process to crash and restart multiple times, causing the affected
device to reload and resulting in a DoS condition. Note: The UDLD
feature is disabled by default, and the conditions to exploit this
vulnerability are strict. The attacker needs full control of a
directly connected device. That device must be connected over a port
channel that has UDLD enabled. To trigger arbitrary code execution,
both the UDLD-enabled port channel and specific system conditions must
exist. In the absence of either the UDLD-enabled port channel or the
system conditions, attempts to exploit this vulnerability will result
in a DoS condition. It is possible, but highly unlikely, that an
attacker could control the necessary conditions for exploitation. The
CVSS score reflects this possibility. However, given the complexity of
exploitation, Cisco has assigned a Medium Security Impact Rating (SIR)
to this vulnerability.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-udld-rce-xetH6w35
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1b37d5dc");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:M/Au:S/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-1368");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(787);

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/02/24");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/02/24");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i5%282%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i7%289%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.3%288%29n1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.3%289%29n1%280.823%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.4%283.108%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.4%283.117%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:9.3%285%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:8.4%283.108%29" :
        {"versionEndIncluding" : "8.4%283.108%29", "versionStartIncluding" : "8.4%283.108%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.4%283.117%29" :
        {"versionEndIncluding" : "8.4%283.117%29", "versionStartIncluding" : "8.4%283.117%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i5%282%29" :
        {"versionEndIncluding" : "7.0%283%29i5%282%29", "versionStartIncluding" : "7.0%283%29i5%282%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7%289%29" :
        {"versionEndIncluding" : "7.0%283%29i7%289%29", "versionStartIncluding" : "7.0%283%29i7%289%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:9.3%285%29" :
        {"versionEndIncluding" : "9.3%285%29", "versionStartIncluding" : "9.3%285%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%288%29n1%281%29" :
        {"versionEndIncluding" : "7.3%288%29n1%281%29", "versionStartIncluding" : "7.3%288%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%289%29n1%280.823%29" :
        {"versionEndIncluding" : "7.3%289%29n1%280.823%29", "versionStartIncluding" : "7.3%289%29n1%280.823%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
