#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501069);
  script_version("1.9");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/10");

  script_cve_id("CVE-2022-43398");
  script_xref(name:"ICSA", value:"22-314-11");

  script_name(english:"Siemens SICAM Q100 Session Fixation (CVE-2022-43398)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in POWER METER SICAM Q100 (All
versions < V2.50), POWER METER SICAM Q100 (All versions < V2.50),
POWER METER SICAM Q100 (All versions < V2.50), POWER METER SICAM Q100
(All versions < V2.50). Affected devices do not renew the session
cookie after login/logout and also accept user defined session
cookies. An attacker could overwrite the stored session cookie of a
user. After the victim logged in, the attacker is given access to the
user's account through the activated session.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-570294.pdf");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-887249.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-22-314-11");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens released updates for the affected products and recommends updating to V2.50 or a later version. 

Siemens identified the following specific workarounds and mitigations users can apply to reduce risk: 

- Restrict access to port 443/tcp to trusted IP addresses only

Operators of critical power systems (e.g. TSOs or DSOs) worldwide are usually required by regulations to build
resilience into the power grids by applying multi-level redundant secondary protection schemes. It is therefore
recommended that the operators check whether appropriate resilient protection measures are in place. The risk of cyber
incidents impacting the grid's reliability can be minimized by virtue of the grid design.

Siemens recommends applying the provided security updates using the corresponding tooling and documented procedures made
available with the product. If supported by the product, operators may use an automated means to apply the security
updates across multiple product instances. Siemens recommends prior validation of any security update before application
and recommends trained staff supervise the update process in the target environment.

As a general security measure, Siemens recommends protecting network access with appropriate mechanisms (e.g. firewalls,
segmentation, VPN) and advises configuring the environment according to operational guidelines in order to run the
devices in a protected IT environment. Recommended security guidelines can be found at Siemens' website.

For further inquiries on security vulnerabilities in Siemens products and solutions, users should contact Siemens
ProductCERT.

For more information, see the associated Siemens security advisory SSA-570294 in HTML and CSAF.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-43398");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(384);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/11/08");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/11/08");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/04/20");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:power_meter_sicam_q100_firmware:2.50");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:power_meter_sicam_q200_series_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:power_meter_sicam_q100_firmware:2.50" :
        {"versionEndExcluding" : "2.50", "family" : "SicamQ100", "orderNumbers" : ['7KG9501-0AA31-2AA1', '7KG9501-0AA01-0AA1', '7KG9501-0AA31-0AA1', '7KG9501-0AA01-2AA1']},
    "cpe:/o:siemens:power_meter_sicam_q200_series_firmware" :
        {"versionEndExcluding" : "2.70", "family" : "SicamQ200"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
