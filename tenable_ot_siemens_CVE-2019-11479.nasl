#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501849);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2019-11479");
  script_xref(name:"ICSA", value:"19-253-03");
  script_xref(name:"CEA-ID", value:"CEA-2019-0456");

  script_name(english:"Siemens Industrial Products Uncontrolled Resource Consumption (CVE-2019-11479)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Multiple industrial products are affected by a vulnerability in the kernel known as TCP SACK PANIC. 
An attacker with network access to affected products could cause a denial of service condition because 
of a vulnerability in the TCP retransmission queue implementation kernel when handling TCP Selective 
Acknowledgements (SACK).

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://cert-portal.siemens.com/productcert/pdf/ssa-462066.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?655a2892");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-19-253-03");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens recommends users follow the specific workarounds and mitigations below. Siemens has also released fixes for the
following products:

- CloudConnect 712: Update to v1.1.5
- ROX II: Update to v2.13.3 (Only vulnerable to CVE-2019-11479)
- RUGGEDCOM APE 1404 Linux: Apply the latest available Debian patches
- RUGGEDCOM RM1224: Update to v6.2 or later
- RUGGEDCOM RX1400 VPE Debian Linux: Apply the latest available Debian patches in the VPE
- RUGGEDCOM RX1400 VPE Linux CloudConnect: Apply the latest available Debian patches in the VPE or apply the latest
CloudConnect VPE Linux image
- SCALANCE M804PB, SCALANCE M812-1 ADSL-Router, SCALANCE M816-1 ADSL-Router, SCALANCE M826-2 SHDSL-Router, SCALANCE
M874-2, SCALANCE M874-3, SCALANCE M876-3, SCALANCE M876-4, SCALANCE S615: Update to v6.2 or later
- SCALANCE M875: Upgrade hardware to SCALANCE M876-4 or RUGGEDCOM RM1224 and apply patches when available
- SCALANCE S602, SCALANCE S612, SCALANCE S623, SCALANCE S627-2M: Update to v4.1, Upgrade hardware to successor product
from SCALANCE SC-600 family
- SCALANCE SC622-2C, SCALANCE SC632-2C, SCALANCE SC636-2C, SCALANCE SC642-2C, SCALANCE SC646-2C: Update to v2.0.1
- SCALANCE W1750D: Update to v8.6.0 or later versions
- SCALANCE W700 IEEE 802.11n family: Update to v6.4 or newer versions

- SIMATIC CP 442-1 RNA: Update to v1.5.18 or later versions
- SIMATIC CP 443-1 RNA: Update to v1.5.18 or later versions

- SIMATIC CP 1242-7C, SIMATIC CP 1243-1, SIMATIC CP 1243-7 LTE EU, SIMATIC CP 1243-7 LTE US, SIMATIC CP 1243-8 IRC:
Update to v3.2 or later
- SIMATIC CP 1542SP-1, SIMATIC CP 1542SP-1 IRC: Update to v2.1 or later versions
- SIMATIC CP 1543-1: Update to v2.2 or later versions
- SIMATIC CP 1543SP-1: Update to v2.1 or later versions
- SIMATIC CP 1623: The updated firmware is contained in SIMATIC NET PC Software v14 Update 14 or later versions or
SIMATIC NET PC Software v16 Update 5 or later versions
- SIMATIC CP 1628: Update to v17.0 or later versions
- SIMATIC ITC1500, SIMATIC ITC1500 PRO, SIMATIC ITC1900, SIMATIC ITC1900 PRO, SIMATIC ITC2200, SIMATIC ITC2200 PRO:
Update to v3.1.1.0 or later versions
- SIMATIC MV540 H, SIMATIC MV540 S, SIMATIC MV550 H, SIMATIC MV550 S, SIMATIC MV560 U, SIMATIC MV560 X: Update to v2.1
or later
- SIMATIC Reader RF610R CMIIT, SIMATIC Reader RF610R ETSI, SIMATIC Reader RF610R FCC, SIMATIC Reader RF615R CMIIT,
SIMATIC Reader RF615R ETSI, SIMATIC Reader RF615R FCC, SIMATIC Reader RF650R ARIB, SIMATIC Reader RF650R CMIIT, SIMATIC
Reader RF650R ETSI, SIMATIC Reader RF650R FCC, SIMATIC Reader RF680R ARIB, SIMATIC Reader RF680R CMIIT, SIMATIC Reader
RF680R ETSI, SIMATIC Reader RF680R FCC, SIMATIC Reader RF685R ARIB, SIMATIC Reader RF685R CMIIT, SIMATIC Reader RF685R
ETSI, SIMATIC Reader RF685R FCC: Update to v4.0 or later versions
- SIMATIC RF185C, SIMATIC RF186C, SIMATIC RF186CI, SIMATIC RF188C, SIMATIC RF188CI: Update to v1.3 or later versions
- SIMATIC S7-1500 CPU 1518-4 PN/DP MFP: Update to v2.8.4
- SINEMA Remote Connect Server: Update to v2.1
- SINUMERIK 808D: Update to v4.92. The update can be obtained from a Siemens representative or via Siemens customer
service
- SINUMERIK 828D/840D sl: Update to v4.8 SP5. The update can be obtained from a Siemens representative or via Siemens
customer service
- SIPLUS ET 200SP CP 1543SP-1 ISEC, SIPLUS ET 200SP CP 1543SP-1 ISEC TX RAIL: Update to v2.1 or later versions
- SIPLUS NET CP 1543-1: Update to v2.2 or later versions
- SIPLUS S7-1200 CP 1243-1, SIPLUS S7-1200 CP 1243-1 RAIL: Update to v3.2 or later versions
- TIM 1531 IRC: Update to v2.1 or later versions

Siemens has identified the following specific workarounds and mitigations users can apply to reduce the risk:

- Restrict network access to affected devices
- Apply defense-in-depth
- For SIMATIC Teleservice Adapters (IE Basic, IE Advanced): migrate to a successor product within the SCALANCE M-800
family. For details refer to the notice of discontinuation.

As a general security measure, Siemens strongly recommends users protect network access to devices with As a general
security measure, Siemens recommends protecting network access to devices with appropriate mechanisms. To operate the
devices in a protected IT environment, Siemens recommends configuring the environment according to Siemensâ operational
guidelines for industrial security and following recommendations in the product manuals. Additional information on
industrial security by Siemens can be found on the Siemens industrial security webpage.

For more information, please see Siemens Security Advisory SSA-462066");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-11479");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/06/19");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/06/19");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/12/22");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rm1224_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m804pb_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m812-1_adsl-router_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m816-1_adsl-router_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m826-2_shdsl-router_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m874-2_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m874-3_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m875_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-3_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-4_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_s615_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc622-2c_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc632-2c_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc636-2c_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc642-2c_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_sc646-2c_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_w1750d_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_w700_series_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_w1700_series_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wlc711_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_wlc712_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cm_1542-1_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1242-7_v2_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1243-1_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1243-7_lte_eu_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1243-7_lte_us_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1243-8_irc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1542sp-1_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1542sp-1_irc_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1543-1_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_cp_1543sp-1_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1518-4_pn%2fdp_mfp_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1518f-4_pn%2fdp_mfp_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_et_200sp_cp_1543sp-1_isec_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_et_200sp_cp_1543sp-1_isec_tx_rail_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_net_cp_1543-1_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_s7-1200_cp_1243-1_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_s7-1200_cp_1243-1_rail_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:ruggedcom_rm1224_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "RuggedCom", "orderNumbers" : ["6GK6108-4AM00"]},
    "cpe:/o:siemens:scalance_m804pb_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCEM", "orderNumbers" : ["6GK5804-0AP00-2AA2"]},
    "cpe:/o:siemens:scalance_m812-1_adsl-router_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCEM", "orderNumbers" : ["6GK5812-1AA00-2AA2", "6GK5812-1BA00-2AA2"]},
    "cpe:/o:siemens:scalance_m816-1_adsl-router_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCEM", "orderNumbers" : ["6GK5816-1AA00-2AA2", "6GK5816-1BA00-2AA2"]},
    "cpe:/o:siemens:scalance_m826-2_shdsl-router_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCEM", "orderNumbers" : ["6GK5826-2AB00-2AB2"]},
    "cpe:/o:siemens:scalance_m874-2_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCEM", "orderNumbers" : ["6GK5874-2AA00-2AA2"]},
    "cpe:/o:siemens:scalance_m874-3_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCEM", "orderNumbers" : ["6GK5874-3AA00-2AA2"]},
    "cpe:/o:siemens:scalance_m875_firmware" :
        {"family" : "SCALANCEM"},
    "cpe:/o:siemens:scalance_m876-3_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCEM", "orderNumbers" : ["6GK5876-3AA02-2BA2", "6GK5876-3AA02-2EA2"]},
    "cpe:/o:siemens:scalance_m876-4_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCEM", "orderNumbers" : ["6GK5876-4AA00-2BA2", "6GK5876-4AA00-2DA2"]},
    "cpe:/o:siemens:scalance_s615_firmware" :
        {"versionEndExcluding" : "6.2", "family" : "SCALANCES", "orderNumbers" : ["6GK5615-0AA00-2AA2"]},
    "cpe:/o:siemens:scalance_sc622-2c_firmware" :
        {"versionEndExcluding" : "2.0.1", "family" : "SCALANCES", "orderNumbers" : ["6GK5622-2GS00-2AC2"]},
    "cpe:/o:siemens:scalance_sc632-2c_firmware" :
        {"versionEndExcluding" : "2.0.1", "family" : "SCALANCES", "orderNumbers" : ["6GK5632-2GS00-2AC2"]},
    "cpe:/o:siemens:scalance_sc636-2c_firmware" :
        {"versionEndExcluding" : "2.0.1", "family" : "SCALANCES", "orderNumbers" : ["6GK5636-2GS00-2AC2"]},
    "cpe:/o:siemens:scalance_sc642-2c_firmware" :
        {"versionEndExcluding" : "2.0.1", "family" : "SCALANCES", "orderNumbers" : ["6GK5642-2GS00-2AC2"]},
    "cpe:/o:siemens:scalance_sc646-2c_firmware" :
        {"versionEndExcluding" : "2.0.1", "family" : "SCALANCES", "orderNumbers" : ["6GK5646-2GS00-2AC2"]},
    "cpe:/o:siemens:scalance_w1750d_firmware" :
        {"versionEndExcluding" : "8.6.0", "family" : "SCALANCEW"},
    "cpe:/o:siemens:scalance_w700_series_firmware" :
        {"versionEndExcluding" : "6.4", "family" : "SCALANCEW"},
    "cpe:/o:siemens:scalance_w1700_series_firmware" :
        {"versionEndExcluding" : "2.0", "family" : "SCALANCEW"},
    "cpe:/o:siemens:scalance_wlc711_firmware" :
        {"family" : "SCALANCEW"},
    "cpe:/o:siemens:scalance_wlc712_firmware" :
        {"family" : "SCALANCEW"},
    "cpe:/o:siemens:simatic_cm_1542-1_firmware" :
        {"versionEndExcluding" : "3.0", "family" : "S71500"},
    "cpe:/o:siemens:simatic_cp_1242-7_v2_firmware" :
        {"versionEndExcluding" : "3.2", "family" : "S71200"},
    "cpe:/o:siemens:simatic_cp_1243-1_firmware" :
        {"versionEndExcluding" : "3.2", "family" : "S71200", "orderNumbers" : ["6GK7243-1BX30-0XE0"]},
    "cpe:/o:siemens:simatic_cp_1243-7_lte_eu_firmware" :
        {"versionEndExcluding" : "3.2", "family" : "S71200", "orderNumbers" : ["6GK7243-7KX30-0XE0"]},
    "cpe:/o:siemens:simatic_cp_1243-7_lte_us_firmware" :
        {"versionEndExcluding" : "3.2", "family" : "S71200", "orderNumbers" : ["6GK7243-7SX30-0XE0"]},
    "cpe:/o:siemens:simatic_cp_1243-8_irc_firmware" :
        {"versionEndExcluding" : "3.2", "family" : "S71200", "orderNumbers" : ["6GK7243-8RX30-0XE0"]},
    "cpe:/o:siemens:simatic_cp_1542sp-1_firmware" :
        {"versionEndExcluding" : "2.1", "family" : "S71500", "orderNumbers" : ["6GK7542-6UX00-0XE0"]},
    "cpe:/o:siemens:simatic_cp_1542sp-1_irc_firmware" :
        {"versionEndExcluding" : "2.1", "family" : "S71500"},
    "cpe:/o:siemens:simatic_cp_1543-1_firmware" :
        {"versionEndExcluding" : "2.2", "family" : "S71500", "orderNumbers" : ["6GK7543-1AX00-0XE0"]},
    "cpe:/o:siemens:simatic_cp_1543sp-1_firmware" :
        {"versionEndExcluding" : "2.1", "family" : "S71500", "orderNumbers" : ["6GK7543-6WX00-0XE0"]},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1518-4_pn%2fdp_mfp_firmware" :
        {"versionEndExcluding" : "2.8.4", "family" : "S71500", "orderNumbers" : ["6ES7518-4AX00-1AC0","6AG1518-4AX00-4AC0"]},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1518f-4_pn%2fdp_mfp_firmware" :
        {"versionEndExcluding" : "2.8.4", "family" : "S71500", "orderNumbers" : ["6ES7518-4FX00-1AC0"]},
    "cpe:/o:siemens:siplus_et_200sp_cp_1543sp-1_isec_firmware" :
        {"versionEndExcluding" : "2.1", "family" : "ET200", "orderNumbers" : ["6AG1543-6WX00-7XE0"]},
    "cpe:/o:siemens:siplus_et_200sp_cp_1543sp-1_isec_tx_rail_firmware" :
        {"versionEndExcluding" : "2.1", "family" : "ET200", "orderNumbers" : ["6AG2543-6WX00-4XE0"]},
    "cpe:/o:siemens:siplus_net_cp_1543-1_firmware" :
        {"versionEndExcluding" : "2.2", "family" : "S71500", "orderNumbers" : ["6AG1543-1AX00-2XE0"]},
    "cpe:/o:siemens:siplus_s7-1200_cp_1243-1_firmware" :
        {"versionEndExcluding" : "3.2", "family" : "S71200", "orderNumbers" : ["6AG1243-1BX30-2AX0"]},
    "cpe:/o:siemens:siplus_s7-1200_cp_1243-1_rail_firmware" :
        {"versionEndExcluding" : "3.2", "family" : "S71200", "orderNumbers" : ["6AG2243-1BX30-1XE0"]}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);