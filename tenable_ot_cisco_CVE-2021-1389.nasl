#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501862);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/01/05");

  script_cve_id("CVE-2021-1389");

  script_name(english:"Cisco IOS XR and NX-OS Software IPv6 Access Control List Bypass (CVE-2021-1389)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the IPv6 traffic processing of Cisco IOS XR
Software and Cisco NX-OS Software for certain Cisco devices could
allow an unauthenticated, remote attacker to bypass an IPv6 access
control list (ACL) that is configured for an interface of an affected
device. The vulnerability is due to improper processing of IPv6
traffic that is sent through an affected device. An attacker could
exploit this vulnerability by sending crafted IPv6 packets that
traverse the affected device. A successful exploit could allow the
attacker to access resources that would typically be protected by the
interface ACL.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ipv6-acl-CHgdYk8j
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?76e17295");
  script_set_attribute(attribute:"solution", value:
"After upgrading a device to a fixed release of Cisco NX-OS Software, 
customers must apply the rule extension-header deny-all to any IPv6 ACL 
that is configured on the device. The rule is not enabled by default. 
A device should be considered vulnerable until the rule extension-header 
deny-all has been applied to all IPv6 ACLs that are configured on the device, 
even if it is running a fixed Cisco NX-OS Software release.

For more information, please refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-1389");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/02/04");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/02/04");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/01/04");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:-");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:-" :
        {"family" : "NXOS", "versionEndExcluding" : "9.3(6)"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
