#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501377);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2021-1523");

  script_name(english:"Cisco Nexus 9000 Series Fabric Switches ACI Mode Queue Wedge Denial of Service (CVE-2021-1523)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in Cisco Nexus 9000 Series Fabric Switches in
Application Centric Infrastructure (ACI) Mode could allow an
unauthenticated, remote attacker to cause a queue wedge on a leaf
switch, which could result in critical control plane traffic to the
device being dropped. This could result in one or more leaf switches
being removed from the fabric. This vulnerability is due to
mishandling of ingress TCP traffic to a specific port. An attacker
could exploit this vulnerability by sending a stream of TCP packets to
a specific port on a Switched Virtual Interface (SVI) configured on
the device. A successful exploit could allow the attacker to cause a
specific packet queue to queue network buffers but never process them,
leading to an eventual queue wedge. This could cause control plane
traffic to be dropped, resulting in a denial of service (DoS)
condition where the leaf switches are unavailable. Note: This
vulnerability requires a manual intervention to power-cycle the device
to recover.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-n9kaci-queue-wedge-cLDDEfKF
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?8c4051f9");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-1523");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(772);

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/08/25");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/08/25");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:13.2%283n%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:14.2%284i%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:13.2%283n%29" :
        {"versionEndIncluding" : "13.2%283n%29", "versionStartIncluding" : "13.2%283n%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:14.2%284i%29" :
        {"versionEndIncluding" : "14.2%284i%29", "versionStartIncluding" : "14.2%284i%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
