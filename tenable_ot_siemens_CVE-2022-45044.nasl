#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500719);
  script_version("1.9");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/26");

  script_cve_id("CVE-2022-45044");
  script_xref(name:"ICSA", value:"22-349-11");

  script_name(english:"Siemens SIPROTEC 5 Devices Uncontrolled Resource Consumption (CVE-2022-45044)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Affected devices do not properly restrict secure client-initiated
renegotiations within the SSL and TLS protocols. This could allow an
attacker to create a denial of service condition on the ports 443/tcp
and 4443/tcp for the duration of the attack.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-552874.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-22-349-11");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has identified the following specific workarounds and mitigations users can apply to reduce risk:

- Restrict access to ports 443/TCP and 4443/TCP to trusted only IP addresses.

Operators of critical power systems worldwide are usually required by regulations to build resilience into power grids
by applying multi-level redundant secondary protection schemes. Therefore, Siemens recommends operators check whether
appropriate resilient protection measures are in place. The risk of cyber incidents impacting the grid's reliability can
thus be minimized by virtue of the grid design.  Siemens strongly recommends applying the provided security updates
using the corresponding tooling and documented procedures made available with the product. If supported by the product,
an automated means to apply the security updates across multiple product instances may be used. Siemens strongly
recommends prior validation of any security update prior to application, and supervision by trained staff of the update
process in the target environment.

As a general security measure, Siemens strongly recommends protecting network access to devices with appropriate
mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends configuring the
environment according to Siemensâ€™ operational guidelines for industrial security and to follow the recommendations in
the product manuals. For more information, see the associated Siemens security advisory SSA-408105 in HTML and CSAF.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-45044");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/12/13");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/12/13");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/01/05");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md84_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md85_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md86_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md89_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6mu85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ke85_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ke85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa82_%28cp150%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa84_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa86_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa87_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd82_%28cp150%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd84_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd86_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd87_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj81_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj81_%28cp150%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj82_%28cp150%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj85_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj86_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sk82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sk82_%28cp150%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sk85_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sk85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl82_%28cp150%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl86_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl87_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ss85_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ss85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7st85_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7st85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7st86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sx82_%28cp150%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sx85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7um85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut82_%28cp150%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut85_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut86_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut87_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ve85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7vk87_%28cp200%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7vk87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7vu85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_communication_module_eth-ba-2el_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_communication_module_eth-bb-2fo_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_communication_module_eth-bd-2fo_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_compact_7sx800_%28cp050%29_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:siprotec_5_6md85_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6md86_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ke85_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa84_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa86_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa87_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd84_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd86_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd87_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj85_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj86_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sk85_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl86_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl87_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ss85_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7st85_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut85_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut86_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut87_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7vk87_%28cp200%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa82_%28cp100%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd82_%28cp100%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl82_%28cp100%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut82_%28cp100%29_firmware" :
        {"family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_compact_7sx800_%28cp050%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj81_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.89", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj82_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.89", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sk82_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.89", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa82_%28cp150%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd82_%28cp150%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl82_%28cp150%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7vk87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj81_%28cp150%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj82_%28cp150%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sk82_%28cp150%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sk85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut82_%28cp150%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6mu85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sx82_%28cp150%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sx85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ke85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.64", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ss85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7st85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.64", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7um85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ve85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6md85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6md86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6md89_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.64", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6md84_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7vu85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7st86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "9.64", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_communication_module_eth-ba-2el_firmware:-" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_communication_module_eth-bb-2fo_firmware:-" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_communication_module_eth-bd-2fo_firmware:-" :
        {"versionEndExcluding" : "9.50", "family" : "Siprotec5"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
