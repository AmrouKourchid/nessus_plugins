#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501401);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/12/25");

  script_cve_id("CVE-2015-4225");

  script_name(english:"Cisco Application Policy Infrastructure Controller Unauthorized Access (CVE-2015-4225)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Cisco Application Policy Infrastructure Controller (APIC) 1.0(1.110a)
and 1.0(1e) on Nexus 9000 devices does not properly implement RBAC
health scoring, which allows remote authenticated users to obtain
sensitive information via unspecified vectors, aka Bug ID CSCuq77485.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://tools.cisco.com/security/center/viewAlert.x?alertId=39529");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/75433");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1032735");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:P/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2015-4225");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(264);

  script_set_attribute(attribute:"vuln_publication_date", value:"2015/06/27");
  script_set_attribute(attribute:"patch_publication_date", value:"2015/06/27");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:1.0%281.110a%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:1.0%281e%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:1.0%281.110a%29" :
        {"versionEndIncluding" : "1.0%281.110a%29", "versionStartIncluding" : "1.0%281.110a%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:1.0%281e%29" :
        {"versionEndIncluding" : "1.0%281e%29", "versionStartIncluding" : "1.0%281e%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
