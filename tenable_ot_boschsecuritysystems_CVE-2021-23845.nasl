#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501996);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/02/15");

  script_cve_id("CVE-2021-23845");

  script_name(english:"Bosch Security Systems B426 Conettix Improper Access Control (CVE-2021-23845)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"This vulnerability could allow an attacker to hijack a session while a
user is logged in the configuration web page. This vulnerability was
discovered by a security researcher in B426 and found during internal
product tests in B426-CN/B429-CN, and B426-M and has been fixed
already starting from version 3.08 on, which was released on June
2019.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://psirt.bosch.com/security-advisories/bosch-sa-196933-bt.html");
  script_set_attribute(attribute:"solution", value:
"The recommended approach is to update the software of affected Bosch products to a fixed version. 
If an update is not possible in a timely manner, the mitigation approaches Firewalling and IP Filtering can be utilized. 
A list of affected and fixed firmware versions is available in the 'Affected Products' section of the vendor advisory. 

It is advised that the devices should not be exposed directly to the internet or other insecure networks. 
This includes port-forwarding, which would not protect devices adequately. 
Firewalling a device significantly reduces its attack surface.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-23845");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/06/18");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/06/18");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/02/14");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bosch:b426_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/BoschSecuritySystems");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/BoschSecuritySystems');

var asset = tenable_ot::assets::get(vendor:'BoschSecuritySystems');

var vuln_cpes = {
    "cpe:/o:bosch:b426_firmware" :
        {"versionEndExcluding" : "03.08", "family" : "B426"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
