#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502566);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/10/17");

  script_cve_id("CVE-2023-34972");

  script_name(english:"Qnap QTS Cleartext Transmission of Sensitive Information (CVE-2023-34972)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A cleartext transmission of sensitive information vulnerability has
been reported to affect QNAP operating systems. If exploited, the
vulnerability possibly allows local network clients to read the
contents of unexpected sensitive data via unspecified vectors. We have
already fixed the vulnerability in the following versions: QTS
5.0.1.2425 build 20230609 and later QTS 5.1.0.2444 build 20230629 and
later QuTS hero h5.1.0.2424 build 20230609 and later

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://www.qnap.com/en/security-advisory/qsa-23-58");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:C/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-34972");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(319);

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/08/24");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/08/24");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/10/16");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:qnap:qts:5.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:qnap:qts:5.1.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:qnap:quts_hero:h5.1.0");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Qnap");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Qnap');

var asset = tenable_ot::assets::get(vendor:'Qnap');

var vuln_cpes = {
    "cpe:/o:qnap:qts:5.0.0" :
        {"versionStartIncluding" : "5.0.0", "versionEndExcluding" : "5.0.1.2425", "family" : "QTS"},
    "cpe:/o:qnap:qts:5.1.0" :
        {"versionStartIncluding" : "5.1.0", "versionEndExcluding" : "5.1.0.2444", "family" : "QTS"},
    "cpe:/o:qnap:quts_hero:h5.1.0" :
        {"versionStartIncluding" : "h5.1.0", "versionEndExcluding" : "h5.1.0.2424", "family" : "QuTSHero"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
