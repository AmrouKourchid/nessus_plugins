#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502746);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/05");

  script_cve_id("CVE-2017-12342");

  script_name(english:"Cisco NX-OS Exposure of Resource to Wrong Sphere (CVE-2017-12342)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Open Agent Container (OAC) feature of Cisco
Nexus Series Switches could allow an unauthenticated, local attacker
to read and send packets outside the scope of the OAC. The
vulnerability is due to insufficient internal security measures in the
OAC feature. An attacker could exploit this vulnerability by crafting
specific packets for communication on the device-internal network. A
successful exploit could allow the attacker to run code on the
underlying host operating system. OAC is not enabled by default. For a
device to be vulnerable, an administrator would need to install and
activate this feature. This vulnerability affects the following Cisco
Nexus Series Switches: Nexus 2000 Series Fabric Extenders, Nexus 5000
Series Switches, Nexus 5500 Platform Switches, Nexus 5600 Platform
Switches, Nexus 6000 Series Switches, Nexus 7000 Series Switches,
Nexus 7700 Series Switches. Cisco Bug IDs: CSCve53542, CSCvf36621.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/102027");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1039940");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20171129-nxos9
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?830cf4fc");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/102027");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1039940");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20171129-nxos9
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?830cf4fc");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-12342");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(264, 668);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/11/30");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/11/30");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/12/04");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1%281%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29" :
        {"versionEndIncluding" : "7.0%280%29hsk%280.357%29", "versionStartIncluding" : "7.0%280%29hsk%280.357%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1%281%29" :
        {"versionEndIncluding" : "8.1%281%29", "versionStartIncluding" : "8.1%281%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
