#TRUSTED 53ab79a76b907b241ebeeb2eb4cd4f14b27499aa270e13623e60bf1f474b630f0582dd95841cb44b6975613af4cc2ebafa9225283244097e0326779c025762dfe2ad459475ed997a1282acf71b5b00ce0b47939e109d5360b7673c32bad3207978ed70684696da6e6ffdf04cda73e3af1e07be87174f3a25788ccadd6775e3f969ecb9f0246bd1b8970d3bcca4a592803ec6987da194db36cf0447e6ed886baa76dc8d8a40da0d395d6b954b51ee4295fd68d918e8746305cdc3e38c9c54f40fa90732d1eea59a25bcc2b6f048b90fd65d7d20545521fea4d88423f5e955d3139e49e17dcf5b42bcbbae620fd8e2ab036e45d6e8c0a69cf593367fcc6f81648a43361fbfe144185341c1ba2ddff38e86e0573ed408193a8034edc81ed7770257414b71989a21876aab95f2e323673638f7bfb7030f31d1b00e774ae41d4117f3e0da903f214ec3f4a6d688d9c78a240bc1d27f88fba968e868f0e5be035e990187be324c7d3354e2a7c0982f99363f09820e8b712064a10929c4ffa8ba80a944078c3e08d5b701d004f87063f3016ef7045a76fef487ce63907c18c37c0b9e987723d518de3817d67307b59d3e30c515df1b5d0bb64d7ee8eb39939aa81ce42ae3ee17d743628a1787d2407bab21c8ee2da482f31509aefd013270aeedc3dec6731bac7691c0a2baea9e6d80151952d64278b95159991dc32c6d21f5fcadcd48
#TRUST-RSA-SHA256 4ffe212bb4d93bc6cb5d33e046060011cbab0a9e6fbbb39dd62dfaea09055e0bfb75693d8cd5ba3cf239e638d965a166ffd25ec70ba2004f0802458f52330f175fd13b91f080dcfafab9763b3b0bbd92966d82c8282c107e454c8d2f848b8f5a54c35b2095c24e28082fb03cbcc2b28382b443cc2d2cc008fe8dc0074901c9c121b02f33b7c73657ba4cae1483206e4ee44e08e5a7ee8dbf037b2ee69f58b51bd480a87b0546ea5984bcb47f697318ef4b4b4214b9e19be3be328146025c8ca124b57ea10188d6ce066dd724a217198139a5915453295805cfc8618608ef68b2d5460cfa82f1584bb9d0dcf8231d363cd2c73b5e9221f1350ac83806e0cd7ed27ca0e502066047715baed2635c9f929d60423e8b7683e359ff8fb1388c552951ec322ccb044e306a9043559b00d0ac5c87425d8dff212f3e0d3eedd4f96f08dba2009ad62d4b17ccd98f3a666cf2e062ccb03e166f44cb30b08e3382b22a37b86c4320423f174885ca4e2b57ac8252114f3ee0fc2f6c13a50c5713020615ec638be743cd22a85b00a6f6f67a9ade7569da001bca1801f07400056b2149eda88774822b5c6d29e7c471a144d5122d1b58fef192743b26256fd2c27167115e608ca48394169bcb13dce802e544289bfcc0ebde3f5a2430d68f526a37daaeacef8e19c77605458d0092a52aeea7d4dfe1650acb1ea303b719af983f6880da95d2e4
#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(215115);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/07");

  script_cve_id("CVE-2025-20184");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwk98506");
  script_xref(name:"CISCO-SA", value:"cisco-sa-esa-sma-wsa-multi-yKUJhS34");
  script_xref(name:"IAVA", value:"2025-A-0082");

  script_name(english:"Cisco Secure Email Gateway Command Injection (cisco-sa-esa-sma-wsa-multi-yKUJhS34)");

  script_set_attribute(attribute:"synopsis", value:
"The remote device is missing a vendor-supplied security patch.");
  script_set_attribute(attribute:"description", value:
"According to its self-reported version, Secure Email Gateway is affected by a vulnerability.

  - A vulnerability in the web-based management interface of Cisco AsyncOS Software for Cisco Secure Email
    Gateway and Cisco Secure Web Appliance could allow an authenticated, remote attacker to perform command
    injection attacks against an affected device. The attacker must authenticate with valid administrator
    credentials. This vulnerability is due to insufficient validation of XML configuration files by an
    affected device. An attacker could exploit this vulnerability by uploading a crafted XML configuration
    file. A successful exploit could allow the attacker to inject commands to the underlying operating system
    with root privileges. (CVE-2025-20184)

Please see the included Cisco BID and Cisco Security Advisory for more information.");
  # https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-esa-sma-wsa-multi-yKUJhS34
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a765161e");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwk98506");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the relevant fixed version referenced in Cisco bug ID CSCwk98506");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:M/C:C/I:C/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2025-20184");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2025/02/05");
  script_set_attribute(attribute:"patch_publication_date", value:"2025/02/05");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/02/07");

  script_set_attribute(attribute:"plugin_type", value:"combined");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:cisco:email_security_appliance");
  script_set_attribute(attribute:"stig_severity", value:"II");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CISCO");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("cisco_esa_version.nasl");
  script_require_keys("Host/AsyncOS/Cisco Email Security Appliance/Version");

  exit(0);
}


include('ccf.inc');

var product_info = cisco::get_product_info(name:'Cisco Email Security Appliance (ESA)');

var vuln_ranges = [
  {'min_ver' : '0.0', 'fix_ver' : '16.0.0.050'}
];

var reporting = make_array(
  'port'          , 0,
  'severity'      , SECURITY_HOLE,
  'version'       , product_info['version'],
  'bug_id'        , 'CSCwk98506',
  'disable_caveat', TRUE
);

cisco::check_and_report(
  product_info:product_info,
  reporting:reporting,
  vuln_ranges:vuln_ranges
);

