#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(206273);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/10/15");

  script_cve_id("CVE-2024-28987");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2024/11/05");

  script_name(english:"SolarWinds Web Help Desk < 12.8.3 HF 2 HardCoded Credentials");

  script_set_attribute(attribute:"synopsis", value:
"An application installed on the remote host is affected by a hardcoded credential vulnerability.");
  script_set_attribute(attribute:"description", value:
"The version of SolarWinds Web Help Desk installed on the remote host is prior to 12.8.3 HF2. It is, therefore,
affected by a hardcoded credential vulnerability, that, if exploited, would allow an attacker to run commands on 
the host machine. 

Note that Nessus has not tested for these issues but has instead relied only on the application's self-reported version
number.");
  # https://www.solarwinds.com/trust-center/security-advisories/cve-2024-28987
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?29732abf");
  # https://support.solarwinds.com/SuccessCenter/s/article/SolarWinds-Web-Help-Desk-12-8-3-Hotfix-2
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?542da88a");
  script_set_attribute(attribute:"solution", value:
"Upgrade to Web Help Desk version 12.8.3 Hotfix 2 or later.");
  script_set_attribute(attribute:"agent", value:"windows");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-28987");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/08/21");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/08/21");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/08/28");

  script_set_attribute(attribute:"plugin_type", value:"combined");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:solarwinds:web_help_desk");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CGI abuses");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("solarwinds_web_help_desk_detect.nbin", "solarwinds_web_help_desk_installed.nbin");
  script_require_keys("installed_sw/Solarwinds Web Help Desk");

  exit(0);
}

include('vcf.inc');

var app_info = vcf::combined_get_app_info(app:'Solarwinds Web Help Desk');

# according to advisory everything at or below 1813 is vulnerable, including hf1 - we do not know hf1's 
# Can't check hotfixes, guestimating w/ paranoia that all builds between 14-99 are vuln
var constraints = [
  {'fixed_version' : '12.8.3', 'max_version':'12.8.3.1813', 'fixed_display' : '12.8.3 Hotfix 2'},
  {'min_version':'12.8.3.1814', 'max_version':'12.8.3.1899', 'require_paranoia' : TRUE , 'fixed_display' : '12.8.3 Hotfix 2'} 
];

vcf::check_version_and_report(
  app_info:app_info,
  constraints:constraints,
  severity:SECURITY_HOLE
);
