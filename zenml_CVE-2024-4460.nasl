#%NASL_MIN_LEVEL 80900

##
# Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(213485);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/01/16");

  script_cve_id("CVE-2024-4460");

  script_name(english:"ZenML < 0.57.1 DoS (CVE-2024-4460)");

  script_set_attribute(attribute:"synopsis", value:
"The remote host is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The version of ZenML installed on the remote host is prior to 0.57.1. It is, therefore, affected by a
denial of service (DoS) vulnerability exists in zenml-io/zenml version due to improper handling of
line feed (`\n`) characters in component names. When a low-privileged user adds a component through the API
endpoint `api/v1/workspaces/default/components` with a name containing a `\n` character, it leads to
uncontrolled resource consumption. This vulnerability results in the inability of users to add new components
in certain categories (e.g., 'Image Builder') and to register new stacks through the UI, thereby degrading the
user experience and potentially rendering the ZenML Dashboard unusable. The issue does not affect component
addition through the Web UI, as `\n` characters are properly escaped in that context. The vulnerability was
tested on ZenML running in Docker, and it was observed in both Firefox and Chrome browsers. The project maintainers 
disputed the exposure with NVD and claim it is only a QA bug.

Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version number.");
  script_set_attribute(attribute:"see_also", value:"https://github.com/zenml-io/zenml/releases/tag/0.57.1");
  # https://github.com/zenml-io/zenml/commit/164cc09032060bbfc17e9dbd62c13efd5ff5771b
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?9d344918");
  script_set_attribute(attribute:"see_also", value:"https://huntr.com/bounties/a387c935-b970-44d7-bddc-71c1c90aa2de");
  script_set_attribute(attribute:"solution", value:
"Upgrade to ZenML version 0.57.1 or later.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-4460");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/06/24");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/06/24");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/01/03");

  script_set_attribute(attribute:"plugin_type", value:"combined");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:zenml:zenml");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Artificial Intelligence");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("zenml_detect.nbin", "python_zenml_detect.nbin");
  script_require_keys("installed_sw/ZenML");

  exit(0);
}

include('vcf.inc');

var app_info = vcf::combined_get_app_info(app:'ZenML');
var constraints = [
    { 'min_version':'0.1', 'fixed_version':'0.57.1' },
];

vcf::check_version_and_report(app_info:app_info, constraints:constraints, severity:SECURITY_WARNING);
        