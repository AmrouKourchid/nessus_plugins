#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502754);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/05");

  script_cve_id("CVE-2017-12259");

  script_name(english:"Cisco Small Business Improper Restriction of Operations within the Bounds of a Memory Buffer (CVE-2017-12259)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the implementation of Session Initiation Protocol
(SIP) functionality in Cisco Small Business SPA51x Series IP Phones
could allow an unauthenticated, remote attacker to cause an affected
device to become unresponsive, resulting in a denial of service (DoS)
condition. The vulnerability is due to the improper handling of SIP
request messages by an affected device. An attacker could exploit this
vulnerability by sending malformed SIP messages to an affected device.
A successful exploit could allow the attacker to cause the affected
device to become unresponsive, resulting in a DoS condition that
persists until the device is restarted manually. This vulnerability
affects Cisco Small Business SPA51x Series IP Phones that are running
Cisco SPA51x Firmware Release 7.6.2SR1 or earlier. Cisco Bug IDs:
CSCvc63982.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/101488");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1039615");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20171018-sip
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ebc05277");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/101488");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1039615");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20171018-sip
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ebc05277");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-12259");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(119);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/10/19");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/10/19");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/12/04");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:small_business_ip_phone_firmware::sr1");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:small_business_ip_phone_firmware::sr1" :
        {"versionEndIncluding" : "7.6.2", "family" : "CiscoIPPhones"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
