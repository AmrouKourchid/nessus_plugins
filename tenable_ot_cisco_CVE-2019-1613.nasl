#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501385);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/03/22");

  script_cve_id("CVE-2019-1613");

  script_name(english:"Cisco NX-OS Software CLI Command Injection Vulnerability (CVE-2019-1613)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the CLI of Cisco NX-OS Software could allow an
authenticated, local attacker to execute arbitrary commands on the
underlying operating system of an affected device. The vulnerability
is due to insufficient validation of arguments passed to certain CLI
commands. An attacker could exploit this vulnerability by including
malicious input as the argument of an affected command. A successful
exploit could allow the attacker to execute arbitrary commands on the
underlying operating system with elevated privileges. An attacker
would need valid administrator credentials to exploit this
vulnerability. MDS 9000 Series Multilayer Switches are affected
running software versions prior to 6.2(27) and 8.2(3). Nexus 3000
Series Switches are affected running software versions prior to
7.0(3)I4(9) and 7.0(3)I7(6). Nexus 3500 Platform Switches are affected
running software versions prior to 6.0(2)A8(11) and 7.0(3)I7(6). Nexus
3600 Platform Switches are affected running software versions prior to
7.0(3)F3(5). Nexus 9000 Series Switches in Standalone NX-OS Mode are
affected running software versions prior to 7.0(3)I4(9), 7.0(3)I7(6).
Nexus 9500 R-Series Line Cards and Fabric Modules are affected running
software versions prior to 7.0(3)F3(5). Nexus 7000 and 7700 Series
Switches are affected running software versions prior to 6.2(22) and
8.2(3).

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/107392");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190306-nxos-cmdinj-1613
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4f5871d9");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-1613");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(88);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/03/11");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/03/11");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29f3%283%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i7%282%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.2%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:9.2%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:9.2%282%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:7.0%283%29f3%283%29" :
        {"versionEndIncluding" : "7.0%283%29f3%283%29", "versionStartIncluding" : "7.0%283%29f3%283%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7%282%29" :
        {"versionEndIncluding" : "7.0%283%29i7%282%29", "versionStartIncluding" : "7.0%283%29i7%282%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:9.2%281%29" :
        {"versionEndIncluding" : "9.2%281%29", "versionStartIncluding" : "9.2%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.2%281%29" :
        {"versionEndIncluding" : "8.2%281%29", "versionStartIncluding" : "8.2%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:9.2%282%29" :
        {"versionEndIncluding" : "9.2%282%29", "versionStartIncluding" : "9.2%282%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
