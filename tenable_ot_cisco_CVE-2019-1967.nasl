#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501255);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2019-1967");

  script_name(english:"Cisco NX-OS Software Network Time Protocol Denial of Service (CVE-2019-1967)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Network Time Protocol (NTP) feature of Cisco
NX-OS Software could allow an unauthenticated, remote attacker to
cause a denial of service (DoS) condition on an affected device. The
vulnerability is due to excessive use of system resources when the
affected device is logging a drop action for received MODE_PRIVATE
(Mode 7) NTP packets. An attacker could exploit this vulnerability by
flooding the device with a steady stream of Mode 7 NTP packets. A
successful exploit could allow the attacker to cause high CPU and
memory usage on the affected device, which could cause internal system
processes to restart or cause the affected device to unexpectedly
reload. Note: The NTP feature is enabled by default.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190828-nxos-ntp-dos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?7bfb1f81");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-1967");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/08/30");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/08/30");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.0%282%29a8");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.0%282%29a8%289.7%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.0%282%29u6");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29f");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i7");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%284%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%284%29n1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%285%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.3");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.3%282%29d1%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.3");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.3%282%29s5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:9.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:9.2%281%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:6.2" :
        {"versionEndIncluding" : "6.2", "versionStartIncluding" : "6.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3" :
        {"versionEndIncluding" : "7.3", "versionStartIncluding" : "7.3", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1" :
        {"versionEndIncluding" : "8.1", "versionStartIncluding" : "8.1", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.2" :
        {"versionEndIncluding" : "8.2", "versionStartIncluding" : "8.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.3" :
        {"versionEndIncluding" : "8.3", "versionStartIncluding" : "8.3", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29a8%289.7%29" :
        {"versionEndIncluding" : "6.0%282%29a8%289.7%29", "versionStartIncluding" : "6.0%282%29a8%289.7%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29u6" :
        {"versionEndIncluding" : "6.0%282%29u6", "versionStartIncluding" : "6.0%282%29u6", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i" :
        {"versionEndIncluding" : "7.0%283%29i", "versionStartIncluding" : "7.0%283%29i", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:9.2" :
        {"versionEndIncluding" : "9.2", "versionStartIncluding" : "9.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:9.2%281%29" :
        {"versionEndIncluding" : "9.2%281%29", "versionStartIncluding" : "9.2%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29a8" :
        {"versionEndIncluding" : "6.0%282%29a8", "versionStartIncluding" : "6.0%282%29a8", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7" :
        {"versionEndIncluding" : "7.0%283%29i7", "versionStartIncluding" : "7.0%283%29i7", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29f" :
        {"versionEndIncluding" : "7.0%283%29f", "versionStartIncluding" : "7.0%283%29f", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%284%29" :
        {"versionEndIncluding" : "7.1%284%29", "versionStartIncluding" : "7.1%284%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%284%29n1%281%29" :
        {"versionEndIncluding" : "7.1%284%29n1%281%29", "versionStartIncluding" : "7.1%284%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%285%29" :
        {"versionEndIncluding" : "7.1%285%29", "versionStartIncluding" : "7.1%285%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.2" :
        {"versionEndIncluding" : "7.2", "versionStartIncluding" : "7.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%282%29d1%281%29" :
        {"versionEndIncluding" : "7.3%282%29d1%281%29", "versionStartIncluding" : "7.3%282%29d1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.0" :
        {"versionEndIncluding" : "8.0", "versionStartIncluding" : "8.0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.3%282%29s5" :
        {"versionEndIncluding" : "8.3%282%29s5", "versionStartIncluding" : "8.3%282%29s5", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
