#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501274);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2019-1605");

  script_name(english:"Cisco NX-OS Software NX-API Arbitrary Code Execution (CVE-2019-1605)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the NX-API feature of Cisco NX-OS Software could
allow an authenticated, local attacker to execute arbitrary code as
root. The vulnerability is due to incorrect input validation in the
NX-API feature. An attacker could exploit this vulnerability by
sending a crafted HTTP or HTTPS request to an internal service on an
affected device that has the NX-API feature enabled. A successful
exploit could allow the attacker to cause a buffer overflow and
execute arbitrary code as root. Note: The NX-API feature is disabled
by default. MDS 9000 Series Multilayer Switches are affected in
versions prior to 8.1(1). Nexus 3000 Series Switches are affected in
versions prior to 7.0(3)I4(8) and 7.0(3)I7(1). Nexus 3500 Platform
Switches are affected in versions prior to 6.0(2)A8(8). Nexus 3600
Platform Switches are affected in versions prior to 7.0(3)F3(5). Nexus
2000, 5500, 5600, and 6000 Series Switches are affected in versions
prior to 7.3(2)N1(1). Nexus 7000 and 7700 Series Switches are affected
in versions prior to 7.3(3)D1(1). Nexus 9000 Series Switches in
Standalone NX-OS Mode are affected in versions prior to 7.0(3)I4(8)
and 7.0(3)I7(1). Nexus 9500 R-Series Line Cards and Fabric Modules are
affected in versions prior to 7.0(3)F3(5).

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/107313");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190306-nxos-api-ex
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4326b1dc");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-1605");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(119);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/03/08");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/03/08");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:8.1%281%29" :
        {"versionEndExcluding" : "8.1%281%29", "versionStartIncluding" : "7.3", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29a8%288%29" :
        {"versionEndExcluding" : "6.0%282%29a8%288%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7%281%29" :
        {"versionEndExcluding" : "7.0%283%29i7%281%29", "versionStartIncluding" : "7.0%283%29i5", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29f3%285%29" :
        {"versionEndExcluding" : "7.0%283%29f3%285%29", "versionStartIncluding" : "7.0%283%29f1", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%283%29d1%281%29" :
        {"versionEndExcluding" : "7.3%283%29d1%281%29", "versionStartIncluding" : "7.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i4%288%29" :
        {"versionEndExcluding" : "7.0%283%29i4%288%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%282%29n1%281%29" :
        {"versionEndExcluding" : "7.3%282%29n1%281%29", "versionStartIncluding" : "7.3", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
