#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501460);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2017-14028");
  script_xref(name:"ICSA", value:"17-320-01");

  script_name(english:"Moxa NPort 5110, 5130, and 5150 Uncontrolled Resource Consumption (CVE-2017-14028)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A Resource Exhaustion issue was discovered in Moxa NPort 5110 Version
2.2, NPort 5110 Version 2.4, NPort 5110 Version 2.6, NPort 5110
Version 2.7, NPort 5130 Version 3.7 and prior, and NPort 5150 Version
3.7 and prior. An attacker may be able to exhaust memory resources by
sending a large amount of TCP SYN packets.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/101885");
  script_set_attribute(attribute:"see_also", value:"https://ics-cert.us-cert.gov/advisories/ICSA-17-320-01");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Moxa has produced new firmware for the affected devices that can be downloaded from:

NPort 5110 https://www.moxa.com/support/download.aspx?type=support&id=882

NPort 5130 and NPort 5150 https://www.moxa.com/support/download.aspx?type=support&id=356");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-14028");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/11/16");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/11/16");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/08/02");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:nport_5110_firmware:2.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:nport_5110_firmware:2.4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:nport_5110_firmware:2.6");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:nport_5110_firmware:2.7");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:nport_5130_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:nport_5150_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Moxa");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Moxa');

var asset = tenable_ot::assets::get(vendor:'Moxa');

var vuln_cpes = {
    "cpe:/o:moxa:nport_5110_firmware:2.2" :
        {"versionEndIncluding" : "2.2", "versionStartIncluding" : "2.2", "family" : "NPort"},
    "cpe:/o:moxa:nport_5110_firmware:2.4" :
        {"versionEndIncluding" : "2.4", "versionStartIncluding" : "2.4", "family" : "NPort"},
    "cpe:/o:moxa:nport_5110_firmware:2.6" :
        {"versionEndIncluding" : "2.6", "versionStartIncluding" : "2.6", "family" : "NPort"},
    "cpe:/o:moxa:nport_5110_firmware:2.7" :
        {"versionEndIncluding" : "2.7", "versionStartIncluding" : "2.7", "family" : "NPort"},
    "cpe:/o:moxa:nport_5130_firmware" :
        {"versionEndIncluding" : "3.7", "family" : "NPort"},
    "cpe:/o:moxa:nport_5150_firmware" :
        {"versionEndIncluding" : "3.7", "family" : "NPort"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
