#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(502258);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/31");

  script_cve_id("CVE-2024-2511");
  script_xref(name:"ICSA", value:"24-319-06");

  script_name(english:"Siemens SIMATIC S7-1500 Uncontrolled Resource Consumption (CVE-2024-2511)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Issue summary: Some non-default TLS server configurations can cause 
unbounded memory growth when processing TLSv1.3 sessions

Impact summary: An attacker may exploit certain server configurations to 
trigger unbounded memory growth that would lead to a Denial of 
Service.

This problem can occur in TLSv1.3 if the non-default 
SSL_OP_NO_TICKET option is being used (but not if early_data support 
is also configured and the default anti-replay protection is in use). 
In this case, under certain conditions, the session cache can get 
into an incorrect state and it will fail to flush properly as it 
fills. The session cache will continue to grow in an unbounded 
manner.

A malicious client could deliberately create the scenario for 
this failure to force a Denial of Service. It may also happen by 
accident in normal operation. This issue only affects TLS servers 
supporting TLSv1.3. It does not affect TLS clients. The FIPS modules 
in 3.2, 3.1 and 3.0 are not affected by this issue. OpenSSL 1.0.2 is 
also not affected by this issue. 

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/html/ssa-265688.html");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-24-319-06");
  script_set_attribute(attribute:"solution", value:
"Siemens has identified the following specific workarounds and mitigations that customers can apply to reduce the risk: 

- Only build and run applications from trusted sources 

Product-specific remediations or mitigations can be found in the section 'Affected Products and Solution' of 
the vendor advisory. 

For more information, see the associated Siemens security advisory in HTML and CSAF.");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-2511");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/04/14");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/06/03");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rm1224_lte%284g%29_eu_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rm1224_lte%284g%29_nam_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m804pb_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m812-1_adsl-router_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m816-1_adsl-router_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m826-2_shdsl-router_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m874-2_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m874-3_3g-router_%28cn%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m874-3_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-3_%28rok%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-3_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-4_%28eu%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-4_%28nam%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m876-4_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum853-1_%28a1%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum853-1_%28b1%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum853-1_%28eu%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum856-1_%28a1%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum856-1_%28b1%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum856-1_%28cn%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum856-1_%28eu%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_mum856-1_%28row%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_s615_eec_lan-router_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_s615_lan-router_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_tm_mfp");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_s7-1500_cpu_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
  "cpe:/o:siemens:simatic_s7-1500_cpu_firmware" :
    {"versionStartIncluding" : "3.1.0", "family" : "S71500", "orderNumbers" : ['6ES7518-4FX00-1AC0', '6ES7518-4AX00-1AC0', '6ES7518-4AX00-1AB0', '6ES7518-4FX00-1AB0']},
  "cpe:/o:siemens:siplus_s7-1500_cpu_firmware" :
    {"versionStartIncluding" : "3.1.0", "family" : "S71500", "orderNumbers" : ['6AG1518-4AX00-4AC0']},
  "cpe:/o:siemens:simatic_s7-1500_tm_mfp" :
    {"family" : "S71500", "orderNumbers": ["6ES7558-1AA00-0AB0"]},
  "cpe:/o:siemens:ruggedcom_rm1224_lte%284g%29_eu_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "RuggedCom", "orderNumbers" : ['6GK6108-4AM00-2BA2']},
  "cpe:/o:siemens:ruggedcom_rm1224_lte%284g%29_nam_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "RuggedCom", "orderNumbers" : ['6GK6108-4AM00-2DA2']},
  "cpe:/o:siemens:scalance_m804pb_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5804-0AP00-2AA2']},
  "cpe:/o:siemens:scalance_m812-1_adsl-router_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5812-1BA00-2AA2', '6GK5812-1AA00-2AA2']},
  "cpe:/o:siemens:scalance_m816-1_adsl-router_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5816-1AA00-2AA2', '6GK5816-1BA00-2AA2']},
  "cpe:/o:siemens:scalance_m826-2_shdsl-router_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5826-2AB00-2AB2']},
  "cpe:/o:siemens:scalance_m874-2_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5874-2AA00-2AA2']},
  "cpe:/o:siemens:scalance_m874-3_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5874-3AA00-2AA2']},
  "cpe:/o:siemens:scalance_m874-3_3g-router_%28cn%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5874-3AA00-2FA2']},
  "cpe:/o:siemens:scalance_m876-3_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-3AA02-2BA2']},
  "cpe:/o:siemens:scalance_m876-3_%28rok%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-3AA02-2EA2']},
  "cpe:/o:siemens:scalance_m876-4_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-4AA10-2BA2']},
  "cpe:/o:siemens:scalance_m876-4_%28eu%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-4AA00-2BA2']},
  "cpe:/o:siemens:scalance_m876-4_%28nam%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5876-4AA00-2DA2']},
  "cpe:/o:siemens:scalance_mum853-1_%28a1%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5853-2EA10-2AA1']},
  "cpe:/o:siemens:scalance_mum853-1_%28b1%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5853-2EA10-2BA1']},
  "cpe:/o:siemens:scalance_mum853-1_%28eu%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5853-2EA00-2DA1']},
  "cpe:/o:siemens:scalance_mum856-1_%28a1%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5856-2EA10-3AA1']},
  "cpe:/o:siemens:scalance_mum856-1_%28b1%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5856-2EA10-3BA1']},
  "cpe:/o:siemens:scalance_mum856-1_%28cn%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5856-2EA00-3FA1']},
  "cpe:/o:siemens:scalance_mum856-1_%28eu%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5856-2EA00-3DA1']},
  "cpe:/o:siemens:scalance_mum856-1_%28row%29_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCEM", "orderNumbers" : ['6GK5856-2EA00-3AA1']},
  "cpe:/o:siemens:scalance_s615_eec_lan-router_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCES", "orderNumbers" : ['6GK5615-0AA01-2AA2']},
  "cpe:/o:siemens:scalance_s615_lan-router_firmware" :
    {"versionEndExcluding" : "8.2", "family" : "SCALANCES", "orderNumbers" : ['6GK5615-0AA00-2AA2']}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_NOTE);
