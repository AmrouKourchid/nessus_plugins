#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502357);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2024-3036");
  script_xref(name:"ICSA", value:"24-177-01");

  script_name(english:"ABB 800xA CSLib communication Denial of Service (CVE-2024-3036)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Improper Input Validation vulnerability in ABB 800xA Base. An attacker
who successfully exploited this vulnerability could cause services to
crash by sending specifically crafted messages. This issue affects
800xA Base: from 6.0.0 through 6.1.1-2.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://search.abb.com/library/Download.aspx?DocumentID=7PAA013309&LanguageCode=en&DocumentPartId=&Action=Launch
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?db120e9c");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-24-177-01");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

ABB recommends updating to an active product version to obtain the latest corrections. The problem is or will be corrected
in the following product versions:

- ABB 800xA Base 6.2.0-0 (part of System 800xA 6.2.0.0)
- ABB 800xA Base 6.1.1-3 (part of System 800xA 6.1.1.2)
- ABB 800xA Base 6.0.3-x (included in next revision)

For more information, please refer to ABB's Cybersecurity Advisory 7PAA013309.");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-3036");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/06/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/06/19");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/08/08");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:abb:800xa_base_system:6.0.x");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:abb:800xa_base_system:6.1.x");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/ABB");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/ABB');

var asset = tenable_ot::assets::get(vendor:'ABB');

var vuln_cpes = {
    "cpe:/a:abb:800xa_base_system:6.0.x" :
        {"versionEndExcluding" : "6.0.3.5", "versionStartIncluding": "6.0.0.0", "family" : "Abb800xA"},
    "cpe:/a:abb:800xa_base_system:6.1.x" :
        {"versionEndExcluding" : "6.1.1.2", "versionStartIncluding": "6.1.0.0", "family" : "Abb800xA"},
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
