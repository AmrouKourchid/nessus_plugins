#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501396);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2019-1599");

  script_name(english:"Cisco NX-OS Software Netstack Denial of Service (CVE-2019-1599)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the network stack of Cisco NX-OS Software could
allow an unauthenticated, remote attacker to cause a denial of service
(DoS) condition on the affected device. The vulnerability is due to an
issue with allocating and freeing memory buffers in the network stack.
An attacker could exploit this vulnerability by sending crafted TCP
streams to an affected device in a sustained way. A successful exploit
could cause the network stack of an affected device to run out of
available buffers, impairing operations of control plane and
management plane protocols, resulting in a DoS condition. Note: This
vulnerability can be triggered only by traffic that is destined to an
affected device and cannot be exploited using traffic that transits an
affected device. Nexus 1000V Switch for Microsoft Hyper-V is affected
in versions prior to 5.2(1)SM3(2.1). Nexus 1000V Switch for VMware
vSphere is affected in versions prior to 5.2(1)SV3(4.1a). Nexus 3000
Series Switches are affected in versions prior to 7.0(3)I7(6) and
9.2(2). Nexus 3500 Platform Switches are affected in versions prior to
6.0(2)A8(11), 7.0(3)I7(6), and 9.2(2). Nexus 3600 Platform Switches
are affected in versions prior to 7.0(3)F3(5) and 9.2(2). Nexus 5500,
5600, and 6000 Series Switches are affected in versions prior to
7.1(5)N1(1b) and 7.3(5)N1(1). Nexus 7000 and 7700 Series Switches are
affected in versions prior to 6.2(22. Nexus 9500 R-Series Line Cards
and Fabric Modules are affected in versions prior to 7.0(3)F3(5) and
9.2(2). UCS 6200 and 6300 Series Fabric Interconnect are affected in
versions prior to 3.2(3j) and 4.0(2a). UCS 6400 Series Fabric
Interconnect are affected in versions prior to 4.0(2a).

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/107342");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190306-nxos-netstack
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?afa8810a");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-1599");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(770);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/03/07");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/03/07");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:3");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:9");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:9.2%282%29" :
        {"versionEndExcluding" : "9.2%282%29", "versionStartIncluding" : "9.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7%285%29" :
        {"versionEndExcluding" : "7.0%283%29i7%285%29", "versionStartIncluding" : "7.0%283%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29f3%285%29" :
        {"versionEndExcluding" : "7.0%283%29f3%285%29", "versionStartIncluding" : "7.0%283%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%285%29n1%281%29" :
        {"versionEndExcluding" : "7.3%285%29n1%281%29", "versionStartIncluding" : "7.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.3%282%29" :
        {"versionEndExcluding" : "8.3%282%29", "versionStartIncluding" : "8.3", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29a8%2811%29" :
        {"versionEndExcluding" : "6.0%282%29a8%2811%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.2%2822%29" :
        {"versionEndExcluding" : "6.2%2822%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7%286%29" :
        {"versionEndExcluding" : "7.0%283%29i7%286%29", "versionStartIncluding" : "7.0%283%29i5", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:5.2%281%29sm3%282.1%29" :
        {"versionEndExcluding" : "5.2%281%29sm3%282.1%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:5.2%281%29sv3%284.1a%29" :
        {"versionEndExcluding" : "5.2%281%29sv3%284.1a%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:4.0%282a%29" :
        {"versionEndExcluding" : "4.0%282a%29", "versionStartIncluding" : "4.0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:3.2%283j%29" :
        {"versionEndExcluding" : "3.2%283j%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i4%289%29" :
        {"versionEndExcluding" : "7.0%283%29i4%289%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%285%29n1%281b%29" :
        {"versionEndExcluding" : "7.1%285%29n1%281b%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.2%283%29" :
        {"versionEndExcluding" : "8.2%283%29", "versionStartIncluding" : "8.0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%283%29d1%281%29" :
        {"versionEndExcluding" : "7.3%283%29d1%281%29", "versionStartIncluding" : "7.2", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
