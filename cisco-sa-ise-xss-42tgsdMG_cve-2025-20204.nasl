#TRUSTED 64205be21916400888a4b80bbf41ee4e86846893aa6c5277e71b27a3da9f62c2ab136d2efda4207ed0c843421d2e0c75c3321c93af8ed34ae31aa4e2d3e7884c7dc017f84f551f8ffdee820c9743020e2836999053b6e44495eef64a70f3c62b99a704bc03598365a43b366311485bb467cb8a89a15cf110cc2487430d1a07a7bfb97f07396b1d5041209637ad60e1106f193d1fc12764265d65cdff0de7661aff7d4bcc30f42eab9be98c5b8b6afa505769175934135e30c440d13a55676a0fc4c8f4a887f318672b6aceaa8661c00c9436116cb70ac67a72c3e3e22815d9f2a105f2bc0272c0f4114d3b897eb293004b8892c72866304649d9fa201309d2b7d4be6525f688eba27f1bb654b8707825dea0565b27fd8e6cb19565792f5b35e8e9e365bed2e5c0f7864da36ecf17598507e3ceef91690c17db282571fb2468580e97293f080b57ee8ea430ca4393fbdd3feca34806381dfad9068ff98bc468f2b15943e3ee0a5752a79ec82ed23f0b82475c1f0c772dba7281bf59fdd9f394ce180b3860a4be9fc000700997f798c67ecf19b5583bf74d0fd425c33a7dfd901aaceb0f02958a97750d96c2641f909626fb626c908c9c4103bcc7b50bee7e474d22b0282cf705aa3fe20f078d760ea7ae4dd42a1d778052a2df9880fc932d2e82123f3b34c69dab6223a75ee119e707997768f9db4b41d91a55cf880ac15e5855
#TRUST-RSA-SHA256 3e8477a2761afcc598af94ce39bc419e9c67ab0853b564fb81fedd81cec9f18fd36108f7cdec8daf692c1494e61863018e26b9615cc7392f9ec5e450274f360ff0b716f8ee35d05961a51d633c5c7e8e82441675a157f09b01b2a461ee1c32b84de90ec60f8f0ab4a7f9f6f4c73831bac3d81ac72b77d43115618683110f1f3a6dcdb7d9e14b59af96e76991d47d54d818cc34d5699c397f18cced3b74eb1747505b42b282955c3310e06f6b9dc03b94da84c24cc30fd11e5fdcb09c8dd21358e5597fed179c2a870a611230b882bd0e2823aab846a4b35b33dfe2214856b848d89a1e9b265fc953f997873bc33f1d0c3991680ab88e05c739b6f2da01ccda94753b9eda006222db3c7e095b19992db37b94d5460cb0953b80a92479a8d6d30e9fa8aa895a9f651f3d5dc09f5f7a0fff414f34066f97d9d4dbb5c5ada5ea4ad8118488d2cb8c9edb9c0a5defeac8babbf0f686fa0d81aedacf5d780cc83b3dfd4ac1b4828fc835f2cedda3b0d5a3fbde241172574795546a3d1e40f493d7e07f2d7dbce9b40b8f1126d10d7c21dd921cb44e30eb8e5453c1f699a300b9495459b825092b6530102a582ec41354d9f8b7f5c1623ded7d52198990a38c37da28892497b01772904ab22a7a19713979074d36119bbb10c6a9298082f63ea51bb5be600dd094f37dbf89a0bd5d4c638dd75b21030c27b7ae0e17093661c59ef0db40
#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(215122);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/07");

  script_cve_id("CVE-2025-20204");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwj04202");
  script_xref(name:"CISCO-SA", value:"cisco-sa-ise-xss-42tgsdMG");

  script_name(english:"Cisco Identity Services Engine Stored XSS Vulnerabilities (cisco-sa-ise-xss-42tgsdMG - CVE-2025-20204)");

  script_set_attribute(attribute:"synopsis", value:
"The remote device is missing a vendor-supplied security patch.");
  script_set_attribute(attribute:"description", value:
"According to its self-reported version, Cisco Identity Services Engine Stored Cross-Site Scripting Vulnerabilities is
affected by a vulnerability:

  - A vulnerability in the web-based management interface of Cisco Identity Services Engine (ISE) could allow
    an authenticated, remote attacker to conduct cross-site scripting (XSS) attacks against a user of the
    interface. This vulnerability is due to insufficient validation of user-supplied input by the web-
    based management interface of an affected system. An attacker could exploit this vulnerability by
    injecting malicious code into specific pages of the interface. A successful exploit could allow the
    attacker to execute arbitrary script code in the context of the affected interface or access sensitive,
    browser-based information. To exploit this vulnerability, the attacker must have valid administrative
    credentials. (CVE-2025-20204)

Please see the included Cisco BID and Cisco Security Advisory for more information.");
  # https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-xss-42tgsdMG
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?e2070210");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj04202");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the relevant fixed version referenced in Cisco bug IDs CSCwj04202");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:M/C:P/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2025-20204");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(79);

  script_set_attribute(attribute:"vuln_publication_date", value:"2025/02/05");
  script_set_attribute(attribute:"patch_publication_date", value:"2025/02/05");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/02/07");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:cisco:identity_services_engine");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:cisco:identity_services_engine");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:cisco:identity_services_engine_software");
  script_set_attribute(attribute:"stig_severity", value:"I");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CISCO");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("cisco_ise_detect.nbin");
  script_require_keys("Host/Cisco/ISE/version");

  exit(0);
}

include('ccf.inc');
include('cisco_ise_func.inc');

var product_info = cisco::get_product_info(name:'Cisco Identity Services Engine Software');

var vuln_ranges = [
  {'min_ver':'3.0', 'fix_ver':'3.2.0.542', required_patch:'8'},
  {'min_ver':'3.3', 'fix_ver':'3.3.0.430', required_patch:'3'},
  {'min_ver':'3.4', 'fix_ver':'3.4.0.608', required_patch:'1'},
];

var required_patch = get_required_patch(vuln_ranges:vuln_ranges, version:product_info['version']);

var reporting = make_array(
  'port'          , 0,
  'severity'      , SECURITY_WARNING,
  'version'       , product_info['version'],
  'flags'         , {'xss':TRUE},
  'bug_id'        , 'CSCwj04202',
  'disable_caveat', TRUE
);

cisco::check_and_report(
  product_info:product_info,
  reporting:reporting,
  vuln_ranges:vuln_ranges,
  required_patch:required_patch
);
