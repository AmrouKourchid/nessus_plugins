#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501062);
  script_version("1.6");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/10");

  script_cve_id("CVE-2021-37182");
  script_xref(name:"ICSA", value:"22-167-10");

  script_name(english:"Siemens SCALANCE XM-400 and XR-500 Improper Validation of Integrity Check Value (CVE-2021-37182)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in SCALANCE XM408-4C (All versions
< V6.5), SCALANCE XM408-4C (L3 int.) (All versions < V6.5), SCALANCE
XM408-8C (All versions < V6.5), SCALANCE XM408-8C (L3 int.) (All
versions < V6.5), SCALANCE XM416-4C (All versions < V6.5), SCALANCE
XM416-4C (L3 int.) (All versions < V6.5), SCALANCE XR524-8C, 1x230V
(All versions < V6.5), SCALANCE XR524-8C, 1x230V (L3 int.) (All
versions < V6.5), SCALANCE XR524-8C, 24V (All versions < V6.5),
SCALANCE XR524-8C, 24V (L3 int.) (All versions < V6.5), SCALANCE
XR524-8C, 2x230V (All versions < V6.5), SCALANCE XR524-8C, 2x230V (L3
int.) (All versions < V6.5), SCALANCE XR526-8C, 1x230V (All versions <
V6.5), SCALANCE XR526-8C, 1x230V (L3 int.) (All versions < V6.5),
SCALANCE XR526-8C, 24V (All versions < V6.5), SCALANCE XR526-8C, 24V
(L3 int.) (All versions < V6.5), SCALANCE XR526-8C, 2x230V (All
versions < V6.5), SCALANCE XR526-8C, 2x230V (L3 int.) (All versions <
V6.5), SCALANCE XR528-6M (All versions < V6.5), SCALANCE XR528-6M
(2HR2) (All versions < V6.5), SCALANCE XR528-6M (2HR2, L3 int.) (All
versions < V6.5), SCALANCE XR528-6M (L3 int.) (All versions < V6.5),
SCALANCE XR552-12M (All versions < V6.5), SCALANCE XR552-12M (2HR2)
(All versions < V6.5), SCALANCE XR552-12M (2HR2) (All versions <
V6.5), SCALANCE XR552-12M (2HR2, L3 int.) (All versions < V6.5). The
OSPF protocol implementation in affected devices fails to verify the
checksum and length fields in the OSPF LS Update messages. An
unauthenticated remote attacker could exploit this vulnerability to
cause interruptions in the network by sending specially crafted OSPF
packets. Successful exploitation requires OSPF to be enabled on an
affected device.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-145224.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-22-167-10");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

For all affected products, Siemens recommends updating to v6.5 or later.

Siemens has identified the following specific workarounds and mitigations users can apply to reduce the risk:

- Disable OSPF in the layer 3 configuration menu (note OSPF is disabled by default). The vulnerability is not
exploitable when OSPF is disabled.
- If OSPF is used, set a password for the OSPF interface, and enable MD5 authentication.

As a general security measure, Siemens recommends protecting network access to devices with appropriate mechanisms. To
operate the devices in a protected IT environment, Siemens recommends configuring the environment according to Siemensâ€™
operational guidelines for industrial security and following recommendations in the product manuals.

Additional information on industrial security by Siemens can be found on the Siemens industrial security webpage.

For more information see Siemens Security Advisory SSA-145224");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-37182");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(354);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/06/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/06/14");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/04/11");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xm408-4c_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xm408-4c_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xm408-8c_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xm408-8c_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xm416-4c_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xm416-4c_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr524-8c%2c_1x230v_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr524-8c%2c_1x230v_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr524-8c%2c_24v_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr524-8c%2c_24v_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr524-8c%2c_2x230v_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr524-8c%2c_2x230v_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr526-8c%2c_1x230v_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr526-8c%2c_1x230v_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr526-8c%2c_24v_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr526-8c%2c_24v_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr526-8c%2c_2x230v_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr526-8c%2c_2x230v_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr528-6m_%282hr2%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr528-6m_%282hr2%2c_l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr528-6m_%28l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr528-6m_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr552-12m_%282hr2%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr552-12m_%282hr2%2c_l3_int.%29_firmware:6.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xr552-12m_firmware:6.5");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:scalance_xm408-4c_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX400", "orderNumbers" : ['6GK5408-4GP00-2AM2']},
    "cpe:/o:siemens:scalance_xm408-4c_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX400", "orderNumbers" : ['6GK5408-4GQ00-2AM2']},
    "cpe:/o:siemens:scalance_xm408-8c_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX400", "orderNumbers" : ['6GK5408-8GS00-2AM2']},
    "cpe:/o:siemens:scalance_xm408-8c_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX400", "orderNumbers" : ['6GK5408-8GR00-2AM2']},
    "cpe:/o:siemens:scalance_xm416-4c_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX400", "orderNumbers" : ['6GK5416-4GS00-2AM2']},
    "cpe:/o:siemens:scalance_xm416-4c_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX400", "orderNumbers" : ['6GK5416-4GR00-2AM2']},
    "cpe:/o:siemens:scalance_xr524-8c%2c_1x230v_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5524-8GS00-3AR2']},
    "cpe:/o:siemens:scalance_xr524-8c%2c_1x230v_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5524-8GR00-3AR2']},
    "cpe:/o:siemens:scalance_xr524-8c%2c_2x230v_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5524-8GS00-4AR2']},
    "cpe:/o:siemens:scalance_xr524-8c%2c_2x230v_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5524-8GR00-4AR2']},
    "cpe:/o:siemens:scalance_xr524-8c%2c_24v_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5524-8GS00-2AR2']},
    "cpe:/o:siemens:scalance_xr524-8c%2c_24v_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5524-8GR00-2AR2']},
    "cpe:/o:siemens:scalance_xr526-8c%2c_1x230v_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5526-8GS00-3AR2']},
    "cpe:/o:siemens:scalance_xr526-8c%2c_1x230v_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5526-8GR00-3AR2']},
    "cpe:/o:siemens:scalance_xr526-8c%2c_2x230v_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5526-8GS00-4AR2']},
    "cpe:/o:siemens:scalance_xr526-8c%2c_2x230v_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5526-8GR00-4AR2']},
    "cpe:/o:siemens:scalance_xr526-8c%2c_24v_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5526-8GS00-2AR2']},
    "cpe:/o:siemens:scalance_xr526-8c%2c_24v_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5526-8GR00-2AR2']},
    "cpe:/o:siemens:scalance_xr528-6m_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5528-0AA00-2AR2']},
    "cpe:/o:siemens:scalance_xr528-6m_%282hr2%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5528-0AA00-2HR2']},
    "cpe:/o:siemens:scalance_xr528-6m_%282hr2%2c_l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5528-0AR00-2HR2']},
    "cpe:/o:siemens:scalance_xr528-6m_%28l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5528-0AR00-2AR2']},
    "cpe:/o:siemens:scalance_xr552-12m_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5552-0AA00-2AR2']},
    "cpe:/o:siemens:scalance_xr552-12m_%282hr2%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5552-0AR00-2HR2', '6GK5552-0AA00-2HR2']},
    "cpe:/o:siemens:scalance_xr552-12m_%282hr2%2c_l3_int.%29_firmware:6.5" :
        {"versionEndExcluding" : "6.5", "family" : "SCALANCEX500", "orderNumbers" : ['6GK5552-0AR00-2AR2']}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
