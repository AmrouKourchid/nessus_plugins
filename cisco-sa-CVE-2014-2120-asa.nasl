#TRUSTED 820d37019e02d520e200865b025a02174b292a31b42c899e10425dee0c116d9f6836ea6bde0aadd42c41dd847f075605be11079926b0a35744bbfd1d1a9029db4e20f2ea4b4660a488921aeb9259104b7734c3f9cf6866d98de02a052d615a658a995e07123e27708cbb480c7bda6f756de25a8c4cee45e3936b1f3d6b7c8ac8552a57e5ce830a83d1354a43d71e72ed0cd1d78656a90f4ab1db32593997427b4815f13ff37e9403fccf0b43e003596f39407306d84084dbede4150c2363abf8ef5ab70b616b792a31d99a88c1cc91eeee2b3f407430921bf20fcc5e7cbbbb92537f8a02c9bba7a482d6bb66eb13f5fa551680fec00175eddbf8a9594a1cbc6c2e9dc654a26f745207b8781a5373edd74406f27e7ef6eca0c7fdc5e39961327b6361d57289aa9d3368cbf74a49bd34c3c87b0373eca780abcad232d2d5d272cd226844da6b7754d07c1c0f19e3ef703a376966ba2fedb2a1c316ed843e9a330b2240365c36be4ed695802ec34888a897e5c0ad5d7e3a1711e22c237dcfe385f6221797e5a713bc7b45bdbec81c125acd710abe4ed76d36271ab0370cf775b321f4252927b5e52aa5ccfa7b75178065cee67e5c0dbaf72a6127d02486aba1e089d2ebfb72e984b678e2757c46571d37f6b50a486469fb92e95a6698e8aa9c11768912c5e0152858a2b7ec514ba141c08cc6a6fb37ea50894c78fa789c2556902f
#TRUST-RSA-SHA256 342c33728f3bae66a63643bd470a27c926f69280a74739f7d6e7bfbe9a194b7616e69e32c3273d9e4749d0e4d722094cb5a1e7492f55877d8d6c29452e0bfb65b1f2910479d05a09a2131ad601c6d3d46c4fba078fbe8a79e897206a0fef15402592099f50e7c73cc14ccf573c0404de0343f1a0f659777ab284a348b56d984e5b6c17c55159f56545c8ee1018eefa10c433a8941d760b752f9e61c9abf4eac2f4c40b7481855a0df376eef21a528e0bbf71cead5d4720e01cda77343fadb8bfdffba5d1e572b22220500fc0989f2f0506118be7c5f07fa9033652f0803d6a6c84d25b865300785ea09a1c1aadf697964de804f3cc9bb7f6df9cabcd67f7578746d86f93034731500d9808034e96dd7dcf6f636e371bca51fdd6cdcc4a073e8442de6fa985d6960f3114840ffc112aab4fc89034d9219c0d2029271eba20473aac2009f079f17ef4bd6c3c21ab030e3435bda100cee52d8e7b2af144e4e7daa093310b96cc104b53368dff1e63c810c20e80a41251fd69f3de594f6c798e6c51298e1c09f576d917164e65f33f7d11731a4f769b9fc160660d3afcff7d1809d86ee59d7b2e44c61d87f47dfe6dc281b078b39a9dfbace8b76ecd470287eb98d2583c887dc25a6ba7195b52a110fa091189b98948f83a56e8382d274cb631d11a686d0af61ac313e1c91f961fe85356bdfae7235ab4e7bc1fb3c7ce5d0bb56074
#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(213167);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/19");

  script_cve_id("CVE-2014-2120");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2024/12/03");
  script_xref(name:"CISCO-BUG-ID", value:"CSCun19025");
  script_xref(name:"CISCO-SA", value:"cisco-sa-CVE-2014-2120");

  script_name(english:"Cisco Adaptive Security Appliance WebVPN Login Page XSS (cisco-sa-CVE-2014-2120)");

  script_set_attribute(attribute:"synopsis", value:
"The remote device is missing a vendor-supplied security patch");
  script_set_attribute(attribute:"description", value:
"According to its self-reported version, Cisco Adaptive Security Appliance (ASA) Software is affected by a vulnerability.

  - Cross-site scripting (XSS) vulnerability in the WebVPN login page in Cisco Adaptive Security Appliance
    (ASA) Software allows remote attackers to inject arbitrary web script or HTML via an unspecified
    parameter, aka Bug ID CSCun19025. (CVE-2014-2120)

Please see the included Cisco BIDs and Cisco Security Advisory for more information.");
  # https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-CVE-2014-2120
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?20c09aa3");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCun19025");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the relevant fixed version referenced in Cisco bug ID CSCun19025");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2014-2120");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(79);

  script_set_attribute(attribute:"vuln_publication_date", value:"2014/03/18");
  script_set_attribute(attribute:"patch_publication_date", value:"2014/03/18");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/12/18");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:cisco:adaptive_security_appliance_software");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CISCO");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("ssh_get_info.nasl");
  script_require_keys("Host/Cisco/ASA/model");

  exit(0);
}

include('ccf.inc');

var product_info = cisco::get_product_info(name:'Cisco Adaptive Security Appliance (ASA) Software');
var model = product_info['model'];

if (model !~ "(FPR-?|Firepower)\s*(1[0-9]{3}|1K|21[0-9]{2}|2K|41[0-9]{2}|4K|93[0-9]{2}|9K)"
    && model !~ "ISA3[0-9]{3}" && model !~ "ASA55[0-9]{2}-X")
  audit(AUDIT_HOST_NOT, 'an affected model');

var vuln_versions = [
  '8.0.1.2',
  '8.0.2',
  '8.0.2.11',
  '8.0.2.15',
  '8.0.3',
  '8.0.3.6',
  '8.0.3.12',
  '8.0.3.19',
  '8.0.4',
  '8.0.4.3',
  '8.0.4.9',
  '8.0.4.16',
  '8.0.4.23',
  '8.0.4.25',
  '8.0.4.28',
  '8.0.4.31',
  '8.0.4.32',
  '8.0.4.33',
  '8.0.5',
  '8.0.5.20',
  '8.0.5.23',
  '8.0.5.25',
  '8.0.5.27',
  '8.0.5.28',
  '8.0.5.31',
  '8.1.1',
  '8.1.1.6',
  '8.1.2',
  '8.1.2.13',
  '8.1.2.15',
  '8.1.2.16',
  '8.1.2.19',
  '8.1.2.23',
  '8.1.2.24',
  '8.1.2.49',
  '8.1.2.50',
  '8.1.2.55',
  '8.1.2.56',
  '8.2.0.45',
  '8.2.1',
  '8.2.1.11',
  '8.2.2',
  '8.2.2.9',
  '8.2.2.10',
  '8.2.2.12',
  '8.2.2.16',
  '8.2.2.17',
  '8.2.3',
  '8.2.4',
  '8.2.4.1',
  '8.2.4.4',
  '8.2.5',
  '8.2.5.13',
  '8.2.5.22',
  '8.2.5.26',
  '8.2.5.33',
  '8.2.5.40',
  '8.2.5.41',
  '8.2.5.46',
  '8.3.1',
  '8.3.1.1',
  '8.3.1.4',
  '8.3.1.6',
  '8.3.2',
  '8.3.2.4',
  '8.3.2.13',
  '8.3.2.23',
  '8.3.2.25',
  '8.3.2.31',
  '8.3.2.33',
  '8.3.2.34',
  '8.3.2.37',
  '8.3.2.39',
  '8.4.1',
  '8.4.1.3',
  '8.4.1.11',
  '8.4.2',
  '8.4.2.1',
  '8.4.2.8',
  '8.4.3',
  '8.4.3.8',
  '8.4.3.9',
  '8.4.4',
  '8.4.4.1',
  '8.4.4.3',
  '8.4.4.5',
  '8.4.4.9',
  '8.4.5',
  '8.4.5.6',
  '8.4.6',
  '8.4.7',
  '9.0.1',
  '9.0.2',
  '9.0.2.10',
  '9.0.3',
  '9.0.3.6',
  '9.1.1',
  '9.1.1.4',
  '9.1.2',
  '9.1.2.8',
  '9.1.3'
];

var reporting = make_array(
  'port'          , 0,
  'severity'      , SECURITY_WARNING,
  'version'       , product_info['version'],
  'flags'         , {'xss':TRUE},
  'bug_id'        , 'CSCun19025',
  'disable_caveat', TRUE
);

cisco::check_and_report(
  product_info:product_info,
  reporting:reporting,
  vuln_versions:vuln_versions
);
