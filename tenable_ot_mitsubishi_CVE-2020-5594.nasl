#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500501);
  script_version("1.10");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2020-5594");
  script_xref(name:"ICSA", value:"20-175-01");

  script_name(english:"Mitsubishi Electric MELSEC iQ-R, iQ-F, Q, L and FX Series CPU Modules Cleartext Transmission of Sensitive Information (CVE-2020-5594)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Mitsubishi Electric MELSEC iQ-R, iQ-F, Q, L, and FX series CPU modules all versions contain a vulnerability that allows
cleartext transmission of sensitive information between CPU modules and GX Works3 and/or GX Works2 via unspecified
vectors.  

This plugin only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more
information.");
  script_set_attribute(attribute:"see_also", value:"https://jvn.jp/en/vu/JVNVU91424496/index.html");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-20-175-01");
  # https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2020-003.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?6eeb5066");
  # https://www.mitsubishielectric.com/en/psirt/vulnerability/pdf/2020-003_en.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?3c743bfe");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Mitsubishi Electric recommends encrypting the communication path by setting up a VPN to mitigate the impact of this
vulnerability.

Additional information about the vulnerability is available by contacting a Mitsubishi Electric
representative.https://us.mitsubishielectric.com/fa/en/about-us/distributors");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2020-5594");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(319);

  script_set_attribute(attribute:"vuln_publication_date", value:"2020/06/23");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/06/23");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-f_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec-q_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec-l_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec-fx_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Mitsubishi");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Mitsubishi');

var asset = tenable_ot::assets::get(vendor:'Mitsubishi');

var vuln_cpes = {
    "cpe:/o:mitsubishielectric:melsec_iq-r_firmware" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-f_firmware" :
        {"family" : "MELSECiQF"},
    "cpe:/o:mitsubishielectric:melsec-q_firmware" :
        {"family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec-l_firmware" :
        {"family" : "MELSECL"},
    "cpe:/o:mitsubishielectric:melsec-fx_firmware" :
        {"family" : "MELSECF"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
