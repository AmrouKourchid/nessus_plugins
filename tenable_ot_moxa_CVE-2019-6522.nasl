#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501507);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2019-6522");
  script_xref(name:"ICSA", value:"19-057-01");

  script_name(english:"Moxa IKS, EDS Out-of-Bounds Read (CVE-2019-6522)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Moxa IKS and EDS fails to properly check array bounds which may allow
an attacker to read device memory on arbitrary addresses, and may
allow an attacker to retrieve sensitive data or cause device reboot.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://ics-cert.us-cert.gov/advisories/ICSA-19-057-01");
  script_set_attribute(attribute:"solution", value:
'The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Moxa recommends users implement the following measures to mitigate these vulnerabilities.

- Install firmware patch. Patches may be requested from Moxa Customer Service (login required):
- Set EDS series Web configuration as "https only” to reduce predictable session ID concern.

Please see Moxa’s security advisory for more information.');
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-6522");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(125);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/03/05");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/03/05");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/08/02");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-405a_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-408a_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:eds-510a_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:iks-g6824a_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Moxa");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Moxa');

var asset = tenable_ot::assets::get(vendor:'Moxa');

var vuln_cpes = {
    "cpe:/o:moxa:iks-g6824a_firmware" :
        {"versionEndIncluding" : "5.6", "family" : "IKS"},
    "cpe:/o:moxa:eds-405a_firmware" :
        {"versionEndIncluding" : "3.8", "family" : "MoxaEDS"},
    "cpe:/o:moxa:eds-408a_firmware" :
        {"versionEndIncluding" : "3.8", "family" : "MoxaEDS"},
    "cpe:/o:moxa:eds-510a_firmware" :
        {"versionEndIncluding" : "3.8", "family" : "MoxaEDS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
