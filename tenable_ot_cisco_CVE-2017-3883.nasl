#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501393);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2017-3883");

  script_name(english:"Cisco FXOS and NX-OS System Software Authentication, Authorization, and Accounting Denial of Service (CVE-2017-3883)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the authentication, authorization, and accounting
(AAA) implementation of Cisco Firepower Extensible Operating System
(FXOS) and NX-OS System Software could allow an unauthenticated,
remote attacker to cause an affected device to reload. The
vulnerability occurs because AAA processes prevent the NX-OS System
Manager from receiving keepalive messages when an affected device
receives a high rate of login attempts, such as in a brute-force login
attack. System memory can run low on the FXOS devices under the same
conditions, which could cause the AAA process to unexpectedly restart
or cause the device to reload. An attacker could exploit this
vulnerability by performing a brute-force login attack against a
device that is configured with AAA security services. A successful
exploit could allow the attacker to cause the affected device to
reload. This vulnerability affects the following Cisco products if
they are running Cisco FXOS or NX-OS System Software that is
configured for AAA services: Firepower 4100 Series Next-Generation
Firewall, Firepower 9300 Security Appliance, Multilayer Director
Switches, Nexus 1000V Series Switches, Nexus 1100 Series Cloud
Services Platforms, Nexus 2000 Series Switches, Nexus 3000 Series
Switches, Nexus 3500 Platform Switches, Nexus 5000 Series Switches,
Nexus 5500 Platform Switches, Nexus 5600 Platform Switches, Nexus 6000
Series Switches, Nexus 7000 Series Switches, Nexus 7700 Series
Switches, Nexus 9000 Series Switches in NX-OS mode, Nexus 9500
R-Series Line Cards and Fabric Modules, Unified Computing System (UCS)
6100 Series Fabric Interconnects, UCS 6200 Series Fabric
Interconnects, UCS 6300 Series Fabric Interconnects. Cisco Bug IDs:
CSCuq58760, CSCuq71257, CSCur97432, CSCus05214, CSCux54898,
CSCvc33141, CSCvd36971, CSCve03660.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20171018-aaavty
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b71cc502");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1039614");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/101493");
  # https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbst03846en_us
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?38892564");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-3883");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(770);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/10/19");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/10/19");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:2.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:3.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:3.1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:3.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.3");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i3%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.1%280.1%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.3");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.2");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:5.2" :
        {"versionEndIncluding" : "5.2", "versionStartIncluding" : "5.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.2" :
        {"versionEndIncluding" : "6.2", "versionStartIncluding" : "6.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.3" :
        {"versionEndIncluding" : "6.3", "versionStartIncluding" : "6.3", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3" :
        {"versionEndIncluding" : "7.3", "versionStartIncluding" : "7.3", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1" :
        {"versionEndIncluding" : "8.1", "versionStartIncluding" : "8.1", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.2" :
        {"versionEndIncluding" : "8.2", "versionStartIncluding" : "8.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:4" :
        {"versionEndIncluding" : "4.1", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6" :
        {"versionEndIncluding" : "6.0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0" :
        {"versionEndIncluding" : "7.0", "versionStartIncluding" : "7.0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i3%281%29" :
        {"versionEndIncluding" : "7.0%283%29i3%281%29", "versionStartIncluding" : "7.0%283%29i3%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:5" :
        {"versionEndIncluding" : "5.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.1%280.1%29" :
        {"versionEndIncluding" : "7.1%280.1%29", "versionStartIncluding" : "7.1%280.1%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.1" :
        {"versionEndIncluding" : "6.1", "versionStartIncluding" : "6.1", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:2" :
        {"versionEndIncluding" : "2.2", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:2.5" :
        {"versionEndIncluding" : "2.5", "versionStartIncluding" : "2.5", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:3.0" :
        {"versionEndIncluding" : "3.0", "versionStartIncluding" : "3.0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:3.1" :
        {"versionEndIncluding" : "3.1", "versionStartIncluding" : "3.1", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:3.2" :
        {"versionEndIncluding" : "3.2", "versionStartIncluding" : "3.2", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
