#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501665);
  script_version("1.6");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2020-7593");
  script_xref(name:"ICSA", value:"20-196-08");

  script_name(english:"Siemens LOGO! Web Server Buffer Copy Without Checking Size of Input (CVE-2020-7593)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in LOGO! 8 BM (incl. SIPLUS
variants) (V1.81.01 - V1.81.03), LOGO! 8 BM (incl. SIPLUS variants)
(V1.82.01), LOGO! 8 BM (incl. SIPLUS variants) (V1.82.02). A buffer
overflow vulnerability exists in the Web Server functionality of the
device. A remote unauthenticated attacker could send a specially
crafted HTTP request to cause a memory corruption, potentially
resulting in remote code execution.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-573753.pdf");
  # https://www.talosintelligence.com/vulnerability_reports/TALOS-2020-1069
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?604f9512");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-20-196-08");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens recommends affected users update to the following versions:

LOGO! 8 BM (incl.SIPLUS varriants):

- Versions between 1.81.01 and 1.81.03: Update to v1.81.04
- Version 1.82.01: Update to v1.82.03
- Version 1.82.02: Update to v1.82.04

Siemens recommends applying defense-in-depth concepts, including the protection concept outlined in the system manual.

Siemens recommends following their general security recommendations. As a general security measure, Siemens strongly
recommends protecting network access to devices with appropriate mechanisms. To operate the devices in a protected IT
environment, Siemens recommends configuring the environment according to the Siemens operational guidelines for
Industrial Security and following the recommendations in the product manuals.

For additional information, please refer to Siemens Security Advisory SSA-573753.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:POC/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2020-7593");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(120);

  script_set_attribute(attribute:"vuln_publication_date", value:"2020/07/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/07/14");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/09/21");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_8_bm_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_8_bm_firmware:1.82.01");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_8_bm_firmware:1.82.02");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:logo%21_8_bm_firmware" :
        {"versionEndIncluding" : "1.81.03", "versionStartIncluding" : "1.81.01", "family" : "LOGO!BM"},
    "cpe:/o:siemens:logo%21_8_bm_firmware:1.82.01" :
        {"versionEndIncluding" : "1.82.01", "versionStartIncluding" : "1.82.01", "family" : "LOGO!BM"},
    "cpe:/o:siemens:logo%21_8_bm_firmware:1.82.02" :
        {"versionEndIncluding" : "1.82.02", "versionStartIncluding" : "1.82.02", "family" : "LOGO!BM"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
