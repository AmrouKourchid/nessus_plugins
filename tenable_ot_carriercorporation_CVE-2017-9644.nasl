#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500960);
  script_version("1.6");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/20");

  script_cve_id("CVE-2017-9644");
  script_xref(name:"ICSA", value:"17-234-01");
  script_xref(name:"EDB-ID", value:"42542");

  script_name(english:"Automated Logic Corporation WebCTRL, i-VU, SiteScan Unquoted Search Path or Element (CVE-2017-9644)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"An Unquoted Search Path or Element issue was discovered in Automated
Logic Corporation (ALC) ALC WebCTRL, i-Vu, SiteScan Web 6.5 and prior;
ALC WebCTRL, SiteScan Web 6.1 and prior; ALC WebCTRL, i-Vu 6.0 and
prior; ALC WebCTRL, i-Vu, SiteScan Web 5.5 and prior; and ALC WebCTRL,
i-Vu, SiteScan Web 5.2 and prior. An unquoted search path
vulnerability may allow a non-privileged local attacker to change
files in the installation directory and execute arbitrary code with
elevated privileges.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://ics-cert.us-cert.gov/advisories/ICSA-17-234-01");
  script_set_attribute(attribute:"see_also", value:"https://www.exploit-db.com/exploits/42542/");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/100454");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

ALC provides support for WebCTRL, i-Vu, SiteScan Web versions 6.0 and greater. Those users using prior versions,
including 5.5 and 5.2, must upgrade to supported versions in order to install these mitigation patches.

ALC applications should always be installed and maintained in accordance with the guidelines found here:

http://www.automatedlogic.com/Pages/Security.aspx.

In addition ALC has released the following patches, which address these vulnerabilities:

- WebCTRL 6.0, Cumulative Patch #13
- WebCTRL 6.1, Cumulative Patch #7
- WebCTRL 6.5, Cumulative Patch #7 + WS65_Security_Update2.update

These patch releases may be obtained on the ALC accounts web site or calling Technical Support at 770-429-3002

- i-Vu 6.0, Cumulative Patch #13
- i-Vu 6.5, Cumulative Patch #7 + WS65_Security_Update2.update

The patch release may be obtained by calling Technical Support at 800-277-9852

- SiteScan Web Version 6.1, Cumulative Patch #7, and
- SiteScan Web Version 6.5, Cumulative Patch #7 + WS65_Security_Update2.update.

These patches may be obtained by contacting Liebert Services at 1-800-543-2378.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:M/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:POC/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-9644");
  script_set_attribute(attribute:"cvss3_score_rationale", value:"Scoring adjustsed to align with CVSS 3.1 attack complexity guidance.");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(428);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/08/25");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/08/25");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/04/06");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:automatedlogic:i-vu");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/CarrierCorporation");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/CarrierCorporation');

var asset = tenable_ot::assets::get(vendor:'CarrierCorporation');

var vuln_cpes = {
    "cpe:/a:automatedlogic:i-vu" :
        {"versionEndIncluding" : "6.5", "family" : "iVu"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
