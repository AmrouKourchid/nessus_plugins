#%NASL_MIN_LEVEL 80900
#
# (C) Tenable, Inc.
#

include('compat.inc');

if (description)
{
  script_id(210587);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/25");

  script_cve_id("CVE-2024-47939");
  script_xref(name:"IAVB", value:"2024-B-0165");

  script_name(english:"Ricoh MFP and Printer Products Buffer Overflow (ricoh-2024-000011)");

  script_set_attribute(attribute:"synopsis", value:
"The remote device is affected by a buffer overflow vulnerability.");
  script_set_attribute(attribute:"description", value:
"The version of the remote Ricoh MFP or printer is affected by a buffer overflow vulnerability.

  - Stack-based buffer overflow vulnerability exists in multiple Ricoh laser printers and MFPs which implement
  Web Image Monitor. If this vulnerability is exploited, receiving a specially crafted request created and 
  sent by an attacker may lead to arbitrary code execution and/or a denial-of-service (DoS) condition.
  (CVE-2024-47939)

Note that Nessus has not tested for these issues but has instead relied only on the application's self-reported version
number.");
  # https://www.ricoh.com/products/security/vulnerabilities/vul?id=ricoh-2024-000011
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?82c36346");
  script_set_attribute(attribute:"see_also", value:"https://jvn.jp/en/jp/JVN87770340/");
  script_set_attribute(attribute:"solution", value:
"Apply the appropriate firmware update according to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:L");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-47939");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/10/31");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/10/31");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/11/08");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_501spf");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_601spf");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_550f");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_600f");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_600srf");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_5300dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_5310dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:p_800");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:p_801");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_2702");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c8003");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c6503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c6500");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c8000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_350f");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_350");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_430f");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_430fb");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:p_501");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:p_502");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_2500");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_3000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_3500");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_4000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_5000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_6000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_2555");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_3055");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_3555");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_4055");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_5055");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_6055");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_8400dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_6430dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c530f");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c530fb");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_402spf");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c400f");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c400srf");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c300f");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c300");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:p_c600");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:aficio_mp_2001");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:aficio_mp_2501");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_6503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_7503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_9003");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_7000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_8000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_9000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c3003");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c3503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c4503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c5503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c6003");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c2003");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c2503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c3004ex");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c3504ex");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c2004ex");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c2504ex");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c4504ex");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c5504ex");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c6004ex");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c3004");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c3504");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c2004");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c2504");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c4504");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c5504");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c6004");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c3000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c3500");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c2000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c2500");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c4500");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c5500");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_c6000");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c840dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c842dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c340dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c342dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c501sp");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:im_cw2200");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:ip_cw2200");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:aficio_mp_301");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c360snw");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c360sfnw");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c361sfnw");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c352dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c360dnw");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c435dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:sp_c440dn");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c3003");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c3503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c4503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c5503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c6003");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c2003");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c2503");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c6502");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c8002");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_2554");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_3054");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_3554");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_4054");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_5054");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_6054");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_2554zsp");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_3054zsp");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_3554zsp");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_4054azsp");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_5054azsp");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_6054zsp");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c306");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:mp_c406");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_8300s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_8310s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_8320s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_8310");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_8320");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c5200s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c5210s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c5300s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c5310s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c5300sl");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7200s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7210s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7200sx");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7210sx");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7200sl");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7200");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7210");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7200x");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7210x");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7200e");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c9100");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_9110");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7100s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7110s");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7100sx");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7110sx");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7100");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7110");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7100x");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c7110x");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_c9200");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/h:pro_9210");
  script_set_attribute(attribute:"stig_severity", value:"I");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Misc.");

  script_copyright(english:"This script is Copyright (C) 2024-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("ricoh_printer_detect.nasl");
  script_require_keys("installed_sw/Ricoh printer");
  script_require_ports("Services/www", 80, 443);

  exit(0);
}

include("http.inc");
include('vcf.inc');

var port = get_http_port(default:443, dont_break:TRUE, embedded:TRUE);

var app_info = vcf::get_app_info(app:'Ricoh printer', port:port, webapp:TRUE);
var model = app_info.Model;
var wim_ver = app_info['Web Image Monitor Version'];
dbg::log(msg:model);

# require paranoia if we haven't detected WIM on the printer
if ((empty_or_null(wim_ver)) && report_paranoia < 2)
  audit(AUDIT_POTENTIAL_VULN);

# constraints use the System, Printer or Web Support version, in that order
# e.g. in the absence of System, use the Printer version instead if available
# Web Support/WebUapl versions might correspond to the WIM version, can't be confirmed atm
var constraints;
if ("MP 501SPF" >< model || "MP 601SPF" >< model)
  constraints = [{ 'max_version': '1.14', 'fixed_display': 'See vendor advisory'}];
else if ("IM 550F" >< model || "IM 600F" >< model || "IM 600SRF" >< model)
  constraints = [{ 'max_version': '7.32', 'fixed_display': 'See vendor advisory'}];
else if ("SP 5300DN" >< model || "SP 5310DN" >< model)
  constraints = [{ 'max_version': '1.21', 'fixed_display': 'See vendor advisory'}];
else if ("P 800" >< model || "P 801" >< model)
  constraints = [{ 'max_version': '1.13', 'fixed_display': 'See vendor advisory'}];
else if ("IM 2702" >< model)
  constraints = [{ 'max_version': '1.16', 'fixed_display': 'See vendor advisory'}];
else if ("MP C8003" >< model || "MP C6503" >< model)
  constraints = [{ 'max_version': '1.16', 'fixed_display': 'See vendor advisory'}];
else if ("IM C6500" >< model || "IM C8000" >< model)
  constraints = [{ 'max_version': '7.62', 'fixed_display': 'See vendor advisory'}];
else if ("IM 350F" >< model || "IM 350" >< model || "IM 430F" >< model || "IM 430Fb" >< model)
  constraints = [{ 'max_version': '1.09', 'fixed_display': 'See vendor advisory'}];
else if ("P 501" >< model || "P 502" >< model)
  constraints = [{ 'max_version': '1.20', 'fixed_display': 'See vendor advisory'}];
else if ("IM 2500" >< model || "IM 3000" >< model || "IM 3500" >< model || "IM 4000" >< model || "IM 5000" >< model || "IM 6000" >< model)
  constraints = [{ 'max_version': '7.60', 'fixed_display': 'See vendor advisory'}];
else if ("MP 2555" >< model || "MP 3055" >< model || "MP 3555" >< model || "MP 4055" >< model || "MP 5055" >< model || "MP 6055" >< model)
  constraints = [{ 'max_version': '1.19.1', 'fixed_display': 'See vendor advisory'}];
else if ("SP 8400DN" >< model)
  constraints = [{ 'max_version': '1.22', 'fixed_display': 'See vendor advisory'}];
else if ("SP 6430DN" >< model)
  constraints = [{ 'max_version': '1.18', 'fixed_display': 'See vendor advisory'}];
else if ("IM C530F" >< model || "IM C530FB" >< model)
  constraints = [{ 'max_version': '7.38', 'fixed_display': 'See vendor advisory'}];
else if ("MP 402SPF" >< model)
  constraints = [{ 'max_version': '1.10', 'fixed_display': 'See vendor advisory'}];
else if ("IM C400F" >< model || "IM C400SRF" >< model || "IM C300F" >< model || "IM C300" >< model)
  constraints = [{ 'max_version': '7.34', 'fixed_display': 'See vendor advisory'}];
else if ("P C600" >< model)
  constraints = [{ 'max_version': '1.10', 'fixed_display': 'See vendor advisory'}];
else if ("Aficio MP 2001" >< model || "Aficio MP 2501" >< model)
  constraints = [{ 'max_version': '1.08', 'fixed_display': 'See vendor advisory'}];
else if ("MP 6503" >< model || "MP 7503" >< model || "MP 9003" >< model)
  constraints = [{ 'max_version': '1.13', 'fixed_display': 'See vendor advisory'}];
else if ("IM 7000" >< model || "IM 8000" >< model || "IM 9000" >< model)
  constraints = [{ 'max_version': '7.61', 'fixed_display': 'See vendor advisory'}];
else if ("MP C3003" >< model || "MP C3503" >< model)
  constraints = [{ 'max_version': '1.22', 'fixed_display': 'See vendor advisory'}];
else if ("MP C4503" >< model || "MP C5503" >< model || "MP C6003" >< model)
  constraints = [{ 'max_version': '1.23', 'fixed_display': 'See vendor advisory'}];
else if ("MP C2003" >< model || "MP C2503" >< model)
  constraints = [{ 'max_version': '1.17', 'fixed_display': 'See vendor advisory'}];
else if ("MP C3004ex" >< model || "MP C3504ex" >< model)
  constraints = [{ 'max_version': '1.12', 'fixed_display': 'See vendor advisory'}];
else if ("MP C2004ex" >< model || "MP C2504ex" >< model)
  constraints = [{ 'max_version': '1.12', 'fixed_display': 'See vendor advisory'}];
else if ("MP C4504ex" >< model || "MP C5504ex" >< model || "MP C6004ex" >< model)
  constraints = [{ 'max_version': '1.12', 'fixed_display': 'See vendor advisory'}];
else if ("MP C3004" >< model || "MP C3504" >< model)
  constraints = [{ 'max_version': '1.20', 'fixed_display': 'See vendor advisory'}];
else if ("MP C2004" >< model || "MP C2504" >< model)
  constraints = [{ 'max_version': '1.20', 'fixed_display': 'See vendor advisory'}];
else if ("MP C4504" >< model || "MP C5504" >< model || "MP C6004" >< model)
  constraints = [{ 'max_version': '1.20', 'fixed_display': 'See vendor advisory'}];
else if ("IM C3000" >< model || "IM C3500" >< model)
  constraints = [{ 'max_version': '7.70', 'fixed_display': 'See vendor advisory'}];
else if ("IM C2000" >< model || "IM C2500" >< model)
  constraints = [{ 'max_version': '7.70', 'fixed_display': 'See vendor advisory'}];
else if ("IM C4500" >< model || "IM C5500" >< model || "IM C6000" >< model)
  constraints = [{ 'max_version': '7.70', 'fixed_display': 'See vendor advisory'}];
else if ("SP C840DN" >< model || "SP C842DN" >< model)
  constraints = [{ 'max_version': '1.23', 'fixed_display': 'See vendor advisory'}];
else if ("SP C340DN" >< model)
  constraints = [{ 'max_version': '1.09', 'fixed_display': 'See vendor advisory'}];
else if ("SP C342DN" >< model)
  constraints = [{ 'max_version': '1.12', 'fixed_display': 'See vendor advisory'}];
else if ("MP C501SP" >< model)
  constraints = [{ 'max_version': '1.04', 'fixed_display': 'See vendor advisory'}];
else if ("IM CW2200" >< model)
  constraints = [{ 'max_version': '1.01', 'fixed_display': 'See vendor advisory'}];
else if ("IP CW2200" >< model)
  constraints = [{ 'max_version': '1.03', 'fixed_display': 'See vendor advisory'}];
else if ("Aficio MP 301" >< model)
  constraints = [{ 'max_version': '1.13', 'fixed_display': 'See vendor advisory'}];
else if ("SP C360SNw" >< model || "SP C360SFNw" >< model || "SP C361SFNw" >< model)
  constraints = [{ 'max_version': '1.17.1', 'fixed_display': 'See vendor advisory'}];
else if ("SP C352DN" >< model)
  constraints = [{ 'max_version': '1.21', 'fixed_display': 'See vendor advisory'}];
else if ("SP C360DNw" >< model)
  constraints = [{ 'max_version': '1.13.1', 'fixed_display': 'See vendor advisory'}];
else if ("SP C435DN" >< model)
  constraints = [{ 'max_version': '1.12', 'fixed_display': 'See vendor advisory'}];
else if ("SP C440DN" >< model)
  constraints = [{ 'max_version': '1.12', 'fixed_display': 'See vendor advisory'}];
else if ("MP C3003" >< model || "MP C3503" >< model)
  constraints = [{ 'max_version': '2.26', 'fixed_display': 'See vendor advisory'}];
else if ("MP C4503" >< model || "MP C5503" >< model || "MP C6003" >< model)
  constraints = [{ 'max_version': '2.24', 'fixed_display': 'See vendor advisory'}];
else if ("MP C2003" >< model || "MP C2503" >< model)
  constraints = [{ 'max_version': '2.18', 'fixed_display': 'See vendor advisory'}];
else if ("MP C6502" >< model || "MP C8002" >< model)
  constraints = [{ 'max_version': '1.15', 'fixed_display': 'See vendor advisory'}];
else if ("MP 2554" >< model || "MP 3054" >< model || "MP 3554" >< model || "MP 4054" >< model || "MP 5054" >< model || "MP 6054" >< model)
  constraints = [{ 'max_version': '1.14', 'fixed_display': 'See vendor advisory'}];
else if ("MP 2554ZSP" >< model || "MP 3054ZSP" >< model || "MP 3554ZSP" >< model || "MP 4054AZSP" >< model || "MP 5054AZSP" >< model || "MP 6054ZSP" >< model)
  constraints = [{ 'max_version': '1.14', 'fixed_display': 'See vendor advisory'}];
else if ("MP C306" >< model || "MP C406" >< model)
  constraints = [{ 'max_version': '1.18', 'fixed_display': 'See vendor advisory'}];
else if ("Pro 8300S" >< model || "Pro 8310S" >< model || "Pro 8320S" >< model)
  constraints = [{ 'max_version': '1.15', 'fixed_display': 'See vendor advisory'}];
else if ("Pro 8310" >< model || "Pro 8320" >< model)
  constraints = [{ 'max_version': '1.19', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C5200S" >< model || "Pro C5210S" >< model)
  constraints = [{ 'max_version': '1.16', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C5300S" >< model || "Pro C5310S" >< model)
  constraints = [{ 'max_version': '1.08', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C5300SL" >< model)
  constraints = [{ 'max_version': '1.07', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C7200S" >< model || "Pro C7210S" >< model || "Pro C7200SX" >< model || "Pro C7210SX" >< model || "Pro C7200SL" >< model)
  constraints = [{ 'max_version': '7.15', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C7200" >< model || "Pro C7210" >< model || "Pro C7200X" >< model || "Pro C7210X" >< model || "Pro C7200e" >< model)
  constraints = [{ 'max_version': '7.16', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C9100" >< model || "Pro 9110" >< model)
  constraints = [{ 'max_version': '2.09', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C7100S" >< model || "Pro C7110S" >< model || "Pro C7100SX" >< model || "Pro C7110SX" >< model)
  constraints = [{ 'max_version': '3.08', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C7100" >< model || "Pro C7110" >< model || "Pro C7100X" >< model || "Pro C7110X" >< model)
  constraints = [{ 'max_version': '3.17', 'fixed_display': 'See vendor advisory'}];
else if ("Pro C9200" >< model || "Pro 9210" >< model)
  constraints = [{ 'max_version': '7.05', 'fixed_display': 'See vendor advisory'}];
else
  audit(AUDIT_HOST_NOT, 'an affected model');

vcf::check_version_and_report(
  app_info:app_info,
  constraints:constraints,
  severity:SECURITY_HOLE
);
