#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502308);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/07/23");

  script_cve_id("CVE-2014-4879");
  script_xref(name:"EDB-ID", value:"35356");

  script_name(english:"Hikvision DVRs Devices Buffer Overflow (CVE-2014-4879)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"While processing specified RTSP requests, buffer overflow vulnerabilities may occurs for 
select Hikvision DVRs, which may result in potential service interruption for users. 
These issues have been assigned Common Vulnerabilities and Exposures (CVE) ID: 
CVE-2014-4878, CVE-2014-4879 and CVE-2014-4880.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.hikvision.com/en/support/cybersecurity/security-advisory/security-notification--buffer-overflow-vulnerability-in-hikvisio/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?7826c76e");
  # http://packetstormsecurity.com/files/129187/Hikvision-DVR-RTSP-Request-Remote-Code-Execution.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4feb3713");
  script_set_attribute(attribute:"see_also", value:"http://www.exploit-db.com/exploits/35356");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2014-4879");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(119);

  script_set_attribute(attribute:"vuln_publication_date", value:"2014/12/08");
  script_set_attribute(attribute:"patch_publication_date", value:"2014/12/08");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/07/22");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7100hwi-sl%28sh%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7100hvi-sl%28sh%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hwi-sh%28sl%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hfi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hvi-sv");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hwi-e1%28%2fc%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hwi-e2%28%2fc%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7300hwi-e4%28%2fc%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7300hwi%28hfi%29-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7600ni-se%28%2fn%29%28%2fp%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7600ni-v%28vp%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7600ni-e1%28%2fn%29%28%2fp%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7600ni-e2%28%2fn%29%28%2fp%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7700ni-e4%28%2fn%29%28%2fp%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-80%2f81%2f90%2f91xxhfi-st");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-80%2f81%2f90%2f91%2f92xxhwi-st");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-90%2f91xxhfi-rt");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-90%2f91xxhfi-xt");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-76%2f77%2f86%2f96xxni-st");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-96xxni-rt");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-96xxni-xt");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-76%2f77xxni-sp");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hwi-sv");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7100hghi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7100hqhi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hghi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hqhi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7300hghi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7300hqhi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-8100hghi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-8100hqhi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hwi-ex%2fc%2ff");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hvi-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7204hwi-sv");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7300hfi-st");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7300hi-st");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-8100hdi-st");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-6700hwi%28-sata%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-6700hfi%28-sata%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7100ni-sn%28%2fn%29%28%2fp%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7600ni-sn%28%2fn%29%28%2fp%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-8100hci%28hfsi%29%28hwsi%29-sh");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7100ni-sl");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7104ni-sl%2fw");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7600hi-st");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7200hfhi-sl%28st%29%28se%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-7300hfhi-sl%28st%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hikvision:ds-8100hfhi-sl%28st%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Hikvision");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Hikvision');

var asset = tenable_ot::assets::get(vendor:'Hikvision');

var vuln_cpes = {
    "cpe:/o:hikvision:ds-7100hwi-sl%28sh%29" :
        {"versionEndIncluding" : "V2.2.15_build141126", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7100hvi-sl%28sh%29" :
        {"versionEndIncluding" : "V2.2.15_build141126", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7200hwi-sh%28sl%29" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7200hfi-sh" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7200hvi-sv" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7200hwi-e1%28%2fc%29" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7200hwi-e2%28%2fc%29" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7300hwi-e4%28%2fc%29" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7300hwi%28hfi%29-sh" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7600ni-se%28%2fn%29%28%2fp%29" :
        {"versionEndIncluding" : "V3.0.10_build141125", "family" : "HikvisionVideoRecordersProSeries"},
    "cpe:/o:hikvision:ds-7600ni-v%28vp%29" :
        {"versionEndIncluding" : "V3.0.10_build141125", "family" : "HikvisionVideoRecordersProSeries"},
    "cpe:/o:hikvision:ds-7600ni-e1%28%2fn%29%28%2fp%29" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecordersProSeries"},
    "cpe:/o:hikvision:ds-7600ni-e2%28%2fn%29%28%2fp%29" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecordersProSeries"},
    "cpe:/o:hikvision:ds-7700ni-e4%28%2fn%29%28%2fp%29" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecordersProSeries"},
    "cpe:/o:hikvision:ds-80%2f81%2f90%2f91xxhfi-st" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-80%2f81%2f90%2f91%2f92xxhwi-st" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-90%2f91xxhfi-rt" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-90%2f91xxhfi-xt" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-76%2f77%2f86%2f96xxni-st" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-96xxni-rt" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecordersUltraSeries"},
    "cpe:/o:hikvision:ds-96xxni-xt" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecordersUltraSeries"},
    "cpe:/o:hikvision:ds-76%2f77xxni-sp" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7200hwi-sv" :
        {"versionEndIncluding" : "V3.1.7_build141201", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7100hghi-sh" :
        {"versionEndIncluding" : "V3.1.1_build141128", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7100hqhi-sh" :
        {"versionEndIncluding" : "V3.1.1_build141128", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7200hghi-sh" :
        {"versionEndIncluding" : "V3.1.1_build141128", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7200hqhi-sh" :
        {"versionEndIncluding" : "V3.1.1_build141128", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7300hghi-sh" :
        {"versionEndIncluding" : "V3.1.1_build141128", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7300hqhi-sh" :
        {"versionEndIncluding" : "V3.1.1_build141128", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-8100hghi-sh" :
        {"versionEndIncluding" : "V3.1.1_build141128", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-8100hqhi-sh" :
        {"versionEndIncluding" : "V3.1.1_build141128", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7200hwi-ex%2fc%2ff" :
        {"versionEndIncluding" : "V3.1.2_build141206", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7200hvi-sh" :
        {"versionEndIncluding" : "V2.2.4_build141206", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7204hwi-sv" :
        {"versionEndIncluding" : "V2.2.4_build141206", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7300hfi-st" :
        {"versionEndIncluding" : "V2.1.2_build141206", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7300hi-st" :
        {"versionEndIncluding" : "V2.1.2_build141206", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-8100hdi-st" :
        {"versionEndIncluding" : "V2.1.2_build141206", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-6700hwi%28-sata%29" :
        {"versionEndIncluding" : "V1.2.3_build141203", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-6700hfi%28-sata%29" :
        {"versionEndIncluding" : "V1.2.3_build141203", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7100ni-sn%28%2fn%29%28%2fp%29" :
        {"versionEndIncluding" : "V3.0.10_build141128", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7600ni-sn%28%2fn%29%28%2fp%29" :
        {"versionEndIncluding" : "V3.0.10_build141127", "family" : "HikvisionVideoRecordersProSeries"},
    "cpe:/o:hikvision:ds-8100hci%28hfsi%29%28hwsi%29-sh" :
        {"versionEndIncluding" : "V3.1.3_build141126", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7100ni-sl" :
        {"versionEndIncluding" : "V3.0.10_build141224", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7104ni-sl%2fw" :
        {"versionEndIncluding" : "V2.3.8_build141224", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-7600hi-st" :
        {"versionEndIncluding" : "V3.0.11_150319", "family" : "HikvisionVideoRecordersProSeries"},
    "cpe:/o:hikvision:ds-7200hfhi-sl%28st%29%28se%29" :
        {"versionEndIncluding" : "V3.0.0_build141202", "family" : "HikvisionVideoRecorders"},
    "cpe:/o:hikvision:ds-7300hfhi-sl%28st%29" :
        {"versionEndIncluding" : "V3.0.0_build141202", "family" : "HikvisionVideoRecordersValueSeries"},
    "cpe:/o:hikvision:ds-8100hfhi-sl%28st%29" :
        {"versionEndIncluding" : "V3.0.0_build141202", "family" : "HikvisionVideoRecordersValueSeries"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
