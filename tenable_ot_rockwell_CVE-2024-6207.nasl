#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502648);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/12");

  script_cve_id("CVE-2024-6207");
  script_xref(name:"ICSA", value:"24-284-20");

  script_name(english:"Rockwell Automation ControlLogix Improper Input Validation (CVE-2024-6207)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A denial-of-service vulnerability exists in the affected products
that will cause the device to result in a major nonrecoverable fault
(MNRF) when it receives an invalid CIP request. To exploit this
vulnerability a malicious user must chain this exploits with
CVE-2021-22681 and send a specially crafted CIP message to the device.

If exploited, a threat actor could help prevent access to the
legitimate user and end connections to connected devices including
the workstation.  To recover the controllers, a download is required
which ends any process that the controller is running. 

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.SD1707.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?fdd32ab4");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-24-284-20");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Rockwell Automations recommends users update to V33.017, V34.014, V35.013, or V36.011.

Additionally, Rockwell automation encourages users to apply security best practices to minimize the risk of
vulnerability.

- Security Best Practices

For more information about this issue, please see the advisory on the Rockwell Automation security page.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-6207");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/10/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/10/14");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/10/21");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_2_firmware:33");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_2_firmware:34");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_2_firmware:35");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_3_firmware:33");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_3_firmware:34");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_3_firmware:35");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_5380_firmware:33");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_5380_firmware:34");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_5380_firmware:35");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_5480_firmware:33");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_5480_firmware:34");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:compactlogix_5480_firmware:35");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:controllogix_5580_firmware:33");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:controllogix_5580_firmware:34");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:controllogix_5580_firmware:35");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:controllogix_5580_process_firmware:33");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:controllogix_5580_process_firmware:34");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:controllogix_5580_process_firmware:35");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:guardlogix_5580_firmware:33");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:guardlogix_5580_firmware:34");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:guardlogix_5580_firmware:35");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Rockwell");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Rockwell');

var asset = tenable_ot::assets::get(vendor:'Rockwell');

var vuln_cpes = {
    "cpe:/o:rockwellautomation:controllogix_5580_firmware:33" :
        {"versionEndExcluding" : "33.017", "versionStartIncluding" : "28.011", "family" : "ControlLogix5580"},
    "cpe:/o:rockwellautomation:controllogix_5580_firmware:34" :
        {"versionEndExcluding" : "34.014", "versionStartIncluding" : "34.011", "family" : "ControlLogix5580"},
    "cpe:/o:rockwellautomation:controllogix_5580_firmware:35" :
        {"versionEndExcluding" : "35.013", "versionStartIncluding" : "35.011", "family" : "ControlLogix5580"},
    "cpe:/o:rockwellautomation:controllogix_5580_process_firmware:33" :
        {"versionEndExcluding" : "33.017", "versionStartIncluding" : "33.011", "family" : "ControlLogix5580"},
    "cpe:/o:rockwellautomation:controllogix_5580_process_firmware:34" :
        {"versionEndExcluding" : "34.014", "versionStartIncluding" : "34.011", "family" : "ControlLogix5580"},
    "cpe:/o:rockwellautomation:controllogix_5580_process_firmware:35" :
        {"versionEndExcluding" : "35.013", "versionStartIncluding" : "35.011", "family" : "ControlLogix5580"},
    "cpe:/o:rockwellautomation:guardlogix_5580_firmware:33" :
        {"versionEndExcluding" : "33.017", "versionStartIncluding" : "31.011", "family" : "GuardLogix5580"},
    "cpe:/o:rockwellautomation:guardlogix_5580_firmware:34" :
        {"versionEndExcluding" : "34.014", "versionStartIncluding" : "34.011", "family" : "GuardLogix5580"},
    "cpe:/o:rockwellautomation:guardlogix_5580_firmware:35" :
        {"versionEndExcluding" : "35.013", "versionStartIncluding" : "35.011", "family" : "GuardLogix5580"},
    "cpe:/o:rockwellautomation:compactlogix_5380_firmware:33" :
        {"versionEndExcluding" : "33.017", "versionStartIncluding" : "28.011", "family" : "CompactLogix5380"},
    "cpe:/o:rockwellautomation:compactlogix_5380_firmware:34" :
        {"versionEndExcluding" : "34.014", "versionStartIncluding" : "34.011", "family" : "CompactLogix5380"},
    "cpe:/o:rockwellautomation:compactlogix_5380_firmware:35" :
        {"versionEndExcluding" : "35.013", "versionStartIncluding" : "35.011", "family" : "CompactLogix5380"},
    "cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_2_firmware:33" :
        {"versionEndExcluding" : "33.017", "versionStartIncluding" : "31.011", "family" : "GuardLogix5380"},
    "cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_2_firmware:34" :
        {"versionEndExcluding" : "34.014", "versionStartIncluding" : "34.011", "family" : "GuardLogix5380"},
    "cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_2_firmware:35" :
        {"versionEndExcluding" : "35.013", "versionStartIncluding" : "35.011", "family" : "GuardLogix5380"},
    "cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_3_firmware:33" :
        {"versionEndExcluding" : "33.017", "versionStartIncluding" : "32.013", "family" : "GuardLogix5380"},
    "cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_3_firmware:34" :
        {"versionEndExcluding" : "34.014", "versionStartIncluding" : "34.011", "family" : "GuardLogix5380"},
    "cpe:/o:rockwellautomation:compact_guardlogix_5380_sil_3_firmware:35" :
        {"versionEndExcluding" : "35.013", "versionStartIncluding" : "35.011", "family" : "GuardLogix5380"},
    "cpe:/o:rockwellautomation:compactlogix_5480_firmware:33" :
        {"versionEndExcluding" : "33.017", "versionStartIncluding" : "32.011", "family" : "CompactLogix5480"},
    "cpe:/o:rockwellautomation:compactlogix_5480_firmware:34" :
        {"versionEndExcluding" : "34.014", "versionStartIncluding" : "34.011", "family" : "CompactLogix5480"},
    "cpe:/o:rockwellautomation:compactlogix_5480_firmware:35" :
        {"versionEndExcluding" : "35.013", "versionStartIncluding" : "35.011", "family" : "CompactLogix5480"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
