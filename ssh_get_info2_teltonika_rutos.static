#TRUSTED a191d65225b0b7adfe56f0b384607ab6093217656827dc4150a026236ad118fcd4bbeb93db40fc41c42f051203e76acfb0c7cd96588cbf8783758f858f123494e53dc94720abf58aff54155d6094a867f6845ccab757771e09cd3f97f82e770826d213524fb9da9c592a079cc5b0b76138af556ad1d4c83ab2f6b153f3a19185e3fd9fcdcbba1878525ee8947a88d627a62289d92c36ac0c5998d5735b71b748adbdc2c34af99b45ce8d1e0a3e65705feb80616eb7e3a00c74d53f24bfabdb15666ae5a0a80bfc6679706fb72e5cc9bd4289b0fd4f648681ced334951dc274ed30ba2fa75cb4a10bf452ddf41bfcf438f2b991b92bc8568169bef81f8d24dfc51725fae2f5935be43db3e6be829b7af2392bff1e0fdc25e9c4c17d4f526751d24fc47116bb55ef5e0a4cd069fa1c728a1612ac1cad856c1f032db344d6d57192ca7afecbfba71da042b769d0c203e140e1702ec09c4cb7dec1b35921c5abb5356791a88d159d59994c26d1ac0488332d123b4b99733c3eb730e23c9b3a7e32fd70872eda1552a6ca4725deb4050cf5793dd0383db1e1fe58141dadafe01b069357dba9280c4e7572a82be7a1321d3053e32e3a34520c161ecc5b06275aea494c47292dd1153dd2445677a1913ef98cb7b58ccf4d47f15320ae4c8e3289284f0cc546c186ec3c9a10e8a5e52d1fc7477621cce01e18948b3ab7828b8d3b590c87
#TRUST-RSA-SHA256 5875a4b5edf427f378736b7c6db1bb69e4d48f2695daadebf60f38225dfeb37800e5ce59479726fa2b0b9d948b45b8c5560a330b7243b01a75a223638cb4ae26ffa296584a9a2aad8f17f6c0fc883a4a8515c3a2ad97e8eb591422ec23f4dae327c1a5198bf8f14d383efb9febb0091784a9c10eaf7631e5d72cf8524c0aa6b83dd6fc210d1aeddbe772b03af3cc24e858eb06f61744fa25804a8831bb47814d6824459cd0abf217d5f7cbf442960dd11034132445551518fac5323a91faaf8cc23502fc9e8488bddfe69e830779f13e340142d796939148453257c3c33bc956aed33e914ac2fee872590c67f82bd9b2a2114a775ad4b91434807c9900cbe56786ef8bdf32f297e4eb4c6c52fe4e900fe2f77cacef22bac3e69fa4b0396a83f7d17aad27cac8a583e738a17c68d0613ee195326746a966ac1753452ebf368a86554603a4c75584b63f9a3ae68b01cbc5485de8ef9bf7c954fed68a2807a0dc94c4854de355f02acbc6236ac6d5df159dc1848b312058b63d7e82b7e9a071cd54cc808c121fbf121bcfd715d99fb442842dc62361a4815164e623f83af7078912525294fb06f57ccd507e4e11067da404f5376c353643b9f7a44c4f57609f6d82cd84f82468b32275cacbcb7c4a9812060ffd6126ad4fbf650d143b42440f74590356f59fcaed3e727959743cdbb6aed0b8e97c9a615a5d8165797dadd084fe02

##
# (C) Tenable Network Security, Inc.
##

##
# check if this is a teltonika device based on information collected.
##
function teltonika_pre_check_fail()
{
  # Not teltonika if one of the following devices
  if (is_cisco_ssh() ||
      is_panos() ||
      is_huawei() ||
      is_asyncos() ||
      is_staros() ||
      is_ivanti_sentry() ||
      is_screenos() ||
      is_exos() ||
      is_qnap_standard() ||
      is_dell_idrac() ||
      is_infoblox_nios())
  {
    return TRUE;
  }

  # have we already checked that the host is not teltonika?
  if(host_info_key_val['host_not_teltonika'])
  {
    # already checked that host is not teltonika, no need to check again.
    return TRUE;
  }
  return FALSE;
}

##
# callback for systems with "RUT" or "TRB" in /etc/config/system.
##
function handle_teltonika_rutos(session, use_shell_handler, &channel, cmd_res)
{
  report += '\nThe output of the "cat /etc/config/system" was :\n' + cmd_res + '\n\n'
          + 'Command support has been enabled for Teltonika RutOS CLI.\n'
          + 'Further identification will be handled by subsequent plugins.\n';
  replace_kb_item(name:'target_shell', value:'Teltonika RutOS CLI');
  replace_kb_item(name:"Host/Teltonika/RutOS/cat_etc_config_system", value:cmd_res);
  replace_kb_item(name:'Host/Teltonika/RutOS', value:TRUE);
  replace_kb_item(name:'Host/OS/cat_etc_config_system', value: 'Teltonika RutOS');
  replace_kb_item(name:'Host/OS/cat_etc_config_system/Confidence', value: 100);
  replace_kb_item(name:'Host/OS/cat_etc_config_system/Type', value: 'router');
  sshlib::set_support_level(level: sshlib::SSH_LIB_LOCAL_CHECKS_UNAVAILABLE);
  return TRUE;
}

