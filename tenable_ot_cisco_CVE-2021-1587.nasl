#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501863);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/04/22");

  script_cve_id("CVE-2021-1587");

  script_name(english:"Cisco NX-OS Software VXLAN OAM Denial of Service (CVE-2021-1587)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the VXLAN Operation, Administration, and
Maintenance (OAM) feature of Cisco NX-OS Software, known as NGOAM,
could allow an unauthenticated, remote attacker to cause a denial of
service (DoS) condition on an affected device. This vulnerability is
due to improper handling of specific packets with a Transparent
Interconnection of Lots of Links (TRILL) OAM EtherType. An attacker
could exploit this vulnerability by sending crafted packets, including
the TRILL OAM EtherType of 0x8902, to a device that is part of a VXLAN
Ethernet VPN (EVPN) fabric. A successful exploit could allow the
attacker to cause an affected device to experience high CPU usage and
consume excessive system resources, which may result in overall
control plane instability and cause the affected device to reload.
Note: The NGOAM feature is disabled by default.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-ngoam-dos-LTDb9Hv
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?7380f039");
  script_set_attribute(attribute:"solution", value:
"Disabling the NGOAM feature removes the exploit vector. 
Administrators can disable the NGOAM feature by using the 
no feature ngoam command at the Cisco NX-OS CLI in global configuration mode. 
This action may be a suitable mitigation for affected devices 
that do not require use of this feature until they can be upgraded.

For more information, please refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-1587");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(436);

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/08/25");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/08/25");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/01/04");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:-");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:-" :
        {"family" : "NXOS", "versionEndExcluding" : "9.3(7a)"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
