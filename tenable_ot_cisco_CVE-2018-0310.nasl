#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501340);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2018-0310");

  script_name(english:"Cisco FXOS and NX-OS Software Cisco Fabric Services Denial of Service (CVE-2018-0310)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Cisco Fabric Services component of Cisco FXOS
Software and Cisco NX-OS Software could allow an unauthenticated,
remote attacker to obtain sensitive information from memory or cause a
denial of service (DoS) condition on the affected product. The
vulnerability exists because the affected software insufficiently
validates header values in Cisco Fabric Services packets. An attacker
could exploit this vulnerability by sending a crafted Cisco Fabric
Services packet to an affected device. A successful exploit could
allow the attacker to cause a buffer overread condition, which could
allow the attacker to obtain sensitive information from memory or
cause a DoS condition on the affected product. This vulnerability
affects Firepower 4100 Series Next-Generation Firewalls, Firepower
9300 Security Appliance, MDS 9000 Series Multilayer Switches, Nexus
2000 Series Fabric Extenders, Nexus 3000 Series Switches, Nexus 3500
Platform Switches, Nexus 5500 Platform Switches, Nexus 5600 Platform
Switches, Nexus 6000 Series Switches, Nexus 7000 Series Switches,
Nexus 7700 Series Switches, Nexus 9000 Series Switches in standalone
NX-OS mode, Nexus 9500 R-Series Line Cards and Fabric Modules, UCS
6100 Series Fabric Interconnects, UCS 6200 Series Fabric
Interconnects, UCS 6300 Series Fabric Interconnects. Cisco Bug IDs:
CSCvd69957, CSCve02435, CSCve04859, CSCve41536, CSCve41538,
CSCve41559.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180620-nx-os-fabric-dos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f589839d");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1041169");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-0310");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(125);

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/06/21");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/06/21");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:3.1%283a%29a");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i4%287%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i7%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.0%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1%280.2%29s0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.8%280.1%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.8%283.5%29s0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:9.9%280.902%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29" :
        {"versionEndIncluding" : "7.0%280%29hsk%280.357%29", "versionStartIncluding" : "7.0%280%29hsk%280.357%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1%280.2%29s0" :
        {"versionEndIncluding" : "8.1%280.2%29s0", "versionStartIncluding" : "8.1%280.2%29s0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.8%280.1%29" :
        {"versionEndIncluding" : "8.8%280.1%29", "versionStartIncluding" : "8.8%280.1%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.0%281%29" :
        {"versionEndIncluding" : "8.0%281%29", "versionStartIncluding" : "8.0%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.8%283.5%29s0" :
        {"versionEndIncluding" : "8.8%283.5%29s0", "versionStartIncluding" : "8.8%283.5%29s0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i4%287%29" :
        {"versionEndIncluding" : "7.0%283%29i4%287%29", "versionStartIncluding" : "7.0%283%29i4%287%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7%281%29" :
        {"versionEndIncluding" : "7.0%283%29i7%281%29", "versionStartIncluding" : "7.0%283%29i7%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:3.1%283a%29a" :
        {"versionEndIncluding" : "3.1%283a%29a", "versionStartIncluding" : "3.1%283a%29a", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:9.9%280.902%29" :
        {"versionEndIncluding" : "9.9%280.902%29", "versionStartIncluding" : "9.9%280.902%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
