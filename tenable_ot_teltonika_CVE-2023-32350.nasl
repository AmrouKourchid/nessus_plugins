#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502646);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/10/18");

  script_cve_id("CVE-2023-32350");
  script_xref(name:"ICSA", value:"23-131-08");

  script_name(english:"Teltonika Remote Management System and RUT Model Routers Improper Neutralization of Special Elements Used in an OS Command (CVE-2023-32350)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Versions 00.07.00 through 00.07.03 of Teltonika's RUT router firmware
contain an operating system (OS) command injection vulnerability in a
Lua service. An attacker could exploit a parameter in the vulnerable
function that calls a user-provided package name by instead providing
a package with a malicious name that contains an OS command injection
payload.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-23-131-08");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Teltonika recommends users update their devices to the latest versions.

- RMS services have already been updated to versions, which fix these vulnerabilities.
- Users can download the latest version of their respective RUT routers by navigating to the appropriate device on
Teltonikaâ€™s website.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-32350");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(78);

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/05/22");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/05/22");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/10/17");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:otd140_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rut100_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rut200_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rut300_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rut900_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rutm50_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rutx50_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rutm_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rutx_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:rutc50_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:teltonika-networks:tcr100_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Teltonika");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Teltonika');

var asset = tenable_ot::assets::get(vendor:'Teltonika');

var vuln_cpes = {
  "cpe:/o:teltonika-networks:otd140_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "OTD140"},
  "cpe:/o:teltonika-networks:rut100_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUT1"},
  "cpe:/o:teltonika-networks:rut200_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUT2"},
  "cpe:/o:teltonika-networks:rut300_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUT3"},
  "cpe:/o:teltonika-networks:rut900_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUT9"},
  "cpe:/o:teltonika-networks:rutm50_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUT5G"},
  "cpe:/o:teltonika-networks:rutx50_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUT5G"},
  "cpe:/o:teltonika-networks:rutm_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUTM"},
  "cpe:/o:teltonika-networks:rutx_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUTX"},
  "cpe:/o:teltonika-networks:rutc50_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "RUTC50"},
  "cpe:/o:teltonika-networks:tcr100_firmware" :
      {"versionStartIncluding": "00.07.00", "versionEndIncluding" : "00.07.03", "family" : "TCR100"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
