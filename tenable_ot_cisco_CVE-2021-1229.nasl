#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501395);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2021-1229");

  script_name(english:"Cisco NX-OS Software ICMP Version 6 Memory Leak Denial of Service (CVE-2021-1229)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in ICMP Version 6 (ICMPv6) processing in Cisco NX-OS
Software could allow an unauthenticated, remote attacker to cause a
slow system memory leak, which over time could lead to a denial of
service (DoS) condition. This vulnerability is due to improper error
handling when an IPv6-configured interface receives a specific type of
ICMPv6 packet. An attacker could exploit this vulnerability by sending
a sustained rate of crafted ICMPv6 packets to a local IPv6 address on
a targeted device. A successful exploit could allow the attacker to
cause a system memory leak in the ICMPv6 process on the device. As a
result, the ICMPv6 process could run out of system memory and stop
processing traffic. The device could then drop all ICMPv6 packets,
causing traffic instability on the device. Restoring device
functionality would require a device reboot.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fxos-nxos-icmpv6-dos-YD55jVCq
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?8147915b");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-1229");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(401);

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/02/24");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/02/24");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:15.1%282.31%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:5.2%281%29sv5%281.3a%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.4%283.53%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:5.2%281%29sv5%281.3a%29" :
        {"versionEndIncluding" : "5.2%281%29sv5%281.3a%29", "versionStartIncluding" : "5.2%281%29sv5%281.3a%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.4%283.53%29" :
        {"versionEndIncluding" : "8.4%283.53%29", "versionStartIncluding" : "8.4%283.53%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:15.1%282.31%29" :
        {"versionEndIncluding" : "15.1%282.31%29", "versionStartIncluding" : "15.1%282.31%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
