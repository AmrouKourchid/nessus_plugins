#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502677);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/18");

  script_cve_id("CVE-2024-9409");
  script_xref(name:"ICSA", value:"24-326-06");

  script_name(english:"Schneider Electric PowerLogic PM5300 Series Uncontrolled Resource Consumption (CVE-2024-9409)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"CWE-400: An Uncontrolled Resource Consumption vulnerability exists
that could cause the device to become unresponsive resulting in
communication loss when a large amount of IGMP packets is present in
the network.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://download.schneider-electric.com/doc/SEVD-2024-317-01/SEVD-2024-317-01.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?aaf746f0");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-24-326-06");
  script_set_attribute(attribute:"solution", value:
'The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Schneider Electric has identified the following remediations users can apply to reduce risk:

- PowerLogic PM5320: Version 2.4.0 of PowerLogic PM5320 includes a fix for this vulnerability.
- PowerLogic PM5340: Version 2.4.0 of PowerLogic PM5340 includes a fix for this vulnerability.
- PowerLogic PM5341: Version 2.7.0 of PowerLogic PM5341 includes a fix for this vulnerability.

If users choose not to apply the remediation provided above, Schneider Electric recommends immediately applying the
following steps to reduce the risk of exploitation:

- Enable IGMP Snooping: Ensure that IGMP Snooping is enabled on the switch. This feature allows the switch to
intelligently forward multicast traffic only to the necessary ports where interested hosts reside. It prevents
unnecessary flooding of multicast traffic across all ports, thereby enhancing network efficiency and minimizing
unnecessary load on network resources.
- Configure VLAN Interface Settings: Set up VLAN interface settings on the switch. It\'s important to have distinct
configurations for each VLAN to ensure proper IGMP operation.
- Multicast Filtering: Use IGMP filtering to control the propagation of IGMP traffic through the network. This involves
configuring filters on a switch virtual interface (SVI), per-port, or per-port per-VLAN basis. Multicast filtering helps
manage IGMP snooping and controls multicast traffic forwarding effectively.

Schneider Electric strongly recommend the following industry cybersecurity best practices:

- Locate control and safety system networks and remote devices behind firewalls and isolate them from the business
network.
- Install physical controls so no unauthorized personnel can access your industrial control and safety systems,
components, peripheral equipment, and networks.
- Place all controllers in locked cabinets and never leave them in the "Program" mode.
- Never connect programming software to any network other than the network intended for that device.
- Scan all methods of mobile data exchange with the isolated network such as CDs, USB drives, etc. before use in the
terminals or any node connected to these networks.
- Never allow mobile devices that have connected to any other network besides the intended network to connect to the
safety or control networks without proper sanitation.
- Minimize network exposure for all control system devices and systems and ensure that they are not accessible from the
Internet.
- When remote access is required, use secure methods, such as virtual private networks (VPNs). Recognize that VPNs may
have vulnerabilities and should be updated to the most current versionavailable. Also, understand that VPNs are only as
secure as the connected devices.

For more information refer to the Schneider Electric Recommended Cybersecurity Best Practices document and the
associated Schneider Electric Security Notification SEVD-2024-317-01 in PDF and CSAF.');
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-9409");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/11/13");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/11/13");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/11/19");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:powerlogic_pm5320_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:powerlogic_pm5340_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:powerlogic_pm5341_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Schneider");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Schneider');

var asset = tenable_ot::assets::get(vendor:'Schneider');

var vuln_cpes = {
    "cpe:/o:schneider-electric:powerlogic_pm5341_firmware" :
        {"versionEndExcluding" : "2.7.0", "family" : "PowerLogicPM"},
    "cpe:/o:schneider-electric:powerlogic_pm5340_firmware" :
        {"versionEndExcluding" : "2.4.0", "family" : "PowerLogicPM"},
    "cpe:/o:schneider-electric:powerlogic_pm5320_firmware" :
        {"versionEndExcluding" : "2.4.0", "family" : "PowerLogicPM"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
