##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500067);
  script_version("1.15");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/26");

  script_cve_id("CVE-2019-12258");
  script_xref(name:"ICSA", value:"19-274-01");
  script_xref(name:"ICSA", value:"19-211-01");
  script_xref(name:"ICSA", value:"23-320-10");
  script_xref(name:"CEA-ID", value:"CEA-2019-0679");

  script_name(english:"Siemens Improper Neutralization of Argument Delimiters in a Command in Wind River VxWorks (CVE-2019-12258)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Wind River VxWorks 6.6 through vx7 has Session Fixation in the TCP component. This is a IPNET security vulnerability:
DoS of TCP connection via malformed TCP options.  

This plugin only works with Tenable.ot. Please visit
https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://support2.windriver.com/index.php?page=security-notices");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-19-274-01");
  # https://support2.windriver.com/index.php?page=cve&on=view&id=CVE-2019-12258
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?17c9f3ec");
  # https://www.windriver.com/security/announcements/tcp-ip-network-stack-ipnet-urgent11/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c7d3d59d");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-632562.pdf");
  script_set_attribute(attribute:"see_also", value:"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2019-0009");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20190802-0001/");
  script_set_attribute(attribute:"see_also", value:"https://support.f5.com/csp/article/K41190253");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-189842.pdf");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-352504.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-19-211-01");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-617233.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-23-320-10"); 
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Wind River has produced controls and patches to mitigate the reported vulnerabilities. To obtain patches, email
PSIRT@windriver.com and indicate the VxWorks major version for which you need source patches.

For more detailed information on the vulnerabilities and the mitigating controls, please see the Wind River advisory at:
https://www.windriver.com/security/announcements/tcp-ip-network-stack-ipnet-urgent11/

Additional vendors affected by the reported vulnerabilities have also released security advisories related to their
affected products. Those advisories are as follows:

Rockwell Automation (login required) - https://rockwellautomation.custhelp.com/app/answers/detail/a_id/1088561

Xerox - https://security.business.xerox.com/en-us/news/wind-river-vxworks-ipnet-tcp-ip-stack-vulnerabilities/

Dräger – https://static.draeger.com/security

Schneider Electric – https://www.se.com/ww/en/download/document/SESB-2019-214-01/");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-12258");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(384);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/08/09");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/08/09");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md84_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6md89_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_6mu85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ke85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sk85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ss85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7st85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7st86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sx85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7um85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut86_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ve85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7vk87_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7vu85_%28cp300%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sa82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sd82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj81_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sj82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sk82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7sl82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_7ut82_%28cp100%29_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_4_7sj66_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_communication_module_eth-ba-2el_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_communication_module_eth-bb-2fo_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siprotec_5_communication_module_eth-bd-2fo_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:siprotec_5_6md84_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6md85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6md86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6md89_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_6mu85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ke85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ss85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7st85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7st86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7um85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ve85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7vu85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sk85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sx85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut85_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut86_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7vk87_%28cp300%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sa82_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sd82_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sl82_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7ut82_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj81_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sj82_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_7sk82_%28cp100%29_firmware" :
        {"versionEndExcluding" : "8.01", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_4_7sj66_firmware" :
        {"versionEndExcluding" : "4.41", "family" : "Siprotec4"},
    "cpe:/o:siemens:siprotec_5_communication_module_eth-ba-2el_firmware" :
        {"versionEndExcluding" : "7.91", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_communication_module_eth-bb-2fo_firmware" :
        {"versionEndExcluding" : "7.91", "family" : "Siprotec5"},
    "cpe:/o:siemens:siprotec_5_communication_module_eth-bd-2fo_firmware" :
        {"versionEndExcluding" : "7.91", "family" : "Siprotec5"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
