#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500443);
  script_version("1.10");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2020-6111");
  script_xref(name:"ICSA", value:"21-047-02");

  script_name(english:"Rockwell Automation Allen-Bradley Micrologix 1100 Improper Handling of Length Parameter Inconsistency (CVE-2020-6111)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"An exploitable denial-of-service vulnerability exists in the IPv4 functionality of Allen-Bradley MicroLogix 1100
Programmable Logic Controller Systems Series B FRN 16.000, Series B FRN 15.002, Series B FRN 15.000, Series B FRN
14.000, Series B FRN 13.000, Series B FRN 12.000, Series B FRN 11.000 and Series B FRN 10.000. A specially crafted
packet can cause a major error, resulting in a denial of service. An attacker can send a malicious packet to trigger
this vulnerability.  

This plugin only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot
for more information.");
  script_set_attribute(attribute:"see_also", value:"https://talosintelligence.com/vulnerability_reports/TALOS-2020-1057");
  script_set_attribute(attribute:"see_also", value:"https://us-cert.cisa.gov/ics/advisories/icsa-21-047-02");
  # https://www.rockwellautomation.com/en-us/support/advisory.PN1548.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?fca36620");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Rockwell Automation recommends users of MicroLogix 1100 migrate to MicroLogix 1400 and apply firmware v21.006 or later.
Please see Rockwell Automationâ€™s publication number, PN1548, for more information. Rockwell Automation recommends the
following network-based vulnerability mitigations for embedded products:

- Utilize proper network infrastructure controls, such as firewalls, to help ensure traffic from unauthorized sources is
blocked.
- Consult the product documentation for specific features, such as a hardware key mode setting, to which may be used to
block unauthorized changes, etc.
- Block all traffic to EtherNet/IP or other CIP protocol-based devices from outside the manufacturing zone by blocking
or restricting access to TCP and UDP Port 2222 and Port 44818 using proper network infrastructure controls, such as
firewalls, UTM devices, or other security appliances. For more information on TCP/UDP ports used by Rockwell Automation
products, see Knowledgebase Article ID BF7490

Rockwell Automation also recommends the following general mitigations:

- Minimize network exposure for all control system devices and/or systems and ensure they are not accessible from the
Internet. For further information about the risks of unprotected Internet accessible control systems, please see
Knowledgebase Article ID PN715
- Locate control system networks and devices behind firewalls and isolate them from the business network.
- When remote access is required, use secure methods, such as virtual private networks (VPNs), recognizing that VPNs may
have vulnerabilities and should be updated to the most current version available. Also recognize a VPN is only as secure
as the connected devices.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2020-6111");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2020/12/03");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/12/03");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:micrologix_1100_b_firmware:10.000");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:micrologix_1100_b_firmware:11.000");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:micrologix_1100_b_firmware:12.000");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:micrologix_1100_b_firmware:13.000");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:micrologix_1100_b_firmware:14.000");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:micrologix_1100_b_firmware:15.000");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:micrologix_1100_b_firmware:15.002");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:rockwellautomation:micrologix_1100_b_firmware:16.000");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Rockwell");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Rockwell');

var asset = tenable_ot::assets::get(vendor:'Rockwell');

var vuln_cpes = {
    "cpe:/o:rockwellautomation:micrologix_1100_b_firmware:10.000" :
        {"versionEndIncluding" : "10.000", "versionStartIncluding" : "10.000", "family" : "MicroLogix1100"},
    "cpe:/o:rockwellautomation:micrologix_1100_b_firmware:11.000" :
        {"versionEndIncluding" : "11.000", "versionStartIncluding" : "11.000", "family" : "MicroLogix1100"},
    "cpe:/o:rockwellautomation:micrologix_1100_b_firmware:12.000" :
        {"versionEndIncluding" : "12.000", "versionStartIncluding" : "12.000", "family" : "MicroLogix1100"},
    "cpe:/o:rockwellautomation:micrologix_1100_b_firmware:13.000" :
        {"versionEndIncluding" : "13.000", "versionStartIncluding" : "13.000", "family" : "MicroLogix1100"},
    "cpe:/o:rockwellautomation:micrologix_1100_b_firmware:14.000" :
        {"versionEndIncluding" : "14.000", "versionStartIncluding" : "14.000", "family" : "MicroLogix1100"},
    "cpe:/o:rockwellautomation:micrologix_1100_b_firmware:15.000" :
        {"versionEndIncluding" : "15.000", "versionStartIncluding" : "15.000", "family" : "MicroLogix1100"},
    "cpe:/o:rockwellautomation:micrologix_1100_b_firmware:15.002" :
        {"versionEndIncluding" : "15.002", "versionStartIncluding" : "15.002", "family" : "MicroLogix1100"},
    "cpe:/o:rockwellautomation:micrologix_1100_b_firmware:16.000" :
        {"versionEndIncluding" : "16.000", "versionStartIncluding" : "16.000", "family" : "MicroLogix1100"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
