#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501473);
  script_version("1.8");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/11/25");

  script_cve_id("CVE-2020-14511");
  script_xref(name:"ICSA", value:"20-196-02");

  script_name(english:"Moxa EDR-G902 and EDR-G903 Series Routers Stack-Based Buffer Overflow (CVE-2020-14511)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Malicious operation of the crafted web browser cookie may cause a
stack-based buffer overflow in the system web server on the EDR-G902
and EDR-G903 Series Routers (versions prior to 5.4).

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://us-cert.cisa.gov/ics/advisories/icsa-20-196-02");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Moxa recommends users implement the following to mitigate the vulnerability:

- Install firmware patch. Patches may be downloaded from Moxa’s security advisory page.

Please see Moxa’s security advisory for more information.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2020-14511");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(121, 787);

  script_set_attribute(attribute:"vuln_publication_date", value:"2020/07/15");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/07/15");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/08/02");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:edr-g902-t_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:edr-g902_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:edr-g903-t_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:moxa:edr-g903_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Moxa");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Moxa');

var asset = tenable_ot::assets::get(vendor:'Moxa');

var vuln_cpes = {
    "cpe:/o:moxa:edr-g902-t_firmware" :
        {"versionEndIncluding" : "5.4", "family" : "EDR"},
    "cpe:/o:moxa:edr-g902_firmware" :
        {"versionEndIncluding" : "5.4", "family" : "EDR"},
    "cpe:/o:moxa:edr-g903-t_firmware" :
        {"versionEndIncluding" : "5.4", "family" : "EDR"},
    "cpe:/o:moxa:edr-g903_firmware" :
        {"versionEndIncluding" : "5.4", "family" : "EDR"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
