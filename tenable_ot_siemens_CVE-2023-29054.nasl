#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501076);
  script_version("1.7");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/10");

  script_cve_id("CVE-2023-29054");
  script_xref(name:"ICSA", value:"23-103-05");

  script_name(english:"Siemens SCALANCE X-200IRT Devices Inadequate Encryption Strength (CVE-2023-29054)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in SCALANCE X200-4P IRT (All
versions < V5.5.2), SCALANCE X201-3P IRT (All versions < V5.5.2),
SCALANCE X201-3P IRT PRO (All versions < V5.5.2), SCALANCE X202-2IRT
(All versions < V5.5.2), SCALANCE X202-2IRT (All versions < V5.5.2),
SCALANCE X202-2P IRT (All versions < V5.5.2), SCALANCE X202-2P IRT PRO
(All versions < V5.5.2), SCALANCE X204IRT (All versions < V5.5.2),
SCALANCE X204IRT (All versions < V5.5.2), SCALANCE X204IRT PRO (All
versions < V5.5.2), SCALANCE XF201-3P IRT (All versions < V5.5.2),
SCALANCE XF202-2P IRT (All versions < V5.5.2), SCALANCE XF204-2BA IRT
(All versions < V5.5.2), SCALANCE XF204IRT (All versions < V5.5.2),
SIPLUS NET SCALANCE X202-2P IRT (All versions < V5.5.2). The SSH
server on affected devices is configured to offer weak ciphers by
default. This could allow an unauthorized attacker in a man-in-the-
middle position to read and modify any data passed over the connection
between legitimate clients and the affected device.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-479249.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-23-103-05");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has released updates for the affected products and recommends updating to the latest versions: 

- Update all affected products to V5.5.2 or later.

Siemens has identified the following specific workarounds and mitigations that customers can apply to reduce the risk
identified in the vulnerability overview:

- Configure the SSH clients to use strong key exchange ciphers. 
- Add only trusted SSH client public keys to the responding operating system (ROS) and allow access to those clients
only.

As a general security measure, Siemens recommends protecting network access to devices with appropriate mechanisms. To
operate the devices in a protected IT environment, Siemens recommends configuring the environment according to Siemensâ€™
operational guidelines for industrial security and following recommendations in the product manuals.

Additional information on industrial security by Siemens can be found on the Siemens industrial security webpage. 

For more information, see the associated Siemens security advisory SSA-479249 in HTML and CSAF.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:H/Au:N/C:C/I:C/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-29054");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(326);

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/04/11");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/04/11");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/04/21");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x200-4p_irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x201-3p_irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x201-3p_irt_pro_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x202-2irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x202-2p_irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x202-2p_irt_pro_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x204irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x204irt_pro_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xf201-3p_irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xf202-2p_irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xf204-2ba_irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xf204irt_firmware:5.5.2");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_net_scalance_x202-2p_irt_firmware:5.5.2");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:scalance_x200-4p_irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5200-4AH00-2BA3']},
    "cpe:/o:siemens:scalance_x201-3p_irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5201-3BH00-2BA3']},
    "cpe:/o:siemens:scalance_x201-3p_irt_pro_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5201-3JR00-2BA6']},
    "cpe:/o:siemens:scalance_x202-2irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5202-2BB00-2BA3', '6GK5202-2BB10-2BA3']},
    "cpe:/o:siemens:scalance_x202-2p_irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5202-2BH00-2BA3']},
    "cpe:/o:siemens:scalance_x202-2p_irt_pro_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5202-2JR00-2BA6']},
    "cpe:/o:siemens:scalance_x204irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5204-0BA00-2BA3', '6GK5204-0BA10-2BA3']},
    "cpe:/o:siemens:scalance_x204irt_pro_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5204-0JA00-2BA6']},
    "cpe:/o:siemens:scalance_xf201-3p_irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5201-3BH00-2BD2']},
    "cpe:/o:siemens:scalance_xf202-2p_irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5202-2BH00-2BD2']},
    "cpe:/o:siemens:scalance_xf204-2ba_irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5204-2AA00-2BD2']},
    "cpe:/o:siemens:scalance_xf204irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6GK5204-0BA00-2BF2']},
    "cpe:/o:siemens:siplus_net_scalance_x202-2p_irt_firmware:5.5.2" :
        {"versionEndExcluding" : "5.5.2", "family" : "SCALANCEX200IRT", "orderNumbers" : ['6AG1202-2BH00-2BA3']}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
