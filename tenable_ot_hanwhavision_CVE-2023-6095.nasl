#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502276);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/06/27");

  script_cve_id("CVE-2023-6095");

  script_name(english:"Hanwha Vision NVR Remote Code Execution (CVE-2023-6095)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"An attacker could inject arbitrary attack code by manipulating 
HTTP headers. However, in order to succeed in the attack, the 
base address of the stack memory must be obtained. The 
default address depends on firmware version, configuration 
option information, and the attack is unlikely to succeed. 
Nevertheless, we believe that this vulnerability has a 
significant impact on the product because it allows arbitrary 
attacks without authentication.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.hanwhavision.com/wp-content/uploads/2024/04/NVR-DVR-Vulnerability-Report-CVE-2023-6095-6096.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0ea92113");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss3_base_vector("CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-6095");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/04/26");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/04/26");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/06/26");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-2010_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-2011_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-3010_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-2010a_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-2011a_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-3010a_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:arn-3250_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-810s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-410s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:qrn-810_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:qrn-410_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:hrx-1621_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:hrx-1620_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:hrx-821_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:hrx-820_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:hrx-421_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:hrx-420_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:xrn-420s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:hanwhavision:qrn-430s_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/HanwhaVision");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/HanwhaVision');

var asset = tenable_ot::assets::get(vendor:'HanwhaVision');

var vuln_cpes = {
    "cpe:/o:hanwhavision:xrn-2010_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:xrn-2011_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:xrn-3010_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:xrn-2010a_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:xrn-2011a_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:xrn-3010a_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:arn-3250_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:xrn-810s_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:xrn-410s_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:qrn-810_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:qrn-410_firmware" :
        {"versionEndIncluding" : "2.46", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:hrx-1621_firmware" :
        {"versionEndIncluding" : "3.05.62", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:hrx-1620_firmware" :
        {"versionEndIncluding" : "3.05.62", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:hrx-821_firmware" :
        {"versionEndIncluding" : "3.05.62", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:hrx-820_firmware" :
        {"versionEndIncluding" : "3.05.62", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:hrx-421_firmware" :
        {"versionEndIncluding" : "3.05.62", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:hrx-420_firmware" :
        {"versionEndIncluding" : "3.05.62", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:xrn-420s_firmware" :
        {"versionEndIncluding" : "5.01.52", "family" : "HanwhaVideoRecorders"},
    "cpe:/o:hanwhavision:qrn-430s_firmware" :
        {"versionEndIncluding" : "5.01.52", "family" : "HanwhaVideoRecorders"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_NOTE);
