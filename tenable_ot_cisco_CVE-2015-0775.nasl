#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501307);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/12/25");

  script_cve_id("CVE-2015-0775");

  script_name(english:"Cisco Nexus and Cisco Multilayer Director Switches MOTD Telnet Login Reset (CVE-2015-0775)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The banner (aka MOTD) implementation in Cisco NX-OS 4.1(2)E1(1f) on
Nexus 4000 devices, 5.2(1)SV3(2.1) on Nexus 1000V devices, 6.0(2)N2(2)
on Nexus 5000 devices, 6.2(11) on MDS 9000 devices, 6.2(12) on Nexus
7000 devices, 7.0(3) on Nexus 9000 devices, and 7.2(0)ZN(99.67) on
Nexus 3000 devices allows remote attackers to cause a denial of
service (login process reset) via an unspecified terminal-session
request during TELNET session setup, aka Bug IDs CSCuo10554,
CSCuu75466, CSCuu75471, CSCuu75484, CSCuu75498, CSCuu77170, and
CSCuu77182.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://tools.cisco.com/security/center/viewAlert.x?alertId=39280");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1032561");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1032562");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2015-0775");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(399);

  script_set_attribute(attribute:"vuln_publication_date", value:"2015/06/12");
  script_set_attribute(attribute:"patch_publication_date", value:"2015/06/12");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:mds_9000_nx-os:6.2%2811%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:4.1%282%29e1%281f%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.0%282%29n2%282%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:6.2%2812%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.2%280%29zn%2899.67%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:4.1%282%29e1%281f%29" :
        {"versionEndIncluding" : "4.1%282%29e1%281f%29", "versionStartIncluding" : "4.1%282%29e1%281f%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.2%280%29zn%2899.67%29" :
        {"versionEndIncluding" : "7.2%280%29zn%2899.67%29", "versionStartIncluding" : "7.2%280%29zn%2899.67%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.0%282%29n2%282%29" :
        {"versionEndIncluding" : "6.0%282%29n2%282%29", "versionStartIncluding" : "6.0%282%29n2%282%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:6.2%2812%29" :
        {"versionEndIncluding" : "6.2%2812%29", "versionStartIncluding" : "6.2%2812%29", "family" : "NXOS"},
    "cpe:/o:cisco:mds_9000_nx-os:6.2%2811%29" :
        {"versionEndIncluding" : "6.2%2811%29", "versionStartIncluding" : "6.2%2811%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
