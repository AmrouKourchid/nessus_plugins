#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501358);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/10/19");

  script_cve_id("CVE-2021-34714");

  script_name(english:"Cisco Multiple Operating Systems Unidirectional Link Detection Denial of Service (CVE-2021-34714)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Unidirectional Link Detection (UDLD) feature of
Cisco FXOS Software, Cisco IOS Software, Cisco IOS XE Software, Cisco
IOS XR Software, and Cisco NX-OS Software could allow an
unauthenticated, adjacent attacker to cause an affected device to
reload. This vulnerability is due to improper input validation of the
UDLD packets. An attacker could exploit this vulnerability by sending
specifically crafted UDLD packets to an affected device. A successful
exploit could allow the attacker to cause the affected device to
reload, resulting in a denial of service (DoS) condition. Note: The
UDLD feature is disabled by default, and the conditions to exploit
this vulnerability are strict. An attacker must have full control of a
directly connected device. On Cisco IOS XR devices, the impact is
limited to the reload of the UDLD process.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ios-nxos-xr-udld-dos-W5hGHgtQ
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bec5ced8");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:M/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-34714");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/09/23");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/09/23");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:3");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:8" :
        {"versionEndIncluding" : "8.4%283.115%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29" :
        {"versionEndIncluding" : "7.0%283%29i7%289%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.3%288%29" :
        {"versionEndIncluding" : "7.3%288%29n1%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:3" :
        {"versionEndIncluding" : "3.2%283o%29a", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
