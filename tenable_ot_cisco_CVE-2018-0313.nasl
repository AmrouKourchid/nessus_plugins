#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501387);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2018-0313");

  script_name(english:"Cisco NX-OS Software NX-API Arbitrary Command Execution (CVE-2018-0313)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the NX-API feature of Cisco NX-OS Software could
allow an authenticated, remote attacker to send a malicious packet to
the management interface on an affected system and execute a command-
injection exploit. The vulnerability is due to incorrect input
validation of user-supplied data to the NX-API subsystem. An attacker
could exploit this vulnerability by sending a malicious HTTP or HTTPS
packet to the management interface of an affected system that has the
NX-API feature enabled. A successful exploit could allow the attacker
to execute arbitrary commands with root privileges. Note: NX-API is
disabled by default. This vulnerability affects MDS 9000 Series
Multilayer Switches, Nexus 2000 Series Fabric Extenders, Nexus 3000
Series Switches, Nexus 3500 Platform Switches, Nexus 5500 Platform
Switches, Nexus 5600 Platform Switches, Nexus 6000 Series Switches,
Nexus 7000 Series Switches, Nexus 7700 Series Switches, Nexus 9000
Series Switches in standalone NX-OS mode, Nexus 9500 R-Series Line
Cards and Fabric Modules. Cisco Bug IDs: CSCvd47415, CSCve03216,
CSCve03224, CSCve03234.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1041169");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180620-nx-os-api-execution
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1f5cb16d");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-0313");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(74);

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/06/21");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/06/21");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.0%281%29s20");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1%280%29bd%280.20%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1%280.97%29s0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1%281%29s5");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29" :
        {"versionEndIncluding" : "7.0%280%29hsk%280.357%29", "versionStartIncluding" : "7.0%280%29hsk%280.357%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.0%281%29s20" :
        {"versionEndIncluding" : "8.0%281%29s20", "versionStartIncluding" : "8.0%281%29s20", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1%280%29bd%280.20%29" :
        {"versionEndIncluding" : "8.1%280%29bd%280.20%29", "versionStartIncluding" : "8.1%280%29bd%280.20%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1%280.97%29s0" :
        {"versionEndIncluding" : "8.1%280.97%29s0", "versionStartIncluding" : "8.1%280.97%29s0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1%281%29s5" :
        {"versionEndIncluding" : "8.1%281%29s5", "versionStartIncluding" : "8.1%281%29s5", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
