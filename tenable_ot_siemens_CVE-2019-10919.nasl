#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501662);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/04");

  script_cve_id("CVE-2019-10919");
  script_xref(name:"ICSA", value:"19-134-04");

  script_name(english:"Siemens LOGO! 8 BM Missing Authentication For Critical Function (CVE-2019-10919)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in LOGO! 8 BM (incl. SIPLUS
variants) (All versions < V8.3). Attackers with access to port
10005/tcp could perform device reconfigurations and obtain project
files from the devices. The system manual recommends to protect access
to this port. The security vulnerability could be exploited by an
unauthenticated attacker with network access to port 10005/tcp. No
user interaction is required to exploit this security vulnerability.
The vulnerability impacts confidentiality, integrity, and availability
of the device. At the time of advisory publication no public
exploitation of this security vulnerability was known.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-542701.pdf");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/108382");
  script_set_attribute(attribute:"see_also", value:"https://seclists.org/bugtraq/2019/May/73");
  # http://packetstormsecurity.com/files/153123/Siemens-LOGO-8-Missing-Authentication.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?6922dc71");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2019/May/45");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-19-134-04");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has released an update for the LOGO! 8 BM (update to v8.3) and recommends that customers update to the latest
version.. Notice that in order to update, a new hardware version is required.

To reduce risk, Siemens recommends that users apply defense-in-depth concepts, including protection concept outlined in
the system manual.

As a general security measure, Siemens strongly recommends protecting network access to devices with appropriate
mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends configuring the
environment according to Siemensâ€™ operational guidelines for industrial security and following the recommendations in
the product manuals.

Additional information on industrial security for Siemens devices can be found at:
https://www.siemens.com/industrialsecurity

For more information on these vulnerabilities and more detailed mitigation instructions, please see Siemens Security
Advisory SSA-542701");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:POC/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:P/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-10919");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(306);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/05/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/05/14");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/09/21");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%218_bm_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:logo%218_bm_firmware" :
        {"versionEndExcluding" : "8.3", "family" : "LOGO!BM"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
