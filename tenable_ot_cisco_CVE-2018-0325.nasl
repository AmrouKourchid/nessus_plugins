#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502155);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/03/18");

  script_cve_id("CVE-2018-0325");

  script_name(english:"Cisco IP Phones 7800 Series and 8800 Series and Cisco Wireless IP Phone 8821 Denial of Service (CVE-2018-0325)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Session Initiation Protocol (SIP) call-handling
functionality of Cisco IP Phone 7800 Series phones and Cisco IP Phone
8800 Series phones could allow an unauthenticated, remote attacker to
cause a denial of service (DoS) condition on an affected phone. The
vulnerability is due to incomplete input validation of SIP Session
Description Protocol (SDP) parameters by the SDP parser of an affected
phone. An attacker could exploit this vulnerability by sending a
malformed SIP packet to an affected phone. A successful exploit could
allow the attacker to cause all active phone calls on the affected
phone to be dropped while the SIP process on the phone unexpectedly
restarts, resulting in a DoS condition. Cisco Bug IDs: CSCvf40066.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/104202");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1040927");
  # https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180516-ip-phone-dos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4de5a083");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-0325");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/05/17");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/05/17");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/03/18");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_7800_series_firmware:12.0%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_8800_series_firmware:12.0%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_8800_series_firmware:11.0%284.14%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_8821_firmware:11.0%284.14%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_8800_series_firmware:11.0%283%29SR6015");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_8821_firmware:11.0%283%29SR6015");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_7800_series_firmware:10.3%281%29SR4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_8800_series_firmware:10.3%281%29SR4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ip_phone_8831_firmware:10.3%281%29SR4");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:ip_phone_7800_series_firmware:12.0%281%29" :
        {"versionEndIncluding" : "12.0%281%29", "versionStartIncluding" : "12.0%281%29", "family" : "CiscoIPPhones"},
    "cpe:/o:cisco:ip_phone_8800_series_firmware:12.0%281%29" :
        {"versionEndIncluding" : "12.0%281%29", "versionStartIncluding" : "12.0%281%29", "family" : "CiscoIPPhones"},
    "cpe:/o:cisco:ip_phone_8800_series_firmware:11.0%284.14%29" :
        {"versionEndIncluding" : "11.0%284.14%29", "versionStartIncluding" : "11.0%284.14%29", "family" : "CiscoIPPhones"},
    "cpe:/o:cisco:ip_phone_8821_firmware:11.0%284.14%29" :
        {"versionEndIncluding" : "11.0%284.14%29", "versionStartIncluding" : "11.0%284.14%29", "family" : "CiscoIPPhones"},
    "cpe:/o:cisco:ip_phone_8800_series_firmware:11.0%283%29SR6015" :
        {"versionEndIncluding" : "11.0%283%29SR6015", "versionStartIncluding" : "11.0%283%29SR6015", "family" : "CiscoIPPhones"},
    "cpe:/o:cisco:ip_phone_8821_firmware:11.0%283%29SR6015" :
        {"versionEndIncluding" : "11.0%283%29SR6015", "versionStartIncluding" : "11.0%283%29SR6015", "family" : "CiscoIPPhones"},
    "cpe:/o:cisco:ip_phone_7800_series_firmware:10.3%281%29SR4" :
        {"versionEndIncluding" : "10.3%281%29SR4", "versionStartIncluding" : "10.3%281%29SR4", "family" : "CiscoIPPhones"},
    "cpe:/o:cisco:ip_phone_8800_series_firmware:11.0%283%29SR6015" :
        {"versionEndIncluding" : "10.3%281%29SR4", "versionStartIncluding" : "10.3%281%29SR4", "family" : "CiscoIPPhones"},
    "cpe:/o:cisco:ip_phone_8831_firmware:10.3%281%29SR4" :
        {"versionEndIncluding" : "10.3%281%29SR4", "versionStartIncluding" : "10.3%281%29SR4", "family" : "CiscoIPPhones"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
