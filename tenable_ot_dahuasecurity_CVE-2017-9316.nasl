#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502349);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/19");

  script_cve_id("CVE-2017-9316");

  script_name(english:"Dahua Security Cameras Improper Authentication (CVE-2017-9316)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Firmware upgrade authentication bypass vulnerability was found in
Dahua IPC-HDW4300S and some IP products. The vulnerability was caused
by internal Debug function. This particular function was used for
problem analysis and performance tuning during product development
phase. It allowed the device to receive only specific data (one
direction, no transmit) and therefore it was not involved in any
instance of collecting user privacy data or allowing remote code
execution.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://www.dahuasecurity.com/aboutUs/trustedCenter/details/492");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-9316");
  script_set_attribute(attribute:"cvss3_score_rationale", value:"Scoring adjustsed to align with CVSS 3.1 attack complexity guidance.");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(287);

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/11/27");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/11/27");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/07/29");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:dahuasecurity:ipc-hdw4300s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:dahuasecurity:ipc-hfw4x00_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:dahuasecurity:ipc-hdw4x00_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:dahuasecurity:ipc-hdbw4x00_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:dahuasecurity:ipc-hf5x00_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:dahuasecurity:ipc-hfw5x00_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:dahuasecurity:ipc-hdw5x00_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:dahuasecurity:ipc-hdbw5x00_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/DahuaSecurity");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/DahuaSecurity');

var asset = tenable_ot::assets::get(vendor:'DahuaSecurity');

var vuln_cpes = {
    "cpe:/o:dahuasecurity:ipc-hdw4300s_firmware" :
        {"versionEndIncluding" : "v2.420.0008.0.r.20150710", "versionStartIncluding" : "v2.240.0009.0.r.20131015", "family" : "DahuaSecurityCameras"},
    "cpe:/o:dahuasecurity:ipc-hfw4x00_firmware" :
        {"versionEndIncluding" : "v2.420.0008.0.r.20150710", "versionStartIncluding" : "v2.420.0006.0.r.20150311", "family" : "DahuaSecurityCameras"},
    "cpe:/o:dahuasecurity:ipc-hdw4x00_firmware" :
        {"versionEndIncluding" : "v2.420.0008.0.r.20150710", "versionStartIncluding" : "v2.420.0006.0.r.20150311", "family" : "DahuaSecurityCameras"},
    "cpe:/o:dahuasecurity:ipc-hdbw4x00_firmware" :
        {"versionEndIncluding" : "v2.420.0008.0.r.20150710", "versionStartIncluding" : "v2.420.0006.0.r.20150311", "family" : "DahuaSecurityCameras"},
    "cpe:/o:dahuasecurity:ipc-hf5x00_firmware" :
        {"versionEndIncluding" : "v2.420.0008.0.r.20150710", "versionStartIncluding" : "v2.420.0006.0.r.20150311", "family" : "DahuaSecurityCameras"},
    "cpe:/o:dahuasecurity:ipc-hfw5x00_firmware" :
        {"versionEndIncluding" : "v2.420.0008.0.r.20150710", "versionStartIncluding" : "v2.420.0006.0.r.20150311", "family" : "DahuaSecurityCameras"},
    "cpe:/o:dahuasecurity:ipc-hdw5x00_firmware" :
        {"versionEndIncluding" : "v2.420.0008.0.r.20150710", "versionStartIncluding" : "v2.420.0006.0.r.20150311", "family" : "DahuaSecurityCameras"},
    "cpe:/o:dahuasecurity:ipc-hdbw5x00_firmware" :
        {"versionEndIncluding" : "v2.420.0008.0.r.20150710", "versionStartIncluding" : "v2.420.0006.0.r.20150311", "family" : "DahuaSecurityCameras"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
