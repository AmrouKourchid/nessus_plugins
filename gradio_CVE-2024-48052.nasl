#%NASL_MIN_LEVEL 80900

##
# Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(213706);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/07");

  script_cve_id("CVE-2024-48052");

  script_name(english:"Gradio < 4.42.0 SSRF");

  script_set_attribute(attribute:"synopsis", value:
"The remote host is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The version of Gradio installed on the remote host is prior to 4.42.0. It is, therefore, affected by a
hidden server-side request forgery (SSRF) vulnerability. The reason is that within the save_url_to_cache function, 
there are no restrictions on the URL, which allows access to local target resources. This can lead to the download 
of local resources and sensitive information.

    Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version number.");
  script_set_attribute(attribute:"see_also", value:"https://github.com/advisories/GHSA-3gf9-wv65-gwh9");
  # https://rumbling-slice-eb0.notion.site/FULL-SSRF-in-gr-DownloadButton-in-gradio-app-gradio-870b21e0908b48cbafd914719ac1a4e6?pvs=4
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?08dc1b14");
  script_set_attribute(attribute:"see_also", value:"https://gist.github.com/AfterSnows/45ffc23797f9127e00755376cc610e12");
  script_set_attribute(attribute:"solution", value:
"Upgrade to Gradio version 4.42.0 or later.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:C/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-48052");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(918);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/11/04");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/11/04");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/01/10");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"agent", value:"all");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:gradio-app:gradio");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Artificial Intelligence");
 
  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");
  
  script_dependencies("python_gradio_detect.nasl", "gradio_ui_detect.nasl");
  script_require_keys("installed_sw/Gradio");

  exit(0);
}

include('vcf.inc');

var app_info = vcf::combined_get_app_info(app:'Gradio');
var constraints = [
    { 'fixed_version':'4.42.0' },
];

vcf::check_version_and_report(app_info:app_info, constraints:constraints, severity:SECURITY_WARNING);
        