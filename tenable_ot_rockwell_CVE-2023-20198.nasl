#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501759);
  script_version("1.8");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/18");

  script_cve_id("CVE-2023-20198");
  script_xref(name:"ICSA", value:"23-297-01");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2023/10/20");
  script_xref(name:"CEA-ID", value:"CEA-2023-0053");

  script_name(english:"Rockwell Automation Stratix 5800 & 5200 Cisco IOS XE Web UI Privilege Escalation (CVE-2023-20198)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"This vulnerability in the Web UI feature of Cisco IOS XE Software allows a remote, 
unauthenticated threat actor to create an account on a vulnerable system 
with privilege level 15 access. The threat actor could then potentially use 
that account to gain control of the affected system.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.rockwellautomation.com/en-us/support/advisory.PN1653.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1506d35e");
  # https://www.cisa.gov/news-events/ics-advisories/icsa-23-297-01
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?059a6d2a");
  # https://www.rockwellautomation.com/en-us/support/advisory.PN1653.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1506d35e");
  script_set_attribute(attribute:"solution", value:
"Rockwell strongly encourages customers to follow guidance disabling 
Stratix HTTP servers on all internet-facing systems. See Rockwell Automation's 
security advisory for more information.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-20198");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_set_attribute(attribute:"exploit_framework_core", value:"true");
  script_set_attribute(attribute:"metasploit_name", value:'Cisco IOX XE Unauthenticated RCE Chain');
  script_set_attribute(attribute:"exploit_framework_metasploit", value:"true");

  script_set_attribute(attribute:"plugin_publication_date", value:"2023/10/24");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:rockwellautomation:allen-bradley_stratix_5200");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:rockwellautomation:allen-bradley_stratix_5800");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Rockwell");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Rockwell');

var asset = tenable_ot::assets::get(vendor:'Rockwell');

var vuln_cpes = {
    "cpe:/h:rockwellautomation:allen-bradley_stratix_5200" :
        {"family" : "Stratix"},
    "cpe:/h:rockwellautomation:allen-bradley_stratix_5800" :
        {"family" : "Stratix"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);