#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500681);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/03/25");

  script_cve_id("CVE-2022-34821");

  script_name(english:"Siemens Multiple Vulnerabilities in SCALANCE Products (CVE-2022-34821)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Multiple SCALANCE devices are affected by several vulnerabilities that could 
allow an attacker to inject code, retrieve data as debug information as 
well as user CLI passwords or set the CLI to an irresponsive state. 
Siemens has released updates for the affected products and recommends 
to update to the latest versions. 

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://cert-portal.siemens.com/productcert/html/ssa-413565.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d012e3af");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-34821");

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/12/13");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/12/13");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/03/22");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:ruggedcom_rm1224_lte_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_m_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_s_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:ruggedcom_rm1224_lte_firmware" :
        {"versionEndExcluding" : "7.2", "family" : "RuggedCom", "orderNumbers": ["6GK6108-4AM00-2BA2", "6GK6108-4AM00-2DA2"]},
    "cpe:/o:siemens:scalance_m_firmware" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCEM", "orderNumbers": ["6GK5804-0AP00-2AA2","6GK5812-1AA00-2AA2","6GK5812-1BA00-2AA2","6GK5816-1AA00-2AA2","6GK5816-1BA00-2AA2","6GK5826-2AB00-2AB2","6GK5874-2AA00-2AA2","6GK5874-3AA00-2AA2","6GK5876-3AA02-2BA2","6GK5876-3AA02-2EA2","6GK5876-4AA10-2BA2","6GK5876-4AA00-2BA2","6GK5876-4AA00-2DA2","6GK5853-2EA00-2DA1","6GK5856-2EA00-3DA1","6GK5856-2EA00-3AA1"]},
    "cpe:/o:siemens:scalance_s_firmware:7.2" :
        {"versionEndExcluding" : "7.2", "family" : "SCALANCES", "orderNumbers": ["6GK5615-0AA00-2AA2","6GK5615-0AA01-2AA2"]},
    "cpe:/o:siemens:scalance_s_firmware:2.3" :
        {"versionStartIncluding" : "2.3", "versionEndExcluding" : "3.0", "family" : "SCALANCES", "orderNumbers": ["6GK5622-2GS00-2AC2","6GK5632-2GS00-2AC2","6GK5636-2GS00-2AC2","6GK5642-2GS00-2AC2","6GK5646-2GS00-2AC2"]}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
