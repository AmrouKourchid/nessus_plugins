#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502696);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/02");

  script_cve_id("CVE-2020-3168");

  script_name(english:"Cisco Nexus Uncontrolled Resource Consumption (CVE-2020-3168)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Secure Login Enhancements capability of Cisco
Nexus 1000V Switch for VMware vSphere could allow an unauthenticated,
remote attacker to cause an affected Nexus 1000V Virtual Supervisor
Module (VSM) to become inaccessible to users through the CLI. The
vulnerability is due to improper resource allocation during failed CLI
login attempts when login parameters that are part of the Secure Login
Enhancements capability are configured on an affected device. An
attacker could exploit this vulnerability by performing a high amount
of login attempts against the affected device. A successful exploit
could cause the affected device to become inaccessible to other users,
resulting in a denial of service (DoS) condition requiring a manual
power cycle of the VSM to recover.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20200226-nexus-1000v-dos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1001187e");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20200226-nexus-1000v-dos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1001187e");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2020-3168");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(399, 400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2020/02/26");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/02/26");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/11/29");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:5.2%281%29sv3%284.1a%29::~~~vsphere~~");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:5.2%281%29sv3%284.1a%29::~~~vsphere~~" :
        {"versionEndIncluding" : "5.2%281%29sv3%284.1a%29", "versionStartIncluding" : "5.2%281%29sv3%284.1a%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
