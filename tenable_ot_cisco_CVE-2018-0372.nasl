#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501259);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2018-0372");

  script_name(english:"Cisco Nexus 9000 Series Fabric Switches Application-Centric Infrastructure Mode DHCP Version 6 Denial of Service (CVE-2018-0372)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the DHCPv6 feature of the Cisco Nexus 9000 Series
Fabric Switches in Application-Centric Infrastructure (ACI) Mode could
allow an unauthenticated, remote attacker to cause the device to run
low on system memory, which could result in a Denial of Service (DoS)
condition on an affected system. The vulnerability is due to improper
memory management when DHCPv6 packets are received on an interface of
the targeted device. An attacker could exploit this vulnerability by
sending a high number of malicious DHCPv6 packets to be processed by
an affected device. A successful exploit could allow the attacker to
cause the system to run low on memory, which could cause an eventual
reboot of an affected device. The vulnerability only applies to IPv6
protocol packets and not for IPv4 protocol packets. This vulnerability
affects Cisco Nexus 9000 Series Fabric Switches in ACI Mode running
software version 13.0(1k). The vulnerability can only be exploited
when unicast routing is enabled on the Bridge Domain (BD). DHCP and
DHCP relay do not have to be configured for the vulnerability to be
exploited. Cisco Bug IDs: CSCvg38918.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1041348");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-20180718-nexus-9000-dos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b7e7d04d");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-0372");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/07/18");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/07/18");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:13.0%281k%29");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:13.0%281k%29" :
        {"versionEndIncluding" : "13.0%281k%29", "versionStartIncluding" : "13.0%281k%29", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
