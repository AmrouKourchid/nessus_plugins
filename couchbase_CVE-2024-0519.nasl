#%NASL_MIN_LEVEL 80900

##
# Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(213437);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/12/31");

  script_cve_id("CVE-2024-0519");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2024/02/07");

  script_name(english:"Couchbase 2.x < 7.2.5 Out-of-Bounds");

  script_set_attribute(attribute:"synopsis", value:
"The remote host is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The version of Couchbase installed on the remote host is prior to 7.2.5 or 7.6.2. It is, therefore, affected by an
Out of bounds memory access exposure in V8 in Google Chrome prior to 120.0.6099.224.  This allows a remote attacker to
potentially exploit heap corruption via a crafted HTML page.

Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version number.");
  script_set_attribute(attribute:"see_also", value:"https://review.couchbase.org/c/manifest/+/209041");
  script_set_attribute(attribute:"see_also", value:"https://www.couchbase.com/alerts/");
  script_set_attribute(attribute:"solution", value:
"Upgrade to Couchbase version 7.2.5, 7.6.2, or later.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-0519");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(125, 787);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/01/16");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/04/24");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/12/30");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:couchbase:couchbase_server");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Misc.");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("couchbase_server_win_installed.nbin", "couchbase_server_nix_installed.nbin");
  script_require_keys("installed_sw/Couchbase Server");

  exit(0);
}

include('vcf.inc');

var app_info = vcf::get_app_info(app:'Couchbase Server');
var constraints = [
    { 'min_version':'1.0', 'fixed_version':'7.2.5' }
];

vcf::check_version_and_report(app_info:app_info, constraints:constraints, severity:SECURITY_HOLE);
        