#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(503155);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/04/11");

  script_cve_id("CVE-2003-1109");

  script_name(english:"Cisco IP Phones Denial of Service (CVE-2003-1109)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The Session Initiation Protocol (SIP) implementation in multiple Cisco
products including IP Phone models 7940 and 7960, IOS versions in the
12.2 train, and Secure PIX 5.2.9 to 6.2.2 allows remote attackers to
cause a denial of service and possibly execute arbitrary code via
crafted INVITE messages, as demonstrated by the OUSPG PROTOS c07-sip
test suite.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.cert.org/advisories/CA-2003-06.html");
  script_set_attribute(attribute:"see_also", value:"http://www.cisco.com/warp/public/707/cisco-sa-20030221-protos.shtml");
  script_set_attribute(attribute:"see_also", value:"http://www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/");
  script_set_attribute(attribute:"see_also", value:"http://www.kb.cert.org/vuls/id/528719");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/6904");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id?1006143");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id?1006144");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id?1006145");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2003-1109");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");

  script_set_attribute(attribute:"vuln_publication_date", value:"2003/12/31");
  script_set_attribute(attribute:"patch_publication_date", value:"2003/12/31");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/04/11");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:cisco:ip_phone_7940");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:cisco:ip_phone_7960");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/h:cisco:ip_phone_7940" :
        {"family" : "CiscoIPPhones"},
    "cpe:/h:cisco:ip_phone_7960" :
        {"family" : "CiscoIPPhones"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
