#TRUSTED 7d99455a8381cb1e059c6862ad42e6e1c71c212af48f86b4a878e24061f9e5dcf692a89e53293490a791d422e0c79d3ecfe83f88de394f9bc764676cde6cbfe3ac3741db974d1362efd7f297a640e490fe0f150281c15dd41da4e4450271d4867513f37eafaa425a6d54d51abd3e4eab0c4a0a5d73f018338a33296448781b5948994df88e78601f42ef59f2eb85884ba0b3a04fdd9ac3410483b731bb94c162fb47330c6728814ec2acdc17734b625d567d687f5a7133f84f93d13f5d43c35d28d48e27a5220c2621242f4b39e2641a7abf2afa6b5e895923a128fa8f4c86319652bb7e679fee1e51bd355ed0bc1e597bdc77dbe9456e50f099669dd0b095eee228a4ad796126dd4b084abff09f99d4b1bfe2f90c7543cf4ca4a2cc15eeee962f9d07eba02787002d6631626409f1a067c7a5bfafef64c25d82d42242173fbb79d648abe21bd8e4a9874045f68d3d837de82515dc9c51bcefa294244ab8aa11fa11ba56139b3e70387e3bd4ff284ac577092283a593c4dc7022456d561e3a0eb04a7deba33c00925c4cb13f9c6ee8347c21d86d31773228abec3b1b412490996d4a20a0e5d1f6dbcc47cbaadae62c2f66a40b9ff50e8f9e5de53c93f0cd20edb8d00126c3762c43179b6e68b928e242eb60cb1f529f390c477098ff45bb30f06e0401dc8670703133d3330019a3245a6cf111b72cc6eb48641d485f2f90604c
#TRUST-RSA-SHA256 9f37de47d879c139cdf913694084bf3622719abe8a90802f8c27292136f5482364534bf00ab1a6ad649ae636d26c22f379dba8d9364939869c14eb9617ddc3111a67428472a0433fa1cc3775dc88f37c86251de28010bdeca9b07571586fdce6e8ddcd03d27af8d176ca0316801931614ee8f6452fa30e40cd4ae2c2c88857e6d2b7caa76f93431b7dd44aa107f35f307e3345be8d488362407ca45bb00ff05f28ddbb448be5312ec8c240f0da8a0fe232cee62750ce8ad2677f4b96956ae61f0c4441448609086b889cc602c23ae4a4a1f093418df31e54bedf688a40eefd0de16f52fa3e0a342f94a5a097212c02ce1eb636d9c193673fd656f6e17f32e77d22cfe85e3406ea327cfea72e665f225962094f81d82e5c8d6ff3cb24e3a7738b913cb815f42e3c2b76f95c06bc51de61c4075634dfb4254b4d7f6f6e94074b81ab8788d8d1bb0fe2cb7b6b42aaca8859ef1a2a0e2c9c562061c550ac2ba9edcd6804e7f3d8e2633d58eb6b13bee079336da4fd47db60e600f4e5c70fefd81b94c5e1835347474ffcd1ea0eacb070637a214f8f3c3ee426154b18c517f5331782b466b6985e18468cfa69e98a24f2abaa90b1e1376caedfa8fd313bdf02adb94dc25ca8de8d4da9fa879db2137e105256db40aed3faab00cf3ad6efb33825c3cd7ceb5d3a1c0eb45edbead361f87f145074c69d69f824096408a0779d6c0d8686
#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(215118);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/02/10");

  script_cve_id("CVE-2025-20185");
  script_xref(name:"CISCO-BUG-ID", value:"CSCwk98506");
  script_xref(name:"CISCO-SA", value:"cisco-sa-esa-sma-wsa-multi-yKUJhS34");
  script_xref(name:"IAVA", value:"2025-A-0082");

  script_name(english:"Cisco Secure Email Gateway Privelege Escalation (cisco-sa-esa-sma-wsa-multi-yKUJhS34)");

  script_set_attribute(attribute:"synopsis", value:
"The remote device is missing a vendor-supplied security patch.");
  script_set_attribute(attribute:"description", value:
"According to its self-reported version, Secure Email Gateway is affected by a vulnerability.

  - A vulnerability in the implementation of the remote access functionality of Cisco AsyncOS Software for
    Cisco Secure Email and Web Manager, Cisco Secure Email Gateway, and Cisco Secure Web Appliance could allow
    an authenticated, local attacker to elevate privileges to root. The attacker must authenticate with valid
    administrator credentials. This vulnerability is due to an architectural flaw in the password generation
    algorithm for the remote access functionality. An attacker could exploit this vulnerability by generating
    a temporary password for the service account. A successful exploit could allow the attacker to execute
    arbitrary commands as root and access the underlying operating system. Note: The Security Impact Rating
    (SIR) for this vulnerability is Medium due to the unrestricted scope of information that is accessible to
    an attacker. (CVE-2025-20185)

Please see the included Cisco BID and Cisco Security Advisory for more information.");
  # https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-esa-sma-wsa-multi-yKUJhS34
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a765161e");
  script_set_attribute(attribute:"see_also", value:"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwk98506");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the relevant fixed version referenced in Cisco bug ID CSCwk98506");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:M/C:P/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2025-20185");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2025/02/05");
  script_set_attribute(attribute:"patch_publication_date", value:"2025/02/05");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/02/07");

  script_set_attribute(attribute:"plugin_type", value:"combined");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:cisco:email_security_appliance");
  script_set_attribute(attribute:"stig_severity", value:"II");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CISCO");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("cisco_esa_version.nasl");
  script_require_keys("Host/AsyncOS/Cisco Email Security Appliance/Version");

  exit(0);
}

include('ccf.inc');

var product_info = cisco::get_product_info(name:'Cisco Email Security Appliance (ESA)');

var vuln_ranges = [
  {'min_ver' : '0.0', 'fix_ver' : '15.5.3.022'}, 
  {'min_ver' : '16.0', 'fix_ver' : '16.0.1.017'}
];

var reporting = make_array(
  'port'          , 0,
  'severity'      , SECURITY_NOTE,
  'version'       , product_info['version'],
  'bug_id'        , 'CSCwk98506',
  'disable_caveat', TRUE
);

cisco::check_and_report(
  product_info:product_info,
  reporting:reporting,
  vuln_ranges:vuln_ranges
);

