#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502811);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/01/06");

  script_cve_id("CVE-2023-44487");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2023/10/31");
  script_xref(name:"CEA-ID", value:"CEA-2024-0004");

  script_name(english:"Cisco Products Uncontrolled Resource Consumption (CVE-2023-44487)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The HTTP/2 protocol allows a denial of service (server resource
consumption) because request cancellation can reset many streams
quickly, as exploited in the wild in August through October 2023.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/13/4");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/13/9");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/18/4");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/18/8");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/19/6");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/20/8");
  script_set_attribute(attribute:"see_also", value:"https://access.redhat.com/security/cve/cve-2023-44487");
  # https://arstechnica.com/security/2023/10/how-ddosers-used-the-http-2-protocol-to-deliver-attacks-of-unprecedented-size/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a1b880e9");
  script_set_attribute(attribute:"see_also", value:"https://aws.amazon.com/security/security-bulletins/AWS-2023-011/");
  # https://blog.cloudflare.com/technical-breakdown-http2-rapid-reset-ddos-attack/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f8fe5c87");
  # https://blog.cloudflare.com/zero-day-rapid-reset-http2-record-breaking-ddos-attack/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b5406717");
  # https://blog.litespeedtech.com/2023/10/11/rapid-reset-http-2-vulnerablilty/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?be45f645");
  # https://blog.qualys.com/vulnerabilities-threat-research/2023/10/10/cve-2023-44487-http-2-rapid-reset-attack
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0537e63f");
  script_set_attribute(attribute:"see_also", value:"https://blog.vespa.ai/cve-2023-44487/");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.proxmox.com/show_bug.cgi?id=4988");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.redhat.com/show_bug.cgi?id=2242803");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.suse.com/show_bug.cgi?id=1216123");
  # https://cgit.freebsd.org/ports/commit/?id=c64c329c2c1752f46b73e3e6ce9f4329be6629f9
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ce3e9a68");
  # https://cloud.google.com/blog/products/identity-security/google-cloud-mitigated-largest-ddos-attack-peaking-above-398-million-rps/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c32c8c53");
  # https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4c3cd3ed");
  # https://community.traefik.io/t/is-traefik-vulnerable-to-cve-2023-44487/20125
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ca8a93f5");
  # https://discuss.hashicorp.com/t/hcsec-2023-32-vault-consul-and-boundary-affected-by-http-2-rapid-reset-denial-of-service-vulnerability-cve-2023-44487/59715
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d3d71903");
  script_set_attribute(attribute:"see_also", value:"https://edg.io/lp/blog/resets-leaks-ddos-and-the-tale-of-a-hidden-cve");
  # https://forums.swift.org/t/swift-nio-http2-security-update-cve-2023-44487-http-2-dos/67764
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0c741aa8");
  script_set_attribute(attribute:"see_also", value:"https://gist.github.com/adulau/7c2bfb8e9cdbe4b35a5e131c66a0c088");
  script_set_attribute(attribute:"see_also", value:"https://github.com/Azure/AKS/issues/3947");
  script_set_attribute(attribute:"see_also", value:"https://github.com/Kong/kong/discussions/11741");
  script_set_attribute(attribute:"see_also", value:"https://github.com/advisories/GHSA-qppj-fm5r-hxr3");
  script_set_attribute(attribute:"see_also", value:"https://github.com/advisories/GHSA-vx74-f528-fxqg");
  script_set_attribute(attribute:"see_also", value:"https://github.com/advisories/GHSA-xpw8-rcwv-8f8p");
  script_set_attribute(attribute:"see_also", value:"https://github.com/akka/akka-http/issues/4323");
  script_set_attribute(attribute:"see_also", value:"https://github.com/alibaba/tengine/issues/1872");
  script_set_attribute(attribute:"see_also", value:"https://github.com/apache/apisix/issues/10320");
  script_set_attribute(attribute:"see_also", value:"https://github.com/apache/httpd-site/pull/10");
  # https://github.com/apache/httpd/blob/afcdbeebbff4b0c50ea26cdd16e178c0d1f24152/modules/http2/h2_mplx.c#L1101-L1113
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?549338dd");
  # https://github.com/apache/tomcat/tree/main/java/org/apache/coyote/http2
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f3ee5f37");
  script_set_attribute(attribute:"see_also", value:"https://github.com/apache/trafficserver/pull/10564");
  script_set_attribute(attribute:"see_also", value:"https://github.com/arkrwn/PoC/tree/main/CVE-2023-44487");
  script_set_attribute(attribute:"see_also", value:"https://github.com/bcdannyboy/CVE-2023-44487");
  script_set_attribute(attribute:"see_also", value:"https://github.com/caddyserver/caddy/issues/5877");
  script_set_attribute(attribute:"see_also", value:"https://github.com/caddyserver/caddy/releases/tag/v2.7.5");
  script_set_attribute(attribute:"see_also", value:"https://github.com/dotnet/announcements/issues/277");
  # https://github.com/dotnet/core/blob/e4613450ea0da7fd2fc6b61dfb2c1c1dec1ce9ec/release-notes/6.0/6.0.23/6.0.23.md?plain=1#L73
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?085650ec");
  script_set_attribute(attribute:"see_also", value:"https://github.com/eclipse/jetty.project/issues/10679");
  script_set_attribute(attribute:"see_also", value:"https://github.com/envoyproxy/envoy/pull/30055");
  script_set_attribute(attribute:"see_also", value:"https://github.com/etcd-io/etcd/issues/16740");
  script_set_attribute(attribute:"see_also", value:"https://github.com/facebook/proxygen/pull/466");
  script_set_attribute(attribute:"see_also", value:"https://github.com/golang/go/issues/63417");
  script_set_attribute(attribute:"see_also", value:"https://github.com/grpc/grpc-go/pull/6703");
  script_set_attribute(attribute:"see_also", value:"https://github.com/h2o/h2o/pull/3291");
  script_set_attribute(attribute:"see_also", value:"https://github.com/h2o/h2o/security/advisories/GHSA-2m7v-gc89-fjqf");
  script_set_attribute(attribute:"see_also", value:"https://github.com/haproxy/haproxy/issues/2312");
  # https://github.com/icing/mod_h2/blob/0a864782af0a942aa2ad4ed960a6b32cd35bcf0a/mod_http2/README.md?plain=1#L239-L244
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?207c3e1e");
  script_set_attribute(attribute:"see_also", value:"https://github.com/junkurihara/rust-rpxy/issues/97");
  # https://github.com/kazu-yamamoto/http2/commit/f61d41a502bd0f60eb24e1ce14edc7b6df6722a1
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?671e538e");
  script_set_attribute(attribute:"see_also", value:"https://github.com/kazu-yamamoto/http2/issues/93");
  script_set_attribute(attribute:"see_also", value:"https://github.com/kubernetes/kubernetes/pull/121120");
  script_set_attribute(attribute:"see_also", value:"https://github.com/line/armeria/pull/5232");
  # https://github.com/linkerd/website/pull/1695/commits/4b9c6836471bc8270ab48aae6fd2181bc73fd632
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bca769b8");
  script_set_attribute(attribute:"see_also", value:"https://github.com/micrictor/http2-rst-stream");
  script_set_attribute(attribute:"see_also", value:"https://github.com/microsoft/CBL-Mariner/pull/6381");
  # https://github.com/netty/netty/commit/58f75f665aa81a8cbcf6ffa74820042a285c5e61
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?278c058f");
  script_set_attribute(attribute:"see_also", value:"https://github.com/nghttp2/nghttp2/pull/1961");
  script_set_attribute(attribute:"see_also", value:"https://github.com/nghttp2/nghttp2/releases/tag/v1.57.0");
  script_set_attribute(attribute:"see_also", value:"https://github.com/ninenines/cowboy/issues/1615");
  script_set_attribute(attribute:"see_also", value:"https://github.com/nodejs/node/pull/50121");
  script_set_attribute(attribute:"see_also", value:"https://github.com/openresty/openresty/issues/930");
  script_set_attribute(attribute:"see_also", value:"https://github.com/opensearch-project/data-prepper/issues/3474");
  script_set_attribute(attribute:"see_also", value:"https://github.com/oqtane/oqtane.framework/discussions/3367");
  script_set_attribute(attribute:"see_also", value:"https://github.com/projectcontour/contour/pull/5826");
  script_set_attribute(attribute:"see_also", value:"https://github.com/tempesta-tech/tempesta/issues/1986");
  script_set_attribute(attribute:"see_also", value:"https://github.com/varnishcache/varnish-cache/issues/3996");
  script_set_attribute(attribute:"see_also", value:"https://groups.google.com/g/golang-announce/c/iNNxDTCjZvo");
  script_set_attribute(attribute:"see_also", value:"https://istio.io/latest/news/security/istio-security-2023-004/");
  script_set_attribute(attribute:"see_also", value:"https://linkerd.io/2023/10/12/linkerd-cve-2023-44487/");
  script_set_attribute(attribute:"see_also", value:"https://lists.apache.org/thread/5py8h42mxfsn8l1wy6o41xwhsjlsd87q");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00020.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00023.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00024.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00045.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00047.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/11/msg00001.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/11/msg00012.html");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2MBEPPC36UBVOZZNAXFHKLFGSLCMN5LI/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?703bea4f");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3N4NJ7FR4X4FPZUGNTQAPSTVB2HB2Y4A/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0254b09d");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BFQD3KUEMFBHPAPBGLWQC34L4OWL5HAZ/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?fbc56a4b");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CLB4TW7KALB3EEQWNWCN7OUIWWVWWCG2/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?e0f24fac");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/E72T67UPDRXHIDLO3OROR25YAMN4GGW5/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2f775382");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FNA62Q767CFAFHBCDKYNPBMZWB7TWYVU/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?198681ed");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HT7T2R4MQKLIF4ODV4BDLPARWFPCJ5CZ/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?6bd76af3");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JIZSEFC3YKCGABA2BZW6ZJRMDZJMB7PJ/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f4925e56");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JMEXY22BFG5Q64HQCM5CK2Q7KDKVV4TY/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?5925ba24");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KSEGD2IWKNUO3DWY4KQGUQM5BISRWHQE/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?15e705b5");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LKYHSZQFDNR7RSA7LHVLLIAQMVYCUGBG/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?719403b9");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LNMZJCDHGLJJLXO4OXWJMTVQRNWOC7UL/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?5bdf5fa7");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VHUHTSXLXGXS7JYKBXTA3VINUPHTNGVU/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f9b3ddfe");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VSRDIV77HNKUSM7SJC5BKE5JSHLHU2NK/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?444699b3");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WE2I52RHNNU42PX6NZ2RBUHSFFJ2LVZX/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?72609613");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WLPRQ5TWUQQXYWBJM7ECYDAIL2YVKIUH/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?848a1968");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/X6QXN4ORIVF6XBW4WWFE7VNPVC74S45Y/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?dc340493");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XFOIBB4YFICHDM7IBOP7PWXW3FX4HLL2/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c0580f4a");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZB43REMKRQR62NJEI7I5NQ4FSXNLBKRT/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?599d9cfc");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZKQSIKIAT5TJ3WSLU3RDBQ35YX4GY4V3/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0d77e313");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZLU6U2R2IC2K64NDPNMV55AUAO65MAF4/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?750d74ff");
  script_set_attribute(attribute:"see_also", value:"https://lists.w3.org/Archives/Public/ietf-http-wg/2023OctDec/0025.html");
  # https://mailman.nginx.org/pipermail/nginx-devel/2023-October/S36Q5HBXR7CAIMPLLPRSSSYR4PCMWILK.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?737d31e0");
  # https://martinthomson.github.io/h2-stream-limits/draft-thomson-httpbis-h2-stream-limits.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ff833d1d");
  # https://msrc.microsoft.com/blog/2023/10/microsoft-response-to-distributed-denial-of-service-ddos-attacks-against-http/2/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?46ac6821");
  script_set_attribute(attribute:"see_also", value:"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-44487");
  script_set_attribute(attribute:"see_also", value:"https://my.f5.com/manage/s/article/K000137106");
  script_set_attribute(attribute:"see_also", value:"https://netty.io/news/2023/10/10/4-1-100-Final.html");
  script_set_attribute(attribute:"see_also", value:"https://news.ycombinator.com/item?id=37830987");
  script_set_attribute(attribute:"see_also", value:"https://news.ycombinator.com/item?id=37830998");
  script_set_attribute(attribute:"see_also", value:"https://news.ycombinator.com/item?id=37831062");
  script_set_attribute(attribute:"see_also", value:"https://news.ycombinator.com/item?id=37837043");
  # https://openssf.org/blog/2023/10/10/http-2-rapid-reset-vulnerability-highlights-need-for-rapid-response/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?429494b7");
  # https://seanmonstar.com/post/730794151136935936/hyper-http2-rapid-reset-unaffected
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b59b862f");
  script_set_attribute(attribute:"see_also", value:"https://security.gentoo.org/glsa/202311-09");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20231016-0001/");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20240426-0007/");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20240621-0006/");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20240621-0007/");
  script_set_attribute(attribute:"see_also", value:"https://security.paloaltonetworks.com/CVE-2023-44487");
  # https://tomcat.apache.org/security-10.html#Fixed_in_Apache_Tomcat_10.1.14
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a0ff880f");
  script_set_attribute(attribute:"see_also", value:"https://ubuntu.com/security/CVE-2023-44487");
  # https://www.bleepingcomputer.com/news/security/new-http-2-rapid-reset-zero-day-attack-breaks-ddos-records/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f85f1cd0");
  # https://www.cisa.gov/news-events/alerts/2023/10/10/http2-rapid-reset-vulnerability-cve-2023-44487
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2ae59881");
  # https://www.darkreading.com/cloud/internet-wide-zero-day-bug-fuels-largest-ever-ddos-event
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?fa341e67");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5521");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5522");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5540");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5549");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5558");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5570");
  # https://www.haproxy.com/blog/haproxy-is-not-affected-by-the-http-2-rapid-reset-attack-cve-2023-44487
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?6afb6e5c");
  # https://www.netlify.com/blog/netlify-successfully-mitigates-cve-2023-44487/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2cf47e27");
  # https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bfa2ac7e");
  script_set_attribute(attribute:"see_also", value:"https://www.openwall.com/lists/oss-security/2023/10/10/6");
  script_set_attribute(attribute:"see_also", value:"https://www.phoronix.com/news/HTTP2-Rapid-Reset-Attack");
  script_set_attribute(attribute:"see_also", value:"https://www.theregister.com/2023/10/10/http2_rapid_reset_zeroday/");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/13/4");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/13/9");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/18/4");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/18/8");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/19/6");
  script_set_attribute(attribute:"see_also", value:"http://www.openwall.com/lists/oss-security/2023/10/20/8");
  script_set_attribute(attribute:"see_also", value:"https://access.redhat.com/security/cve/cve-2023-44487");
  # https://arstechnica.com/security/2023/10/how-ddosers-used-the-http-2-protocol-to-deliver-attacks-of-unprecedented-size/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a1b880e9");
  script_set_attribute(attribute:"see_also", value:"https://aws.amazon.com/security/security-bulletins/AWS-2023-011/");
  # https://blog.cloudflare.com/technical-breakdown-http2-rapid-reset-ddos-attack/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f8fe5c87");
  # https://blog.cloudflare.com/zero-day-rapid-reset-http2-record-breaking-ddos-attack/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b5406717");
  # https://blog.litespeedtech.com/2023/10/11/rapid-reset-http-2-vulnerablilty/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?be45f645");
  # https://blog.qualys.com/vulnerabilities-threat-research/2023/10/10/cve-2023-44487-http-2-rapid-reset-attack
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0537e63f");
  script_set_attribute(attribute:"see_also", value:"https://blog.vespa.ai/cve-2023-44487/");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.proxmox.com/show_bug.cgi?id=4988");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.redhat.com/show_bug.cgi?id=2242803");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.suse.com/show_bug.cgi?id=1216123");
  # https://cgit.freebsd.org/ports/commit/?id=c64c329c2c1752f46b73e3e6ce9f4329be6629f9
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ce3e9a68");
  # https://cloud.google.com/blog/products/identity-security/google-cloud-mitigated-largest-ddos-attack-peaking-above-398-million-rps/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c32c8c53");
  # https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4c3cd3ed");
  # https://community.traefik.io/t/is-traefik-vulnerable-to-cve-2023-44487/20125
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ca8a93f5");
  # https://discuss.hashicorp.com/t/hcsec-2023-32-vault-consul-and-boundary-affected-by-http-2-rapid-reset-denial-of-service-vulnerability-cve-2023-44487/59715
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d3d71903");
  script_set_attribute(attribute:"see_also", value:"https://edg.io/lp/blog/resets-leaks-ddos-and-the-tale-of-a-hidden-cve");
  # https://forums.swift.org/t/swift-nio-http2-security-update-cve-2023-44487-http-2-dos/67764
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0c741aa8");
  script_set_attribute(attribute:"see_also", value:"https://gist.github.com/adulau/7c2bfb8e9cdbe4b35a5e131c66a0c088");
  script_set_attribute(attribute:"see_also", value:"https://github.com/Azure/AKS/issues/3947");
  script_set_attribute(attribute:"see_also", value:"https://github.com/Kong/kong/discussions/11741");
  script_set_attribute(attribute:"see_also", value:"https://github.com/advisories/GHSA-qppj-fm5r-hxr3");
  script_set_attribute(attribute:"see_also", value:"https://github.com/advisories/GHSA-vx74-f528-fxqg");
  script_set_attribute(attribute:"see_also", value:"https://github.com/advisories/GHSA-xpw8-rcwv-8f8p");
  script_set_attribute(attribute:"see_also", value:"https://github.com/akka/akka-http/issues/4323");
  script_set_attribute(attribute:"see_also", value:"https://github.com/alibaba/tengine/issues/1872");
  script_set_attribute(attribute:"see_also", value:"https://github.com/apache/apisix/issues/10320");
  script_set_attribute(attribute:"see_also", value:"https://github.com/apache/httpd-site/pull/10");
  # https://github.com/apache/httpd/blob/afcdbeebbff4b0c50ea26cdd16e178c0d1f24152/modules/http2/h2_mplx.c#L1101-L1113
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?549338dd");
  # https://github.com/apache/tomcat/tree/main/java/org/apache/coyote/http2
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f3ee5f37");
  script_set_attribute(attribute:"see_also", value:"https://github.com/apache/trafficserver/pull/10564");
  script_set_attribute(attribute:"see_also", value:"https://github.com/arkrwn/PoC/tree/main/CVE-2023-44487");
  script_set_attribute(attribute:"see_also", value:"https://github.com/bcdannyboy/CVE-2023-44487");
  script_set_attribute(attribute:"see_also", value:"https://github.com/caddyserver/caddy/issues/5877");
  script_set_attribute(attribute:"see_also", value:"https://github.com/caddyserver/caddy/releases/tag/v2.7.5");
  script_set_attribute(attribute:"see_also", value:"https://github.com/dotnet/announcements/issues/277");
  # https://github.com/dotnet/core/blob/e4613450ea0da7fd2fc6b61dfb2c1c1dec1ce9ec/release-notes/6.0/6.0.23/6.0.23.md?plain=1#L73
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?085650ec");
  script_set_attribute(attribute:"see_also", value:"https://github.com/eclipse/jetty.project/issues/10679");
  script_set_attribute(attribute:"see_also", value:"https://github.com/envoyproxy/envoy/pull/30055");
  script_set_attribute(attribute:"see_also", value:"https://github.com/etcd-io/etcd/issues/16740");
  script_set_attribute(attribute:"see_also", value:"https://github.com/facebook/proxygen/pull/466");
  script_set_attribute(attribute:"see_also", value:"https://github.com/golang/go/issues/63417");
  script_set_attribute(attribute:"see_also", value:"https://github.com/grpc/grpc-go/pull/6703");
  script_set_attribute(attribute:"see_also", value:"https://github.com/h2o/h2o/pull/3291");
  script_set_attribute(attribute:"see_also", value:"https://github.com/h2o/h2o/security/advisories/GHSA-2m7v-gc89-fjqf");
  script_set_attribute(attribute:"see_also", value:"https://github.com/haproxy/haproxy/issues/2312");
  # https://github.com/icing/mod_h2/blob/0a864782af0a942aa2ad4ed960a6b32cd35bcf0a/mod_http2/README.md?plain=1#L239-L244
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?207c3e1e");
  script_set_attribute(attribute:"see_also", value:"https://github.com/junkurihara/rust-rpxy/issues/97");
  # https://github.com/kazu-yamamoto/http2/commit/f61d41a502bd0f60eb24e1ce14edc7b6df6722a1
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?671e538e");
  script_set_attribute(attribute:"see_also", value:"https://github.com/kazu-yamamoto/http2/issues/93");
  script_set_attribute(attribute:"see_also", value:"https://github.com/kubernetes/kubernetes/pull/121120");
  script_set_attribute(attribute:"see_also", value:"https://github.com/line/armeria/pull/5232");
  # https://github.com/linkerd/website/pull/1695/commits/4b9c6836471bc8270ab48aae6fd2181bc73fd632
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bca769b8");
  script_set_attribute(attribute:"see_also", value:"https://github.com/micrictor/http2-rst-stream");
  script_set_attribute(attribute:"see_also", value:"https://github.com/microsoft/CBL-Mariner/pull/6381");
  # https://github.com/netty/netty/commit/58f75f665aa81a8cbcf6ffa74820042a285c5e61
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?278c058f");
  script_set_attribute(attribute:"see_also", value:"https://github.com/nghttp2/nghttp2/pull/1961");
  script_set_attribute(attribute:"see_also", value:"https://github.com/nghttp2/nghttp2/releases/tag/v1.57.0");
  script_set_attribute(attribute:"see_also", value:"https://github.com/ninenines/cowboy/issues/1615");
  script_set_attribute(attribute:"see_also", value:"https://github.com/nodejs/node/pull/50121");
  script_set_attribute(attribute:"see_also", value:"https://github.com/openresty/openresty/issues/930");
  script_set_attribute(attribute:"see_also", value:"https://github.com/opensearch-project/data-prepper/issues/3474");
  script_set_attribute(attribute:"see_also", value:"https://github.com/oqtane/oqtane.framework/discussions/3367");
  script_set_attribute(attribute:"see_also", value:"https://github.com/projectcontour/contour/pull/5826");
  script_set_attribute(attribute:"see_also", value:"https://github.com/tempesta-tech/tempesta/issues/1986");
  script_set_attribute(attribute:"see_also", value:"https://github.com/varnishcache/varnish-cache/issues/3996");
  script_set_attribute(attribute:"see_also", value:"https://groups.google.com/g/golang-announce/c/iNNxDTCjZvo");
  script_set_attribute(attribute:"see_also", value:"https://istio.io/latest/news/security/istio-security-2023-004/");
  script_set_attribute(attribute:"see_also", value:"https://linkerd.io/2023/10/12/linkerd-cve-2023-44487/");
  script_set_attribute(attribute:"see_also", value:"https://lists.apache.org/thread/5py8h42mxfsn8l1wy6o41xwhsjlsd87q");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00020.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00023.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00024.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00045.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/10/msg00047.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/11/msg00001.html");
  script_set_attribute(attribute:"see_also", value:"https://lists.debian.org/debian-lts-announce/2023/11/msg00012.html");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2MBEPPC36UBVOZZNAXFHKLFGSLCMN5LI/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?703bea4f");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3N4NJ7FR4X4FPZUGNTQAPSTVB2HB2Y4A/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0254b09d");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BFQD3KUEMFBHPAPBGLWQC34L4OWL5HAZ/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?fbc56a4b");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CLB4TW7KALB3EEQWNWCN7OUIWWVWWCG2/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?e0f24fac");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/E72T67UPDRXHIDLO3OROR25YAMN4GGW5/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2f775382");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FNA62Q767CFAFHBCDKYNPBMZWB7TWYVU/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?198681ed");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HT7T2R4MQKLIF4ODV4BDLPARWFPCJ5CZ/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?6bd76af3");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JIZSEFC3YKCGABA2BZW6ZJRMDZJMB7PJ/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f4925e56");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JMEXY22BFG5Q64HQCM5CK2Q7KDKVV4TY/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?5925ba24");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KSEGD2IWKNUO3DWY4KQGUQM5BISRWHQE/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?15e705b5");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LKYHSZQFDNR7RSA7LHVLLIAQMVYCUGBG/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?719403b9");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LNMZJCDHGLJJLXO4OXWJMTVQRNWOC7UL/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?5bdf5fa7");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VHUHTSXLXGXS7JYKBXTA3VINUPHTNGVU/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f9b3ddfe");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VSRDIV77HNKUSM7SJC5BKE5JSHLHU2NK/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?444699b3");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WE2I52RHNNU42PX6NZ2RBUHSFFJ2LVZX/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?72609613");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WLPRQ5TWUQQXYWBJM7ECYDAIL2YVKIUH/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?848a1968");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/X6QXN4ORIVF6XBW4WWFE7VNPVC74S45Y/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?dc340493");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XFOIBB4YFICHDM7IBOP7PWXW3FX4HLL2/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c0580f4a");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZB43REMKRQR62NJEI7I5NQ4FSXNLBKRT/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?599d9cfc");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZKQSIKIAT5TJ3WSLU3RDBQ35YX4GY4V3/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?0d77e313");
  # https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZLU6U2R2IC2K64NDPNMV55AUAO65MAF4/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?750d74ff");
  script_set_attribute(attribute:"see_also", value:"https://lists.w3.org/Archives/Public/ietf-http-wg/2023OctDec/0025.html");
  # https://mailman.nginx.org/pipermail/nginx-devel/2023-October/S36Q5HBXR7CAIMPLLPRSSSYR4PCMWILK.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?737d31e0");
  # https://martinthomson.github.io/h2-stream-limits/draft-thomson-httpbis-h2-stream-limits.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ff833d1d");
  # https://msrc.microsoft.com/blog/2023/10/microsoft-response-to-distributed-denial-of-service-ddos-attacks-against-http/2/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?46ac6821");
  script_set_attribute(attribute:"see_also", value:"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-44487");
  script_set_attribute(attribute:"see_also", value:"https://my.f5.com/manage/s/article/K000137106");
  script_set_attribute(attribute:"see_also", value:"https://netty.io/news/2023/10/10/4-1-100-Final.html");
  script_set_attribute(attribute:"see_also", value:"https://news.ycombinator.com/item?id=37830987");
  script_set_attribute(attribute:"see_also", value:"https://news.ycombinator.com/item?id=37830998");
  script_set_attribute(attribute:"see_also", value:"https://news.ycombinator.com/item?id=37831062");
  script_set_attribute(attribute:"see_also", value:"https://news.ycombinator.com/item?id=37837043");
  # https://openssf.org/blog/2023/10/10/http-2-rapid-reset-vulnerability-highlights-need-for-rapid-response/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?429494b7");
  # https://seanmonstar.com/post/730794151136935936/hyper-http2-rapid-reset-unaffected
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b59b862f");
  script_set_attribute(attribute:"see_also", value:"https://security.gentoo.org/glsa/202311-09");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20231016-0001/");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20240426-0007/");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20240621-0006/");
  script_set_attribute(attribute:"see_also", value:"https://security.netapp.com/advisory/ntap-20240621-0007/");
  script_set_attribute(attribute:"see_also", value:"https://security.paloaltonetworks.com/CVE-2023-44487");
  # https://tomcat.apache.org/security-10.html#Fixed_in_Apache_Tomcat_10.1.14
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a0ff880f");
  script_set_attribute(attribute:"see_also", value:"https://ubuntu.com/security/CVE-2023-44487");
  # https://www.bleepingcomputer.com/news/security/new-http-2-rapid-reset-zero-day-attack-breaks-ddos-records/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f85f1cd0");
  # https://www.cisa.gov/news-events/alerts/2023/10/10/http2-rapid-reset-vulnerability-cve-2023-44487
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2ae59881");
  # https://www.darkreading.com/cloud/internet-wide-zero-day-bug-fuels-largest-ever-ddos-event
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?fa341e67");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5521");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5522");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5540");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5549");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5558");
  script_set_attribute(attribute:"see_also", value:"https://www.debian.org/security/2023/dsa-5570");
  # https://www.haproxy.com/blog/haproxy-is-not-affected-by-the-http-2-rapid-reset-attack-cve-2023-44487
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?6afb6e5c");
  # https://www.netlify.com/blog/netlify-successfully-mitigates-cve-2023-44487/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?2cf47e27");
  # https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bfa2ac7e");
  script_set_attribute(attribute:"see_also", value:"https://www.openwall.com/lists/oss-security/2023/10/10/6");
  script_set_attribute(attribute:"see_also", value:"https://www.phoronix.com/news/HTTP2-Rapid-Reset-Attack");
  script_set_attribute(attribute:"see_also", value:"https://www.theregister.com/2023/10/10/http2_rapid_reset_zeroday/");
  # https://www.vicarius.io/vsociety/posts/rapid-reset-cve-2023-44487-dos-in-http2-understanding-the-root-cause
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?75d84160");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-44487");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/10/10");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/10/10");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/01/06");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:10");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:10.2" :
        {"versionEndExcluding" : "10.2\(7\)", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:10.3" :
        {"versionEndExcluding" : "10.3\(5\)", "versionStartIncluding" : "10.3\(1\)", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
