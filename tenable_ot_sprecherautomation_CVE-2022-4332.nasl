#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502815);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/01/24");

  script_cve_id("CVE-2022-4332");

  script_name(english:"Sprecher Automation SPRECON-E-C/P/T3 Improper Input Validation (CVE-2022-4332)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"In Sprecher Automation SPRECON-E-C/P/T3 CPU in variant PU244x a
vulnerable firmware verification has been identified. Through physical
access and hardware manipulation, an attacker might be able to bypass
hardware-based code verification and thus inject and execute arbitrary
code and gain full access of the device.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.sprecher-automation.com/fileadmin/itSecurity/PDF/2022-12_Advisories.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c0541169");
  script_set_attribute(attribute:"solution", value:
"The access vector is bound to physical device access. Hence, it is recommended to
emphasize physical security controls. See general recommendations.
Besides this, it needs to be taken into account that necessary hardware manipulation
to fully exploit this vulnerability requires to put the device out of operation for several
time; i.e. device status monitoring as usually applied in substation automation is an
important measure to also detect potential attacks.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-4332");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/06/01");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/06/01");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/01/23");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:sprecher-automation:sprecon-e-c_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:sprecher-automation:sprecon-e-p_dl6-1_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:sprecher-automation:sprecon-e-p_dq6-1_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:sprecher-automation:sprecon-e-p_ds6-0_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:sprecher-automation:sprecon-e-t3_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:sprecher-automation:sprecon-e-tc_ax-3110_firmware:-");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/SprecherAutomation");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/SprecherAutomation');

var asset = tenable_ot::assets::get(vendor:'SprecherAutomation');

var vuln_cpes = {
    "cpe:/o:sprecher-automation:sprecon-e-p_dq6-1_firmware:-" :
        {"family" : "SPRECONE"},
    "cpe:/o:sprecher-automation:sprecon-e-p_dl6-1_firmware:-" :
        {"family" : "SPRECONE"},
    "cpe:/o:sprecher-automation:sprecon-e-p_ds6-0_firmware:-" :
        {"family" : "SPRECONE"},
    "cpe:/o:sprecher-automation:sprecon-e-c_firmware:-" :
        {"family" : "SPRECONE"},
    "cpe:/o:sprecher-automation:sprecon-e-t3_firmware:-" :
        {"family" : "SPRECONE"},
    "cpe:/o:sprecher-automation:sprecon-e-tc_ax-3110_firmware:-" :
        {"family" : "SPRECONE"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
