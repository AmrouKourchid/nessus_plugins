#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(216167);
  script_version("1.8");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/04/09");

  script_cve_id("CVE-2025-0108");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2025/03/11");
  script_xref(name:"IAVA", value:"2025-A-0111-S");

  script_name(english:"Palo Alto Networks PAN-OS 10.1.x < 10.1.14-h9 / 10.2.x < 10.2.7-h24 / 11.1.x < 11.1.6-h1 / 11.2.x < 11.2.4-h4 Vulnerability");

  script_set_attribute(attribute:"synopsis", value:
"The remote PAN-OS host is affected by a vulnerability");
  script_set_attribute(attribute:"description", value:
"The version of Palo Alto Networks PAN-OS running on the remote host is 10.1.x prior to 10.1.14-h9 or 10.2.x prior to
10.2.7-h24 or 11.1.x prior to 11.1.6-h1 or 11.2.x prior to 11.2.4-h4. It is, therefore, affected by a vulnerability.

    An authentication bypass in the in the management web interface ofPalo Alto Networks PAN-OS software
    enables an unauthenticated attacker with network access to the management web interface to bypass the
    authentication otherwise required by the PAN-OS management web interface and invoke certain PHP scripts.
    While invoking these PHP scripts does not enable remote code execution, it can negatively impact integrity
    and confidentiality of PAN-OS.

    The attacker must have network access to the management web interface to exploit this issue.You can
    greatly reduce the risk of this issue by restricting access to the management web interface to only
    trusted internal IP addresses according to our recommended critical deployment guidelines
    (https://live.paloaltonetworks.com/t5/community-blogs/tips-amp-tricks-how-to-secure-the-management-access-
    of-your-palo/ba-p/464431).

    This issue does not affect Cloud NGFW or Prisma Access software.

Tenable has extracted the preceding description block directly from the PAN-OS security advisory.

Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version
number.");
  script_set_attribute(attribute:"see_also", value:"https://security.paloaltonetworks.com/CVE-2025-0108");
  script_set_attribute(attribute:"solution", value:
"Upgrade to PAN-OS 10.1.14-h9 / 10.2.7-h24 / 11.1.6-h1 / 11.2.4-h4 or later");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss4_vector", value:"CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:L/VA:N/SC:N/SI:N/SA:N");
  script_set_attribute(attribute:"cvss4_supplemental", value:"CVSS:4.0/AU:N/R:U/V:C/RE:M/U:Amber");
  script_set_attribute(attribute:"cvss4_threat_vector", value:"CVSS:4.0/E:A");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2025-0108");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(306);

  script_set_attribute(attribute:"vuln_publication_date", value:"2025/02/12");
  script_set_attribute(attribute:"patch_publication_date", value:"2025/02/12");
  script_set_attribute(attribute:"plugin_publication_date", value:"2025/02/12");

  script_set_attribute(attribute:"potential_vulnerability", value:"true");
  script_set_attribute(attribute:"plugin_type", value:"combined");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:paloaltonetworks:pan-os");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_set_attribute(attribute:"stig_severity", value:"I");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Palo Alto Local Security Checks");

  script_copyright(english:"This script is Copyright (C) 2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("palo_alto_version.nbin");
  script_require_keys("Host/Palo_Alto/Firewall/Version", "Host/Palo_Alto/Firewall/Full_Version", "Host/Palo_Alto/Firewall/Source", "Settings/ParanoidReport");

  exit(0);
}

include('vcf.inc');
include('vcf_extras.inc');

vcf::palo_alto::initialize();

var app_name = 'Palo Alto Networks PAN-OS';

var app_info = vcf::get_app_info(app:app_name, kb_ver:'Host/Palo_Alto/Firewall/Full_Version', kb_source:'Host/Palo_Alto/Firewall/Source');

if (report_paranoia < 2) audit(AUDIT_PARANOID);

var constraints = [
  { 'min_version' : '10.1.0', 'fixed_version' : '10.1.14-h9', 'fixed_display' : 'Upgrade to 10.1.14-h9 or later' }, 
  { 'min_version' : '10.2.0', 'fixed_version' : '10.2.7-h24', 'fixed_display' : 'Upgrade to 10.2.7-h24 or 10.2.13-h3 or later' },
  { 'min_version' : '10.2.8', 'fixed_version' : '10.2.8-h21', 'fixed_display' : 'Upgrade to 10.2.8-h21 or 10.2.13-h3 or later' },
  { 'min_version' : '10.2.9', 'fixed_version' : '10.2.9-h21', 'fixed_display' : 'Upgrade to 10.2.9-h21 or 10.2.13-h3 or later' },
  { 'min_version' : '10.2.10', 'fixed_version' : '10.2.10-h14', 'fixed_display' : 'Upgrade to 10.2.10-h14 or 10.2.13-h3 or later' },
  { 'min_version' : '10.2.11', 'fixed_version' : '10.2.11-h12', 'fixed_display' : 'Upgrade to 10.2.11-h12 or 10.2.13-h3 or later' },
  { 'min_version' : '10.2.12', 'fixed_version' : '10.2.12-h6', 'fixed_display' : 'Upgrade to 10.2.12-h6 or 10.2.13-h3 or later' },
  { 'min_version' : '11.0', 'fixed_version' : '11.1.6-h1', 'fixed_display' : 'Upgrade to 11.1.6-h1 or later' },
  { 'min_version' : '11.1.0', 'fixed_version' : '11.1.6-h1', 'fixed_display' : 'Upgrade to 11.1.6-h1 or later' },
  { 'min_version' : '11.1.2', 'fixed_version' : '11.1.2-h18', 'fixed_display' : 'Upgrade to 11.1.2-h18 or 11.1.6-h1 or later' },
  { 'min_version' : '11.1.4', 'fixed_version' : '11.1.4-h13 ', 'fixed_display' : 'Upgrade to 11.1.4-h13 or 11.1.6-h1 or later' },
  { 'min_version' : '11.2.0', 'fixed_version' : '11.2.4-h4', 'fixed_display' : 'Upgrade to 11.2.4-h4 or 11.2.5 or later' },
  { 'min_version' : '11.2.4', 'fixed_version' : '11.2.4-h4', 'fixed_display' : 'Upgrade to 11.2.4-h4 or 11.2.5 or later' }
];

vcf::check_version_and_report(
    app_info:app_info,
    constraints:constraints,
    severity:SECURITY_HOLE
);
