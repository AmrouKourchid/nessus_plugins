#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501679);
  script_version("1.7");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/10");

  script_cve_id("CVE-2020-25236");
  script_xref(name:"ICSA", value:"21-068-05");

  script_name(english:"Siemens LOGO! 8 BM Improper Handling of Exceptional Conditions (CVE-2020-25236)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in LOGO! 8 BM (incl. SIPLUS
variants) (All versions). The control logic (CL) the LOGO! 8 executes
could be manipulated in a way that could cause the device executing
the CL to improperly handle the manipulation and crash. After
successful execution of the attack, the device needs to be manually
reset.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-783481.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-21-068-05");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has identified the following specific workarounds and mitigations users can apply to reduce the risk:

- Siemens recommends limiting the possibilities to execute untrusted code if possible.

As a general security measure, Siemens strongly recommends protecting network access to devices with appropriate
mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends configuring the
environment according to Siemensâ€™ operational guidelines for industrial security and following the recommendations in
the product manuals.

Additional information on industrial security for Siemens devices can be found at:
https://www.siemens.com/industrialsecurity

For more information, please see Siemens Security Advisory SSA-783481

CISA also recommends users take the following measures to protect themselves from social engineering attacks:

- Do not click web links or open unsolicited attachments in email messages.
- Refer to Recognizing and Avoiding Email Scams for more information on avoiding email scams.
- Refer to Avoiding Social Engineering and Phishing Attacks for more information on social engineering attacks.");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2020-25236");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(755);

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/03/15");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/03/15");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/09/21");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_12%2f24rce_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_12%2f24rceo_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_230rce_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_230rceo_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_24ce_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_24ceo_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_24rce_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:logo%21_24rceo_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_logo%21_12%2f24rce_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_logo%21_12%2f24rceo_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_logo%21_230rce_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_logo%21_230rceo_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_logo%21_24ce_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_logo%21_24ceo_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_logo%21_24rce_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:siplus_logo%21_24rceo_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:logo%21_12%2f24rce_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6ED1052-1MD08-0BA1']},
    "cpe:/o:siemens:logo%21_12%2f24rceo_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6ED1052-2MD08-0BA1']},
    "cpe:/o:siemens:logo%21_230rce_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6ED1052-1FB08-0BA1']},
    "cpe:/o:siemens:logo%21_230rceo_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6ED1052-2FB08-0BA1']},
    "cpe:/o:siemens:logo%21_24ce_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6ED1052-1CC08-0BA1']},
    "cpe:/o:siemens:logo%21_24ceo_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6ED1052-2CC08-0BA1']},
    "cpe:/o:siemens:logo%21_24rce_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6ED1052-1HB08-0BA1']},
    "cpe:/o:siemens:logo%21_24rceo_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6ED1052-2HB08-0BA1']},
    "cpe:/o:siemens:siplus_logo%21_12%2f24rce_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6AG1052-1MD08-7BA1']},
    "cpe:/o:siemens:siplus_logo%21_12%2f24rceo_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6AG1052-2MD08-7BA1']},
    "cpe:/o:siemens:siplus_logo%21_230rce_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6AG1052-1FB08-7BA1']},
    "cpe:/o:siemens:siplus_logo%21_230rceo_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6AG1052-2FB08-7BA1']},
    "cpe:/o:siemens:siplus_logo%21_24ce_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6AG1052-1CC08-7BA1']},
    "cpe:/o:siemens:siplus_logo%21_24ceo_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6AG1052-2CC08-7BA1']},
    "cpe:/o:siemens:siplus_logo%21_24rce_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6AG1052-1HB08-7BA1']},
    "cpe:/o:siemens:siplus_logo%21_24rceo_firmware" :
        {"family" : "LOGO!BM", "orderNumbers" : ['6AG1052-2HB08-7BA1']}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
