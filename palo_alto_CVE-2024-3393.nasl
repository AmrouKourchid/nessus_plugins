#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(213409);
  script_version("1.9");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/04");

  script_cve_id("CVE-2024-3393");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2025/01/20");
  script_xref(name:"IAVA", value:"2025-A-0007-S");

  script_name(english:"Palo Alto Networks PAN-OS 10.1.x < 10.1.15 / 10.2.x < 10.2.14 / 11.1.x < 11.1.5 / 11.2.x < 11.2.3 Vulnerability");

  script_set_attribute(attribute:"synopsis", value:
"The remote PAN-OS host is affected by a vulnerability");
  script_set_attribute(attribute:"description", value:
"The version of Palo Alto Networks PAN-OS running on the remote host is 10.1.x prior to 10.1.15 or 10.2.x prior to
10.2.14 or 11.1.x prior to 11.1.5 or 11.2.x prior to 11.2.3. It is, therefore, affected by a vulnerability.

    A Denial of Service vulnerability in the DNS Security feature of Palo Alto Networks PAN-OS software allows
    an unauthenticated attacker to send a malicious packet through the data plane of the firewall that reboots
    the firewall. Repeated attempts to trigger this condition will cause the firewall to enter maintenance
    mode.

    This issue is applicable to the PAN-OS software versions listed below on PA-Series firewalls, VM-Series
    firewalls, CN-Series firewalls, and Prisma Access.

Tenable has extracted the preceding description block directly from the PAN-OS security advisory.

Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version
number.");
  script_set_attribute(attribute:"see_also", value:"https://security.paloaltonetworks.com/CVE-2024-3393");
  script_set_attribute(attribute:"solution", value:
"Upgrade to PAN-OS 10.1.15 / 10.2.14 / 11.1.5 / 11.2.3 or later");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss4_vector", value:"CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L");
  script_set_attribute(attribute:"cvss4_supplemental", value:"CVSS:4.0/AU:N/R:U/V:C/RE:M/U:Amber");
  script_set_attribute(attribute:"cvss4_threat_vector", value:"CVSS:4.0/E:A");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-3393");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(754);

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/12/26");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/12/26");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/12/27");

  script_set_attribute(attribute:"potential_vulnerability", value:"true");
  script_set_attribute(attribute:"plugin_type", value:"combined");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:paloaltonetworks:pan-os");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_set_attribute(attribute:"stig_severity", value:"I");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Palo Alto Local Security Checks");

  script_copyright(english:"This script is Copyright (C) 2024-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("palo_alto_version.nbin");
  script_require_keys("Host/Palo_Alto/Firewall/Version", "Host/Palo_Alto/Firewall/Full_Version", "Host/Palo_Alto/Firewall/Source", "Settings/ParanoidReport");

  exit(0);
}

include('vcf.inc');
include('vcf_extras.inc');

vcf::palo_alto::initialize();

var app_name = 'Palo Alto Networks PAN-OS';

var app_info = vcf::get_app_info(app:app_name, kb_ver:'Host/Palo_Alto/Firewall/Full_Version', kb_source:'Host/Palo_Alto/Firewall/Source');

if (report_paranoia < 2) audit(AUDIT_PARANOID);

var constraints = [
  { 'min_version' : '10.1.14', 'fixed_version' : '10.1.14-h8' },
  { 'min_version' : '10.2.8', 'fixed_version' : '10.2.8-h19' },
  { 'min_version' : '10.2.9', 'fixed_version' : '10.2.9-h19' },
  { 'min_version' : '10.2.10', 'fixed_version' : '10.2.10-h12' },
  { 'min_version' : '10.2.11', 'fixed_version' : '10.2.11-h10' },
  { 'min_version' : '10.2.12', 'fixed_version' : '10.2.12-h4' },
  { 'min_version' : '10.2.13', 'fixed_version' : '10.2.13-h2' },
  { 'min_version' : '11.1.0', 'max_version' : '11.1.1.9999', 'fixed_display' : 'See vendor advisory'},
  { 'min_version' : '11.1.2', 'fixed_version' : '11.1.2-h16' },
  { 'min_version' : '11.1.3', 'fixed_version' : '11.1.3-h13' },
  { 'min_version' : '11.1.4', 'fixed_version' : '11.1.4-h7' },
  { 'min_version' : '11.2.0', 'fixed_version' : '11.2.3' }
];

vcf::check_version_and_report(
    app_info:app_info,
    constraints:constraints,
    severity:SECURITY_HOLE
);
