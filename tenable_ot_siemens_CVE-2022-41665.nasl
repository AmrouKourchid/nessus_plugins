#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501120);
  script_version("1.6");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/10");

  script_cve_id("CVE-2022-41665");
  script_xref(name:"ICSA", value:"22-286-09");

  script_name(english:"Siemens SICAM P850 and P855 Devices Improper Neutralization of Parameter/Argument Delimiters (CVE-2022-41665)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in SICAM P850 (All versions <
V3.10), SICAM P855 (All versions < V3.10). Affected devices do not
properly validate the parameter of a specific GET request. This could
allow an unauthenticated attacker to set the device to a denial of
service state or to control the program counter and, thus, execute
arbitrary code on the device.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-572005.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-22-286-09");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens has released updates for the affected products and recommends updating to the latest versions: 

- SICAM P850 devices: Update to v3.10 or later
- SICAM P855 devices: Update to v3.10 or later

Siemens has identified the following specific workarounds and mitigations users can apply to reduce risk:

- Avoid accessing links from untrusted sources while logged in to SICAM P850 or SICAM P855 devices

Siemens recommends operators check for appropriate resilient protection measures; the risk of cyber incidents impacting
the grid's reliability can be minimized by virtue of the grid design.

Siemens strongly recommends applying the provided security updates using the corresponding tooling and documented
procedures made available with the product. If supported by the product, an automated application of security updates
across multiple product instances may be used. Siemens strongly recommends users to validate any security update before
application; Siemens recommends the update process be supervised by trained staff in the target environment.

As a general security measure, Siemens strongly recommends protecting network access with appropriate mechanisms, such
as firewalls, network segmentation, or use of virtual private networks (VPNs). It is advised to configure the
environment according to Siemens’ operational guidelines to run the devices in a protected IT environment.

For additional resources, users should review Siemens’ security guidelines.

For more information, see Siemens Security Advisory SSA-572005 in HTML or CSAF.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-41665");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(141);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/10/11");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/10/11");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/05/09");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:sicam_p850_firmware:3.10");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:sicam_p855_firmware:3.10");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:sicam_p850_firmware:3.10" :
        {"versionEndExcluding" : "3.10", "family" : "SicamP850", "orderNumbers" : ['7KG8501-0AA01-2AA0', '7KG8500-0AA30-0AA0', '7KG8501-0AA11-0AA0', '7KG8501-0AA32-2AA0', '7KG8501-0AA02-0AA0', '7KG8501-0AA12-2AA0', '7KG8500-0AA10-0AA0', '7KG8501-0AA11-2AA0', '7KG8501-0AA31-0AA0', '7KG8501-0AA01-0AA0', '7KG8500-0AA10-2AA0', '7KG8500-0AA00-2AA0', '7KG8500-0AA00-0AA0', '7KG8501-0AA32-0AA0', '7KG8501-0AA12-0AA0', '7KG8501-0AA02-2AA0', '7KG8500-0AA30-2AA0', '7KG8501-0AA31-2AA0']},
    "cpe:/o:siemens:sicam_p855_firmware:3.10" :
        {"versionEndExcluding" : "3.10", "family" : "SicamP855", "orderNumbers" : ['7KG8551-0AA31-0AA0', '7KG8551-0AA01-0AA0', '7KG8551-0AA12-2AA0', '7KG8551-0AA32-2AA0', '7KG8551-0AA01-2AA0', '7KG8550-0AA30-0AA0', '7KG8551-0AA11-0AA0', '7KG8550-0AA00-0AA0', '7KG8550-0AA10-0AA0', '7KG8551-0AA31-2AA0', '7KG8551-0AA32-0AA0', '7KG8550-0AA10-2AA0', '7KG8551-0AA02-0AA0', '7KG8551-0AA02-2AA0', '7KG8550-0AA00-2AA0', '7KG8551-0AA12-0AA0', '7KG8550-0AA30-2AA0', '7KG8551-0AA11-2AA0']}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
