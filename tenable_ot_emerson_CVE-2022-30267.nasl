#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(502374);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/09/03");

  script_cve_id("CVE-2022-30267");
  script_xref(name:"ICSA", value:"24-158-02");

  script_name(english:"Emerson Ovation Insufficient Verification of Data Authenticity (CVE-2022-30267)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The affected product was found to have no authentication of firmware signing 
and relies on an insecure checksum for integrity. This could allow an attacker 
to push malicious firmware images, cause a denial-of-service condition, or achieve remote code execution.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-24-158-02");
  script_set_attribute(attribute:"solution", value:
"Emerson recommends the following:
 - Upgrade to the currently available release of Ovation 3.8.0 Feature Pack 3 for remediation of many of the identified vulnerabilities.
 - Users are advised to consider the use of OCR3000 controllers, which offer an extra layer of protection that is not available to older controller models.
 - Deploy and configure Ovation systems and related components as described in the Cybersecurity for Ovation Systems manual (OVREF1000).
 - Users with questions or concerns regarding the impact of these vulnerabilities on Ovation should contact the Ovation-CERT by email or phone (1-800-445-9723, option 3).");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-30267");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/06/06");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/06/06");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/09/02");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:emerson:ovation_ocr1100");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:emerson:ovation_occ100");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:emerson:ovation_ocr400");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:emerson:ovation_ocr3000");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Emerson");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Emerson');

var asset = tenable_ot::assets::get(vendor:'Emerson');

var vuln_cpes = {
    "cpe:/h:emerson:ovation_ocr1100" :
        {"versionEndIncluding" : "3.8.0", "family" : "Ovation"},
    "cpe:/h:emerson:ovation_occ100" :
        {"versionEndIncluding" : "3.8.0", "family" : "Ovation"},
    "cpe:/h:emerson:ovation_ocr400" :
        {"versionEndIncluding" : "3.8.0", "family" : "Ovation"},
    "cpe:/h:emerson:ovation_ocr3000" :
        {"versionEndIncluding" : "3.8.0", "family" : "Ovation"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);