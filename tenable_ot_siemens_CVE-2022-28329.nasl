#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501050);
  script_version("1.9");
  script_set_attribute(attribute:"plugin_modification_date", value:"2025/03/10");

  script_cve_id("CVE-2022-28329");
  script_xref(name:"ICSA", value:"22-104-08");

  script_name(english:"Siemens SCALANCE W1700 Improper Input Validation (CVE-2022-28329)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in SCALANCE W1788-1 M12 (All
versions < V3.0.0), SCALANCE W1788-2 EEC M12 (All versions < V3.0.0),
SCALANCE W1788-2 M12 (All versions < V3.0.0), SCALANCE W1788-2IA M12
(All versions < V3.0.0). Affected devices do not properly handle
malformed TCP packets received over the RemoteCapture feature. This
could allow an attacker to lead to a denial of service condition which
only affects the port used by the RemoteCapture feature.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-392912.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/news-events/ics-advisories/icsa-22-104-08");
  script_set_attribute(attribute:"solution", value:
"The following text was originally created by the Cybersecurity and Infrastructure Security Agency (CISA). The original
can be found at CISA.gov.

Siemens recommends installing the following software updates to address these vulnerabilities.

- Update SCALANCE W1788-1 M12 to Version 3.0.0 or later
- Update SCALANCE W1788-2 EEC M12 to Version 3.0.0 or later
- Update SCALANCE W1788-2 M12 to Version 3.0.0 or later
- Update SCALANCE W1788-2IA M12 to Version 3.0.0 or later

As a general security measure, Siemens strongly recommends protecting network access to devices with appropriate
mechanisms. To operate the devices in a protected IT environment, Siemens recommends configuring the environment
according to Siemensâ€™ operational guidelines for industrial security and to follow the recommendations in the product
manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/industrialsecurity

For additional information, please refer to Siemens Security Advisory SSA-392912");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-28329");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/04/12");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/04/12");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/04/11");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_w1788-1_m12_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_w1788-2_eec_m12_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_w1788-2_m12_firmware:3.0.0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_w1788-2ia_m12_firmware:3.0.0");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023-2025 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:scalance_w1788-1_m12_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5788-1GY01-0AA0']},
    "cpe:/o:siemens:scalance_w1788-2_eec_m12_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5788-2GY01-0TA0']},
    "cpe:/o:siemens:scalance_w1788-2_m12_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5788-2GY01-0AA0']},
    "cpe:/o:siemens:scalance_w1788-2ia_m12_firmware:3.0.0" :
        {"versionEndExcluding" : "3.0.0", "family" : "SCALANCEW", "orderNumbers" : ['6GK5788-2HY01-0AA0']}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_NOTE);
