#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501318);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/26");

  script_cve_id("CVE-2018-0303");

  script_name(english:"Cisco FXOS and NX-OS Software Cisco Discovery Protocol Arbitrary Code Execution (CVE-2018-0303)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability in the Cisco Discovery Protocol component of Cisco
FXOS Software and Cisco NX-OS Software could allow an unauthenticated,
adjacent attacker to execute arbitrary code as root or cause a denial
of service (DoS) condition on the affected device. The vulnerability
exists because of insufficiently validated Cisco Discovery Protocol
packet headers. An attacker could exploit this vulnerability by
sending a crafted Cisco Discovery Protocol packet to a Layer 2
adjacent affected device. A successful exploit could allow the
attacker to cause a buffer overflow that could allow the attacker to
execute arbitrary code as root or cause a DoS condition on the
affected device. This vulnerability affects the following if
configured to use Cisco Discovery Protocol: Firepower 4100 Series
Next-Generation Firewalls, Firepower 9300 Security Appliance, MDS 9000
Series Multilayer Switches, Nexus 1000V Series Switches, Nexus 1100
Series Cloud Services Platforms, Nexus 2000 Series Fabric Extenders,
Nexus 3000 Series Switches, Nexus 3500 Platform Switches, Nexus 5500
Platform Switches, Nexus 5600 Platform Switches, Nexus 6000 Series
Switches, Nexus 7000 Series Switches, Nexus 7700 Series Switches,
Nexus 9000 Series Fabric Switches in Application Centric
Infrastructure (ACI) mode, Nexus 9000 Series Switches in standalone
NX-OS mode, Nexus 9500 R-Series Line Cards and Fabric Modules, UCS
6100 Series Fabric Interconnects, UCS 6200 Series Fabric
Interconnects, UCS 6300 Series Fabric Interconnects. Cisco Bug IDs:
CSCvc22202, CSCvc22205, CSCvc22208, CSCvc88078, CSCvc88150,
CSCvc88159, CSCvc88162, CSCvc88167.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180620-fxnxos-dos
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f92e2bfa");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1041169");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-0303");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(119);

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/06/21");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/06/21");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/07/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:3.1%283a%29a");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i4%287%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:7.0%283%29i7%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.0%281%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.1%280.2%29s0");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.8%280.1%29");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:nx-os:8.8%283.5%29s0");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Cisco");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Cisco');

var asset = tenable_ot::assets::get(vendor:'Cisco');

var vuln_cpes = {
    "cpe:/o:cisco:nx-os:7.0%280%29hsk%280.357%29" :
        {"versionEndIncluding" : "7.0%280%29hsk%280.357%29", "versionStartIncluding" : "7.0%280%29hsk%280.357%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.1%280.2%29s0" :
        {"versionEndIncluding" : "8.1%280.2%29s0", "versionStartIncluding" : "8.1%280.2%29s0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.8%280.1%29" :
        {"versionEndIncluding" : "8.8%280.1%29", "versionStartIncluding" : "8.8%280.1%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.0%281%29" :
        {"versionEndIncluding" : "8.0%281%29", "versionStartIncluding" : "8.0%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:8.8%283.5%29s0" :
        {"versionEndIncluding" : "8.8%283.5%29s0", "versionStartIncluding" : "8.8%283.5%29s0", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i4%287%29" :
        {"versionEndIncluding" : "7.0%283%29i4%287%29", "versionStartIncluding" : "7.0%283%29i4%287%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:7.0%283%29i7%281%29" :
        {"versionEndIncluding" : "7.0%283%29i7%281%29", "versionStartIncluding" : "7.0%283%29i7%281%29", "family" : "NXOS"},
    "cpe:/o:cisco:nx-os:3.1%283a%29a" :
        {"versionEndIncluding" : "3.1%283a%29a", "versionStartIncluding" : "3.1%283a%29a", "family" : "NXOS"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
